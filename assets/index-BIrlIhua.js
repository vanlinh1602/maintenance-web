import{u as R,a as A,r as h,t as g,j as e,D as W,b as B,d as Y,e as H,f as U,P as I,g as L,B as v,C as k,h as M,i as z,k as G,W as J}from"./index-CGi-Suzj.js";import{u as X,h as Z}from"./hooks-Cuu2-Frd.js";import{B as _}from"./badge-DLrqGHpA.js";import{C as K,a as ee,b as se,d as ae,c as te,e as re}from"./card-cqz_ZksU.js";import{D as ie,a as le,E as ne,b as ce,c as de,d as T,e as oe}from"./dropdown-menu-BQ24iNsp.js";import{I as P,P as he,S as me}from"./input-CaR1ULlg.js";import{C as O}from"./calendar-CX4yxO4l.js";import{L as n}from"./label-wgjF76KL.js";import{S as N,a as f,b as D,c as y,d as o}from"./select-0ZZsy_Y5.js";import{u as Q}from"./hooks-D4I9jU-y.js";import{f as V}from"./format-BEMO4FpZ.js";import{T as xe}from"./textarea-DsUL-gou.js";import"./index-CNoRdSBJ.js";const ue=({device:i,onClose:u})=>{const{createDevice:p,updateDevice:S}=Q(R(s=>({createDevice:s.createDevice,updateDevice:s.updateDevice}))),{statues:C,users:w,rooms:b,types:l}=A(R(s=>({statues:s.data.device.status,rooms:s.data.rooms,users:s.data.users,types:s.data.device.type}))),[r,c]=h.useState(i),[t,j]=h.useState(),[m,E]=h.useState(),[d,F]=h.useState();h.useEffect(()=>{i.purchaseDate&&j(new Date(i.purchaseDate)),i.assignedDate&&E(new Date(i.assignedDate)),i.warrantyExpireDate&&F(new Date(i.warrantyExpireDate))},[i]);const a=h.useCallback(s=>{if(!s.name)return g({title:"Error",description:"Name is required",variant:"destructive"}),!1;if(!s.serial)return g({title:"Error",description:"Serial is required",variant:"destructive"}),!1;if(!s.purchaseDate)return g({title:"Error",description:"Purchase date is required",variant:"destructive"}),!1;if(!s.warrantyExpireDate)return g({title:"Error",description:"Warranty expire date is required",variant:"destructive"}),!1;if(!s.status)return g({title:"Error",description:"Status is required",variant:"destructive"}),!1;if(!s.type){g({title:"Error",description:"Type is required",variant:"destructive"});return}return!0},[]),q=()=>{const s={...r,purchaseDate:t==null?void 0:t.getTime(),assignedDate:m==null?void 0:m.getTime(),warrantyExpireDate:d==null?void 0:d.getTime()};a(s)&&(i.id?S(i.id,s):p(s),u())};return e.jsx(W,{open:!0,onOpenChange:s=>{s||u()},children:e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsx(H,{children:i.id?`Edit ${i.name}`:"Create new device"}),e.jsx(U,{children:"Enter the details of the device here. Click save when you're done."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"name",className:"text-right",children:["Name",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(P,{id:"name",className:"col-span-3",value:r.name,onChange:s=>c({...r,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"description",className:"text-right",children:"Description"}),e.jsx(P,{id:"description",className:"col-span-3",value:r.description,onChange:s=>c({...r,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"type",className:"text-right",children:["Serial",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(P,{id:"serial",className:"col-span-3",value:r.serial,onChange:s=>c({...r,serial:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"maintenance-date",className:"text-right",children:["Purchase Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(I,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:`col-span-3 ${!t&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),t?V(t,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(M,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:t,onSelect:j,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"assigned-date",className:"text-right",children:"Assigned Date"}),e.jsxs(I,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:`col-span-3 ${!m&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),m?V(m,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(M,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:m,onSelect:E,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"warranty-expire-date",className:"text-right",children:["Warranty Expire Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(I,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:`col-span-3 ${!d&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),d?V(d,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(M,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:d,onSelect:F,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"type",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(N,{onValueChange:s=>c({...r,type:s}),value:r.type,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select status"})}),e.jsx(y,{children:Object.entries(l).map(([s,x])=>e.jsx(o,{value:s,children:x.type},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"status",className:"text-right",children:["Status",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(N,{onValueChange:s=>c({...r,status:s}),value:r.status,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select status"})}),e.jsx(y,{children:Object.entries(C).map(([s,x])=>e.jsx(o,{value:s,children:x.status},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"room",className:"text-right",children:"Room"}),e.jsxs(N,{onValueChange:s=>c({...r,roomId:s}),value:r.roomId,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select room"})}),e.jsx(y,{children:Object.entries(b).map(([s,x])=>e.jsx(o,{value:s,children:x.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"employee",className:"text-right",children:"User"}),e.jsxs(N,{onValueChange:s=>c({...r,employeeId:s}),value:r.employeeId,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select employee"})}),e.jsx(y,{children:Object.entries(w).map(([s,x])=>e.jsx(o,{value:s,children:x.name},s))})]})]})]}),e.jsx(z,{children:e.jsx(v,{type:"submit",onClick:q,children:"Save changes"})})]})})},pe=({device:i,onClose:u,request:p})=>{const S=G(),{handling:C,createRequest:w,updateRequest:b}=X(R(t=>({createRequest:t.createRequest,updateRequest:t.updateRequest,handling:t.handling}))),[l,r]=h.useState({description:"",priority:"",type:""}),c=async()=>{if(!l.type||!l.description||!l.priority){g({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}const t={...p,...l,deviceId:i.id,creator:"user-id",status:"pending",createdDate:Date.now()};if(p)b(p.id,t),u();else{const j=await w(t);j&&(S(`/request/${j.id}`),u())}};return e.jsxs(e.Fragment,{children:[C?e.jsx(J,{}):null,e.jsx(W,{open:!0,onOpenChange:t=>{t||u()},children:e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsxs(H,{children:["Request Repair for ",i==null?void 0:i.name]}),e.jsx(U,{children:"Please provide details about the issue you're experiencing with this device."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"urgency",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(N,{onValueChange:t=>r({...l,type:t}),value:l.type,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select urgency level"})}),e.jsxs(y,{children:[e.jsx(o,{value:"repair",children:"Repair"}),e.jsx(o,{value:"routine",children:"Maintenance"}),e.jsx(o,{value:"inspection",children:"Inspection"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"issue",className:"text-right",children:["Description",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(xe,{id:"issue",placeholder:"Describe the problem in detail...",className:"col-span-3",value:l.description,onChange:t=>r({...l,description:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"urgency",className:"text-right",children:["Priority",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(N,{onValueChange:t=>r({...l,priority:t}),value:l.priority,children:[e.jsx(f,{className:"col-span-3",children:e.jsx(D,{placeholder:"Select urgency level"})}),e.jsxs(y,{children:[e.jsx(o,{value:"low",children:"Low"}),e.jsx(o,{value:"medium",children:"Medium"}),e.jsx(o,{value:"high",children:"High"}),e.jsx(o,{value:"critical",children:"Critical"})]})]})]})]}),e.jsx(z,{children:e.jsx(v,{type:"submit",onClick:c,children:"Submit Repair Request"})})]})})]})};function Fe(){const i=G(),{handling:u,devices:p,getDevices:S,deleteDevice:C}=Q(R(a=>({handling:a.handling,devices:a.data,getDevices:a.getDevices,deleteDevice:a.deleteDevice}))),{deviceStatues:w,users:b,rooms:l,deviceTypes:r}=A(R(a=>({deviceStatues:a.data.device.status,rooms:a.data.rooms,users:a.data.users,deviceTypes:a.data.device.type})));h.useEffect(()=>{Object.keys(p).length||S()},[]);const[c,t]=h.useState(""),[j,m]=h.useState(),[E,d]=h.useState(),F=Object.values(p).filter(a=>a.name.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u?e.jsx(J,{}):null,E?e.jsx(ue,{device:E,onClose:()=>d(void 0)}):null,j?e.jsx(pe,{device:j,onClose:()=>m(void 0)}):null,e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Device Management"}),e.jsxs(v,{onClick:()=>d({}),children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Add New Device"]})]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(P,{type:"search",placeholder:"Search device...",className:"pl-8 md:w-[300px] lg:w-[300px] bg-white",value:c,onChange:a=>t(a.target.value)})]})})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:F.map(a=>{var q,s,x,$;return e.jsxs(K,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:a.name}),e.jsxs(ae,{children:[(q=r[a.type])==null?void 0:q.type,e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Serial:"})," ",a.serial]})]})]}),e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Room:"," ",((s=l[a.roomId||""])==null?void 0:s.name)||"Not assigned to any room"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["User:"," ",((x=b[a.employeeId||""])==null?void 0:x.name)||"Not assigned to any user"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_,{children:($=w[a.status])==null?void 0:$.status}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last Assign:"," ",Z(a.assignedDate).format("DD/MM/YYYY")]})]})]}),e.jsx(re,{className:"flex justify-end",children:e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(v,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(ne,{className:"h-4 w-4"})]})}),e.jsxs(ce,{align:"end",children:[e.jsx(de,{children:"Actions"}),e.jsx(T,{onSelect:()=>i(`/device/${a.id}`),children:"View Details"}),e.jsx(T,{onSelect:()=>d(a),children:"Edit Device"}),e.jsx(T,{onSelect:()=>m(a),children:"Request Repair"}),e.jsx(oe,{}),e.jsx(T,{className:"text-red-600",onSelect:()=>C(a.id),children:"Delete Device"})]})]})})]},a.id)})})]})}export{Fe as default};
