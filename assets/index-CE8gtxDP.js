import{f as j,h as B,r as m,t as h,j as e,D as U,i as H,k as z,l as G,m as J,P as M,n as I,B as u,C as k,o as q,p as Q,u as X,e as Z,W as _,q as K,s as ee,v as se,w as ae,x as N,y as te}from"./index-DVFDKlcv.js";import{u as Y,h as re}from"./hooks-28YVt9aP.js";import{d as V,B as ie}from"./options-YKJpdElC.js";import{C as le,a as ne,b as ce,d as de,c as oe,e as me}from"./card-PyWpcb_t.js";import{I as w,S as xe}from"./input-CqL1aFUt.js";import{f as R,C as O}from"./calendar-CHF10eXH.js";import{L as o}from"./label-DuOUMB3r.js";import{S as f,a as D,b as S,c as y,d as C}from"./select-Bn3wcZhV.js";import"./textarea-B-3oHILt.js";import{R as he}from"./index-BZNuG8HG.js";import{P as ue}from"./plus-BRTevXWx.js";import{E as pe}from"./ellipsis-bOgJXUvn.js";import"./hooks-CYUBZkOm.js";const je=({device:r,onClose:g})=>{const{createDevice:E,updateDevice:b}=Y(j(s=>({createDevice:s.createDevice,updateDevice:s.updateDevice}))),{users:F,rooms:T,types:P}=B(j(s=>({rooms:s.data.rooms,users:s.data.users,types:s.data.device.type}))),[t,i]=m.useState(r),[l,v]=m.useState(),[n,p]=m.useState(),[c,x]=m.useState();m.useEffect(()=>{r.purchaseDate&&v(new Date(r.purchaseDate)),r.assignedDate&&p(new Date(r.assignedDate)),r.warrantyExpireDate&&x(new Date(r.warrantyExpireDate))},[r]);const L=m.useCallback(s=>{if(!s.name)return h({title:"Error",description:"Name is required",variant:"destructive"}),!1;if(!s.serial)return h({title:"Error",description:"Serial is required",variant:"destructive"}),!1;if(!s.purchaseDate)return h({title:"Error",description:"Purchase date is required",variant:"destructive"}),!1;if(!s.warrantyExpireDate)return h({title:"Error",description:"Warranty expire date is required",variant:"destructive"}),!1;if(!s.status)return h({title:"Error",description:"Status is required",variant:"destructive"}),!1;if(!s.type){h({title:"Error",description:"Type is required",variant:"destructive"});return}return!0},[]),a=()=>{const s={...t,purchaseDate:l==null?void 0:l.getTime(),assignedDate:n==null?void 0:n.getTime(),warrantyExpireDate:c==null?void 0:c.getTime()};L(s)&&(r.id?b(r.id,s):E(s),g())};return e.jsx(U,{open:!0,onOpenChange:s=>{s||g()},children:e.jsxs(H,{children:[e.jsxs(z,{children:[e.jsx(G,{children:r.id?`Edit ${r.name}`:"Create new device"}),e.jsx(J,{children:"Enter the details of the device here. Click save when you're done."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"name",className:"text-right",children:["Name",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(w,{id:"name",className:"col-span-3",value:t.name,onChange:s=>i({...t,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(o,{htmlFor:"description",className:"text-right",children:"Description"}),e.jsx(w,{id:"description",className:"col-span-3",value:t.description,onChange:s=>i({...t,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"type",className:"text-right",children:["Serial",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(w,{id:"serial",className:"col-span-3",value:t.serial,onChange:s=>i({...t,serial:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"maintenance-date",className:"text-right",children:["Purchase Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(M,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`col-span-3 ${!l&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),l?R(l,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(q,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:l,onSelect:v,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(o,{htmlFor:"assigned-date",className:"text-right",children:"Assigned Date"}),e.jsxs(M,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`col-span-3 ${!n&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),n?R(n,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(q,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:n,onSelect:p,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"warranty-expire-date",className:"text-right",children:["Warranty Expire Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(M,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`col-span-3 ${!c&&"text-muted-foreground"}`,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),c?R(c,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(q,{className:"w-auto p-0",children:e.jsx(O,{mode:"single",selected:c,onSelect:x,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"type",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(f,{onValueChange:s=>i({...t,type:s}),value:t.type,children:[e.jsx(D,{className:"col-span-3",children:e.jsx(S,{placeholder:"Select status"})}),e.jsx(y,{children:Object.entries(P).map(([s,d])=>e.jsx(C,{value:s,children:d.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"status",className:"text-right",children:["Status",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(f,{onValueChange:s=>i({...t,status:s}),value:t.status,children:[e.jsx(D,{className:"col-span-3",children:e.jsx(S,{placeholder:"Select status"})}),e.jsx(y,{children:Object.entries(V).map(([s,d])=>e.jsx(C,{value:s,children:d.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(o,{htmlFor:"room",className:"text-right",children:"Room"}),e.jsxs(f,{onValueChange:s=>i({...t,roomId:s}),value:t.roomId,children:[e.jsx(D,{className:"col-span-3",children:e.jsx(S,{placeholder:"Select room"})}),e.jsx(y,{children:Object.entries(T).map(([s,d])=>e.jsx(C,{value:s,children:d.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(o,{htmlFor:"employee",className:"text-right",children:"User"}),e.jsxs(f,{onValueChange:s=>i({...t,employeeId:s}),value:t.employeeId,children:[e.jsx(D,{className:"col-span-3",children:e.jsx(S,{placeholder:"Select employee"})}),e.jsx(y,{children:Object.entries(F).map(([s,d])=>e.jsx(C,{value:s,children:d.name},s))})]})]})]}),e.jsx(Q,{children:e.jsx(u,{type:"submit",onClick:a,children:"Save changes"})})]})})};function Pe(){const r=X(),{handling:g,devices:E,getDevices:b,deleteDevice:F}=Y(j(a=>({handling:a.handling,devices:a.data,getDevices:a.getDevices,deleteDevice:a.deleteDevice}))),{users:T,rooms:P,deviceTypes:t}=B(j(a=>({rooms:a.data.rooms,users:a.data.users,deviceTypes:a.data.device.type}))),{isMaintenance:i}=Z(j(a=>({isMaintenance:a.isMaintenance})));m.useEffect(()=>{b()},[]);const[l,v]=m.useState(""),[n,p]=m.useState(),[c,x]=m.useState(),L=Object.values(E).filter(a=>a.name.toLowerCase().includes(l.toLowerCase()));return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g?e.jsx(_,{}):null,c?e.jsx(je,{device:c,onClose:()=>x(void 0)}):null,n?e.jsx(he,{device:n,onClose:()=>p(void 0)}):null,e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Device Management"}),i?e.jsxs(u,{onClick:()=>x({}),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"})," Add New Device"]}):null]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(w,{type:"search",placeholder:"Search device...",className:"pl-8 md:w-[300px] lg:w-[300px] bg-white",value:l,onChange:a=>v(a.target.value)})]})})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:L.map(a=>{var s,d,A,W,$;return e.jsxs(le,{children:[e.jsxs(ne,{children:[e.jsx(ce,{children:a.name}),e.jsxs(de,{children:[(s=t[a.type])==null?void 0:s.name,e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Serial:"})," ",a.serial]})]})]}),e.jsxs(oe,{children:[e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Room:"," ",((d=P[a.roomId||""])==null?void 0:d.name)||"Not assigned to any room"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["User:"," ",((A=T[a.employeeId||""])==null?void 0:A.name)||"Not assigned to any user"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ie,{style:{backgroundColor:(W=V[a.status])==null?void 0:W.color},children:($=V[a.status])==null?void 0:$.name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last Assign:"," ",re(a.assignedDate).format("DD/MM/YYYY")]})]})]}),e.jsx(me,{className:"flex justify-end",children:e.jsxs(K,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(u,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(pe,{className:"h-4 w-4"})]})}),e.jsxs(se,{align:"end",children:[e.jsx(ae,{children:"Actions"}),e.jsx(N,{onSelect:()=>r(`/device/${a.id}`),children:"View Details"}),i?e.jsx(N,{onSelect:()=>x(a),children:"Edit Device"}):null,e.jsx(N,{onSelect:()=>p(a),children:"Request Repair"}),i?e.jsxs(e.Fragment,{children:[e.jsx(te,{}),e.jsx(N,{className:"text-red-600",onSelect:()=>F(a.id),children:"Delete Device"})]}):null]})]})})]},a.id)})})]})}export{Pe as default};
