import{f as g,h as $,r as c,t as u,j as e,D as X,W as Y,i as G,k as J,l as Q,m as Z,P as q,n as R,B as p,C as O,o as U,p as _,q as K,u as ee,e as se,s as ae,v as te,w as re,x as ie,y as w,z as le}from"./index-Cw7UTnmX.js";import{u as H,h as ne}from"./hooks-DUEf6Wgf.js";import{d as B,B as ce}from"./options-Cf1MLeWf.js";import{C as de,a as oe,b as me,d as xe,c as he,e as ue}from"./card-BRWD3fE5.js";import{I as F}from"./input-DoXMFgNH.js";import{f as V,C as A}from"./calendar-B5hFHp5d.js";import{L as n}from"./label-B5bgNSYj.js";import{S as y,a as S,b as C,c as b,d as E}from"./select-Bep9p-Vs.js";import{T as pe}from"./textarea-BvdFGMqn.js";import{X as je,S as ge}from"./x-K-T2Q1c1.js";import{R as ve}from"./index-3htPaALM.js";import{P as Ne}from"./plus-SGypoK3J.js";import{E as fe}from"./ellipsis-D3XtSlzn.js";import"./hooks-BE1mY1X_.js";const De=({device:r,onClose:v})=>{const{createDevice:T,updateDevice:I}=H(g(s=>({createDevice:s.createDevice,updateDevice:s.updateDevice}))),{users:P,rooms:L,types:M}=$(g(s=>({rooms:s.data.rooms,users:s.data.users,types:s.data.device.type}))),[k,x]=c.useState(!1),[t,l]=c.useState(r),[d,j]=c.useState(),[o,h]=c.useState(),[m,a]=c.useState();c.useEffect(()=>{r.purchaseDate&&j(new Date(r.purchaseDate)),r.assignedDate&&h(new Date(r.assignedDate)),r.warrantyExpireDate&&a(new Date(r.warrantyExpireDate))},[r]);const N=c.useCallback(s=>{if(!s.name)return u({title:"Error",description:"Name is required",variant:"destructive"}),!1;if(!s.serial)return u({title:"Error",description:"Serial is required",variant:"destructive"}),!1;if(!s.purchaseDate)return u({title:"Error",description:"Purchase date is required",variant:"destructive"}),!1;if(!s.warrantyExpireDate)return u({title:"Error",description:"Warranty expire date is required",variant:"destructive"}),!1;if(!s.status)return u({title:"Error",description:"Status is required",variant:"destructive"}),!1;if(!s.type){u({title:"Error",description:"Type is required",variant:"destructive"});return}return!0},[]),f=async s=>{var i;try{x(!0);const W=(i=s.target.files)==null?void 0:i[0];if(!W)return;const z=await K(W);l({...t,image:z})}finally{x(!1)}},D=()=>{const s={...t,purchaseDate:d==null?void 0:d.getTime(),assignedDate:o==null?void 0:o.getTime(),warrantyExpireDate:m==null?void 0:m.getTime()};N(s)&&(r.id?I(r.id,s):T(s),v())};return e.jsxs(X,{open:!0,onOpenChange:s=>{s||v()},children:[k?e.jsx(Y,{}):null,e.jsxs(G,{className:"w-[800px] container max-w-[800px]",children:[e.jsxs(J,{children:[e.jsx(Q,{children:r.id?`Edit ${r.name}`:"Create new device"}),e.jsx(Z,{children:"Enter the details of the device here. Click save when you're done."})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-2 py-4",children:[e.jsxs("div",{className:"flex flex-row gap-4 col-span-2",children:[e.jsx("div",{children:e.jsxs("div",{className:"items-center gap-4 ",children:[e.jsx(n,{htmlFor:"image",className:"text-right"}),t.image?e.jsxs("div",{className:"w-52 h-52",children:[e.jsx("div",{className:"absolute left-52 text-destructive h-6 w-6 cursor-pointer bg-white rounded-lg",children:e.jsx(je,{onClick:()=>l({...t,image:""})})}),e.jsx("img",{src:t.image,alt:"device",className:"w-52 h-52 object-cover"})]}):e.jsx(F,{type:"file",id:"image",className:"w-52 h-52 justify-center text-cente items-center",placeholder:"Upload image",content:"Upload image",accept:"image/*",multiple:!1,onChange:f})]})}),e.jsxs("div",{className:"grid grid-cols-1 w-full",children:[e.jsxs("div",{className:"items-center gap-4",children:[e.jsxs(n,{htmlFor:"name",className:"text-right",children:["Name",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(F,{id:"name",value:t.name,onChange:s=>l({...t,name:s.target.value})})]}),e.jsxs("div",{className:"items-center gap-4",children:[e.jsxs(n,{htmlFor:"type",className:"text-right",children:["Serial",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(F,{id:"serial",value:t.serial,onChange:s=>l({...t,serial:s.target.value})})]}),e.jsxs("div",{className:"items-center gap-4",children:[e.jsxs(n,{htmlFor:"type",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(y,{onValueChange:s=>l({...t,type:s}),value:t.type,children:[e.jsx(S,{className:"col-span-3",children:e.jsx(C,{placeholder:"Select status"})}),e.jsx(b,{children:Object.entries(M).map(([s,i])=>e.jsx(E,{value:s,children:i.name},s))})]})]})]})]}),e.jsxs("div",{className:"col-span-2  items-center gap-4",children:[e.jsx(n,{htmlFor:"description",className:"text-right",children:"Description"}),e.jsx(pe,{id:"description",className:"col-span-3",value:t.description,onChange:s=>l({...t,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"maintenance-date",className:"text-right",children:["Purchase Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(q,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:`col-span-3 ${!d&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),d?V(d,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(U,{className:"w-auto p-0",children:e.jsx(A,{mode:"single",selected:d,onSelect:j,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"warranty-expire-date",className:"text-right",children:["Warranty Expire Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(q,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:`col-span-3 ${!m&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),m?V(m,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(U,{className:"w-auto p-0",children:e.jsx(A,{mode:"single",selected:m,onSelect:a,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"assigned-date",className:"text-right",children:"Assigned Date"}),e.jsxs(q,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:`col-span-3 ${!o&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),o?V(o,"dd/LL/y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(U,{className:"w-auto p-0",children:e.jsx(A,{mode:"single",selected:o,onSelect:h,initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(n,{htmlFor:"status",className:"text-right",children:["Status",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(y,{onValueChange:s=>l({...t,status:s}),value:t.status,children:[e.jsx(S,{className:"col-span-3",children:e.jsx(C,{placeholder:"Select status"})}),e.jsx(b,{children:Object.entries(B).map(([s,i])=>e.jsx(E,{value:s,children:i.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"room",className:"text-right",children:"Room"}),e.jsxs(y,{onValueChange:s=>l({...t,roomId:s}),value:t.roomId,children:[e.jsx(S,{className:"col-span-3",children:e.jsx(C,{placeholder:"Select room"})}),e.jsx(b,{children:Object.entries(L).map(([s,i])=>e.jsx(E,{value:s,children:i.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(n,{htmlFor:"employee",className:"text-right",children:"User"}),e.jsxs(y,{onValueChange:s=>l({...t,employeeId:s}),value:t.employeeId,children:[e.jsx(S,{className:"col-span-3",children:e.jsx(C,{placeholder:"Select employee"})}),e.jsx(b,{children:Object.entries(P).map(([s,i])=>e.jsx(E,{value:s,children:i.name},s))})]})]})]}),e.jsx(_,{children:e.jsx(p,{type:"submit",onClick:D,children:"Save changes"})})]})]})};function Re(){const r=ee(),{handling:v,devices:T,getDevices:I,deleteDevice:P}=H(g(a=>({handling:a.handling,devices:a.data,getDevices:a.getDevices,deleteDevice:a.deleteDevice}))),{users:L,rooms:M,deviceTypes:k}=$(g(a=>({rooms:a.data.rooms,users:a.data.users,deviceTypes:a.data.device.type}))),{isMaintenance:x}=se(g(a=>({isMaintenance:a.isMaintenance})));c.useEffect(()=>{I()},[]);const[t,l]=c.useState(""),[d,j]=c.useState(),[o,h]=c.useState(),m=Object.values(T).filter(a=>a.name.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[v?e.jsx(Y,{}):null,o?e.jsx(De,{device:o,onClose:()=>h(void 0)}):null,d?e.jsx(ve,{device:d,onClose:()=>j(void 0)}):null,e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Device Management"}),x?e.jsxs(p,{onClick:()=>h({}),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"})," Add New Device"]}):null]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(F,{type:"search",placeholder:"Search device...",className:"pl-8 md:w-[300px] lg:w-[300px] bg-white",value:t,onChange:a=>l(a.target.value)})]})})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:m.map(a=>{var N,f,D,s,i;return e.jsxs(de,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("img",{src:a.image,alt:a.name,className:"h-16 w-16 rounded-md object-cover"}),e.jsxs("div",{children:[e.jsx(me,{children:a.name}),e.jsxs(xe,{children:[(N=k[a.type])==null?void 0:N.name,e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Serial:"})," ",a.serial]})]})]})]})}),e.jsxs(he,{children:[e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Room:"," ",((f=M[a.roomId||""])==null?void 0:f.name)||"Not assigned to any room"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["User:"," ",((D=L[a.employeeId||""])==null?void 0:D.name)||"Not assigned to any user"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ce,{style:{backgroundColor:(s=B[a.status])==null?void 0:s.color},children:(i=B[a.status])==null?void 0:i.name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last Assign:"," ",ne(a.assignedDate).format("DD/MM/YYYY")]})]})]}),e.jsx(ue,{className:"flex justify-end",children:e.jsxs(ae,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(p,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(fe,{className:"h-4 w-4"})]})}),e.jsxs(re,{align:"end",children:[e.jsx(ie,{children:"Actions"}),e.jsx(w,{onSelect:()=>r(`/device/${a.id}`),children:"View Details"}),x?e.jsx(w,{onSelect:()=>h(a),children:"Edit Device"}):null,e.jsx(w,{onSelect:()=>j(a),children:"Request Repair"}),x?e.jsxs(e.Fragment,{children:[e.jsx(le,{}),e.jsx(w,{className:"text-red-600",onSelect:()=>P(a.id),children:"Delete Device"})]}):null]})]})})]},a.id)})})]})}export{Re as default};
