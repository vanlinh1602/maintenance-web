import{s as ce,v as _t,w as fe,x as Yi,y as Wt,z as Qi,u as Ji,b as je,d as tn,a as en,r as hr,j as It,W as rn,B as Pr,l as nn,m as sn,n as an,o as on,p as Ur,q as hn,A as ln,t as zr,C as un}from"./index-CfFH1LjD.js";import{u as cn,h as lr}from"./hooks-wJSTJ-Ih.js";import{r as He,B as fn}from"./options-BrKX2hC9.js";import{C as dn,a as mn,b as pn,d as _n,c as gn,e as wn}from"./card-DN_1rcS3.js";import{S as yn,a as An,b as vn,c as bn,d as Lr}from"./select-Bk9xR7qg.js";import{u as xn}from"./hooks-ceS6wIrN.js";import{E as Cn}from"./ellipsis-OW6600zT.js";var _i={exports:{}};(function(H,t){(function(e,n){n()})(ce,function(){function e(N,S){return typeof S>"u"?S={autoBom:!1}:typeof S!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),S={autoBom:!S}),S.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(N.type)?new Blob(["\uFEFF",N],{type:N.type}):N}function n(N,S,I){var D=new XMLHttpRequest;D.open("GET",N),D.responseType="blob",D.onload=function(){d(D.response,S,I)},D.onerror=function(){console.error("could not download file")},D.send()}function s(N){var S=new XMLHttpRequest;S.open("HEAD",N,!1);try{S.send()}catch{}return 200<=S.status&&299>=S.status}function o(N){try{N.dispatchEvent(new MouseEvent("click"))}catch{var S=document.createEvent("MouseEvents");S.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),N.dispatchEvent(S)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ce=="object"&&ce.global===ce?ce:void 0,a=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(N,S,I){var D=l.URL||l.webkitURL,_=document.createElement("a");S=S||N.name||"download",_.download=S,_.rel="noopener",typeof N=="string"?(_.href=N,_.origin===location.origin?o(_):s(_.href)?n(N,S,I):o(_,_.target="_blank")):(_.href=D.createObjectURL(N),setTimeout(function(){D.revokeObjectURL(_.href)},4e4),setTimeout(function(){o(_)},0))}:"msSaveOrOpenBlob"in navigator?function(N,S,I){if(S=S||N.name||"download",typeof N!="string")navigator.msSaveOrOpenBlob(e(N,I),S);else if(s(N))n(N,S,I);else{var D=document.createElement("a");D.href=N,D.target="_blank",setTimeout(function(){o(D)})}}:function(N,S,I,D){if(D=D||open("","_blank"),D&&(D.document.title=D.document.body.innerText="downloading..."),typeof N=="string")return n(N,S,I);var _=N.type==="application/octet-stream",v=/constructor/i.test(l.HTMLElement)||l.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||_&&v||a)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var O=E.result;O=g?O:O.replace(/^data:[^;]*;/,"data:attachment/file;"),D?D.location.href=O:location=O,D=null},E.readAsDataURL(N)}else{var f=l.URL||l.webkitURL,A=f.createObjectURL(N);D?D.location=A:location.href=A,D=null,setTimeout(function(){f.revokeObjectURL(A)},4e4)}});l.saveAs=d.saveAs=d,H.exports=d})})(_i);var Nn=_i.exports;function De(H){throw new Error('Could not dynamically require "'+H+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gi={exports:{}};(function(H,t){(function(e){H.exports=e()})(function(){return function e(n,s,o){function l(N,S){if(!s[N]){if(!n[N]){var I=typeof De=="function"&&De;if(!S&&I)return I(N,!0);if(a)return a(N,!0);var D=new Error("Cannot find module '"+N+"'");throw D.code="MODULE_NOT_FOUND",D}var _=s[N]={exports:{}};n[N][0].call(_.exports,function(v){var g=n[N][1][v];return l(g||v)},_,_.exports,e,n,s,o)}return s[N].exports}for(var a=typeof De=="function"&&De,d=0;d<o.length;d++)l(o[d]);return l}({1:[function(e,n,s){var o=e("./utils"),l=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(d){for(var N,S,I,D,_,v,g,E=[],f=0,A=d.length,O=A,V=o.getTypeOf(d)!=="string";f<d.length;)O=A-f,I=V?(N=d[f++],S=f<A?d[f++]:0,f<A?d[f++]:0):(N=d.charCodeAt(f++),S=f<A?d.charCodeAt(f++):0,f<A?d.charCodeAt(f++):0),D=N>>2,_=(3&N)<<4|S>>4,v=1<O?(15&S)<<2|I>>6:64,g=2<O?63&I:64,E.push(a.charAt(D)+a.charAt(_)+a.charAt(v)+a.charAt(g));return E.join("")},s.decode=function(d){var N,S,I,D,_,v,g=0,E=0,f="data:";if(d.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");var A,O=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===a.charAt(64)&&O--,d.charAt(d.length-2)===a.charAt(64)&&O--,O%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=l.uint8array?new Uint8Array(0|O):new Array(0|O);g<d.length;)N=a.indexOf(d.charAt(g++))<<2|(D=a.indexOf(d.charAt(g++)))>>4,S=(15&D)<<4|(_=a.indexOf(d.charAt(g++)))>>2,I=(3&_)<<6|(v=a.indexOf(d.charAt(g++))),A[E++]=N,_!==64&&(A[E++]=S),v!==64&&(A[E++]=I);return A}},{"./support":30,"./utils":32}],2:[function(e,n,s){var o=e("./external"),l=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),d=e("./stream/DataLengthProbe");function N(S,I,D,_,v){this.compressedSize=S,this.uncompressedSize=I,this.crc32=D,this.compression=_,this.compressedContent=v}N.prototype={getContentWorker:function(){var S=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),I=this;return S.on("end",function(){if(this.streamInfo.data_length!==I.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),S},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(S,I,D){return S.pipe(new a).pipe(new d("uncompressedSize")).pipe(I.compressWorker(D)).pipe(new d("compressedSize")).withStreamInfo("compression",I)},n.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,s){var o=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,s){var o=e("./utils"),l=function(){for(var a,d=[],N=0;N<256;N++){a=N;for(var S=0;S<8;S++)a=1&a?3988292384^a>>>1:a>>>1;d[N]=a}return d}();n.exports=function(a,d){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(N,S,I,D){var _=l,v=D+I;N^=-1;for(var g=D;g<v;g++)N=N>>>8^_[255&(N^S[g])];return-1^N}(0|d,a,a.length,0):function(N,S,I,D){var _=l,v=D+I;N^=-1;for(var g=D;g<v;g++)N=N>>>8^_[255&(N^S.charCodeAt(g))];return-1^N}(0|d,a,a.length,0):0}},{"./utils":32}],5:[function(e,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,n,s){var o=null;o=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:o}},{lie:37}],7:[function(e,n,s){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=e("pako"),a=e("./utils"),d=e("./stream/GenericWorker"),N=o?"uint8array":"array";function S(I,D){d.call(this,"FlateWorker/"+I),this._pako=null,this._pakoAction=I,this._pakoOptions=D,this.meta={}}s.magic="\b\0",a.inherits(S,d),S.prototype.processChunk=function(I){this.meta=I.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(N,I.data),!1)},S.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},S.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},S.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var I=this;this._pako.onData=function(D){I.push({data:D,meta:I.meta})}},s.compressWorker=function(I){return new S("Deflate",I)},s.uncompressWorker=function(){return new S("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,s){function o(_,v){var g,E="";for(g=0;g<v;g++)E+=String.fromCharCode(255&_),_>>>=8;return E}function l(_,v,g,E,f,A){var O,V,M=_.file,at=_.compression,Q=A!==N.utf8encode,ot=a.transformTo("string",A(M.name)),k=a.transformTo("string",N.utf8encode(M.name)),ct=M.comment,vt=a.transformTo("string",A(ct)),U=a.transformTo("string",N.utf8encode(ct)),tt=k.length!==M.name.length,p=U.length!==ct.length,st="",xt="",P="",J=M.dir,G=M.date,ut={crc32:0,compressedSize:0,uncompressedSize:0};v&&!g||(ut.crc32=_.crc32,ut.compressedSize=_.compressedSize,ut.uncompressedSize=_.uncompressedSize);var L=0;v&&(L|=8),Q||!tt&&!p||(L|=2048);var W=0,wt=0;J&&(W|=16),f==="UNIX"?(wt=798,W|=function(ht,Ft){var b=ht;return ht||(b=Ft?16893:33204),(65535&b)<<16}(M.unixPermissions,J)):(wt=20,W|=function(ht){return 63&(ht||0)}(M.dosPermissions)),O=G.getUTCHours(),O<<=6,O|=G.getUTCMinutes(),O<<=5,O|=G.getUTCSeconds()/2,V=G.getUTCFullYear()-1980,V<<=4,V|=G.getUTCMonth()+1,V<<=5,V|=G.getUTCDate(),tt&&(xt=o(1,1)+o(S(ot),4)+k,st+="up"+o(xt.length,2)+xt),p&&(P=o(1,1)+o(S(vt),4)+U,st+="uc"+o(P.length,2)+P);var mt="";return mt+=`
\0`,mt+=o(L,2),mt+=at.magic,mt+=o(O,2),mt+=o(V,2),mt+=o(ut.crc32,4),mt+=o(ut.compressedSize,4),mt+=o(ut.uncompressedSize,4),mt+=o(ot.length,2),mt+=o(st.length,2),{fileRecord:I.LOCAL_FILE_HEADER+mt+ot+st,dirRecord:I.CENTRAL_FILE_HEADER+o(wt,2)+mt+o(vt.length,2)+"\0\0\0\0"+o(W,4)+o(E,4)+ot+st+vt}}var a=e("../utils"),d=e("../stream/GenericWorker"),N=e("../utf8"),S=e("../crc32"),I=e("../signature");function D(_,v,g,E){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=g,this.encodeFileName=E,this.streamFiles=_,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(D,d),D.prototype.push=function(_){var v=_.meta.percent||0,g=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(_):(this.bytesWritten+=_.data.length,d.prototype.push.call(this,{data:_.data,meta:{currentFile:this.currentFile,percent:g?(v+100*(g-E-1))/g:100}}))},D.prototype.openedSource=function(_){this.currentSourceOffset=this.bytesWritten,this.currentFile=_.file.name;var v=this.streamFiles&&!_.file.dir;if(v){var g=l(_,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},D.prototype.closedSource=function(_){this.accumulate=!1;var v=this.streamFiles&&!_.file.dir,g=l(_,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),v)this.push({data:function(E){return I.DATA_DESCRIPTOR+o(E.crc32,4)+o(E.compressedSize,4)+o(E.uncompressedSize,4)}(_),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},D.prototype.flush=function(){for(var _=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var g=this.bytesWritten-_,E=function(f,A,O,V,M){var at=a.transformTo("string",M(V));return I.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(f,2)+o(f,2)+o(A,4)+o(O,4)+o(at.length,2)+at}(this.dirRecords.length,g,_,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},D.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},D.prototype.registerPrevious=function(_){this._sources.push(_);var v=this;return _.on("data",function(g){v.processChunk(g)}),_.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),_.on("error",function(g){v.error(g)}),this},D.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},D.prototype.error=function(_){var v=this._sources;if(!d.prototype.error.call(this,_))return!1;for(var g=0;g<v.length;g++)try{v[g].error(_)}catch{}return!0},D.prototype.lock=function(){d.prototype.lock.call(this);for(var _=this._sources,v=0;v<_.length;v++)_[v].lock()},n.exports=D},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,s){var o=e("../compressions"),l=e("./ZipFileWorker");s.generateWorker=function(a,d,N){var S=new l(d.streamFiles,N,d.platform,d.encodeFileName),I=0;try{a.forEach(function(D,_){I++;var v=function(A,O){var V=A||O,M=o[V];if(!M)throw new Error(V+" is not a valid compression method !");return M}(_.options.compression,d.compression),g=_.options.compressionOptions||d.compressionOptions||{},E=_.dir,f=_.date;_._compressWorker(v,g).withStreamInfo("file",{name:D,dir:E,date:f,comment:_.comment||"",unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions}).pipe(S)}),S.entriesCount=I}catch(D){S.error(D)}return S}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,s){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var a in this)typeof this[a]!="function"&&(l[a]=this[a]);return l}}(o.prototype=e("./object")).loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.10.1",o.loadAsync=function(l,a){return new o().loadAsync(l,a)},o.external=e("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,s){var o=e("./utils"),l=e("./external"),a=e("./utf8"),d=e("./zipEntries"),N=e("./stream/Crc32Probe"),S=e("./nodejsUtils");function I(D){return new l.Promise(function(_,v){var g=D.decompressed.getContentWorker().pipe(new N);g.on("error",function(E){v(E)}).on("end",function(){g.streamInfo.crc32!==D.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}n.exports=function(D,_){var v=this;return _=o.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),S.isNode&&S.isStream(D)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",D,!0,_.optimizedBinaryString,_.base64).then(function(g){var E=new d(_);return E.load(g),E}).then(function(g){var E=[l.Promise.resolve(g)],f=g.files;if(_.checkCRC32)for(var A=0;A<f.length;A++)E.push(I(f[A]));return l.Promise.all(E)}).then(function(g){for(var E=g.shift(),f=E.files,A=0;A<f.length;A++){var O=f[A],V=O.fileNameStr,M=o.resolve(O.fileNameStr);v.file(M,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:_.createFolders}),O.dir||(v.file(M).unsafeOriginalName=V)}return E.zipComment.length&&(v.comment=E.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,s){var o=e("../utils"),l=e("../stream/GenericWorker");function a(d,N){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(N)}o.inherits(a,l),a.prototype._bindStream=function(d){var N=this;(this._stream=d).pause(),d.on("data",function(S){N.push({data:S,meta:{percent:0}})}).on("error",function(S){N.isPaused?this.generatedError=S:N.error(S)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},a.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,s){var o=e("readable-stream").Readable;function l(a,d,N){o.call(this,d),this._helper=a;var S=this;a.on("data",function(I,D){S.push(I)||S._helper.pause(),N&&N(D)}).on("error",function(I){S.emit("error",I)}).on("end",function(){S.push(null)})}e("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},n.exports=l},{"../utils":32,"readable-stream":16}],14:[function(e,n,s){n.exports={isNode:typeof _t<"u",newBufferFrom:function(o,l){if(_t.from&&_t.from!==Uint8Array.from)return _t.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new _t(o,l)},allocBuffer:function(o){if(_t.alloc)return _t.alloc(o);var l=new _t(o);return l.fill(0),l},isBuffer:function(o){return _t.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(e,n,s){function o(M,at,Q){var ot,k=a.getTypeOf(at),ct=a.extend(Q||{},S);ct.date=ct.date||new Date,ct.compression!==null&&(ct.compression=ct.compression.toUpperCase()),typeof ct.unixPermissions=="string"&&(ct.unixPermissions=parseInt(ct.unixPermissions,8)),ct.unixPermissions&&16384&ct.unixPermissions&&(ct.dir=!0),ct.dosPermissions&&16&ct.dosPermissions&&(ct.dir=!0),ct.dir&&(M=f(M)),ct.createFolders&&(ot=E(M))&&A.call(this,ot,!0);var vt=k==="string"&&ct.binary===!1&&ct.base64===!1;Q&&Q.binary!==void 0||(ct.binary=!vt),(at instanceof I&&at.uncompressedSize===0||ct.dir||!at||at.length===0)&&(ct.base64=!1,ct.binary=!0,at="",ct.compression="STORE",k="string");var U=null;U=at instanceof I||at instanceof d?at:v.isNode&&v.isStream(at)?new g(M,at):a.prepareContent(M,at,ct.binary,ct.optimizedBinaryString,ct.base64);var tt=new D(M,U,ct);this.files[M]=tt}var l=e("./utf8"),a=e("./utils"),d=e("./stream/GenericWorker"),N=e("./stream/StreamHelper"),S=e("./defaults"),I=e("./compressedObject"),D=e("./zipObject"),_=e("./generate"),v=e("./nodejsUtils"),g=e("./nodejs/NodejsStreamInputAdapter"),E=function(M){M.slice(-1)==="/"&&(M=M.substring(0,M.length-1));var at=M.lastIndexOf("/");return 0<at?M.substring(0,at):""},f=function(M){return M.slice(-1)!=="/"&&(M+="/"),M},A=function(M,at){return at=at!==void 0?at:S.createFolders,M=f(M),this.files[M]||o.call(this,M,null,{dir:!0,createFolders:at}),this.files[M]};function O(M){return Object.prototype.toString.call(M)==="[object RegExp]"}var V={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(M){var at,Q,ot;for(at in this.files)ot=this.files[at],(Q=at.slice(this.root.length,at.length))&&at.slice(0,this.root.length)===this.root&&M(Q,ot)},filter:function(M){var at=[];return this.forEach(function(Q,ot){M(Q,ot)&&at.push(ot)}),at},file:function(M,at,Q){if(arguments.length!==1)return M=this.root+M,o.call(this,M,at,Q),this;if(O(M)){var ot=M;return this.filter(function(ct,vt){return!vt.dir&&ot.test(ct)})}var k=this.files[this.root+M];return k&&!k.dir?k:null},folder:function(M){if(!M)return this;if(O(M))return this.filter(function(k,ct){return ct.dir&&M.test(k)});var at=this.root+M,Q=A.call(this,at),ot=this.clone();return ot.root=Q.name,ot},remove:function(M){M=this.root+M;var at=this.files[M];if(at||(M.slice(-1)!=="/"&&(M+="/"),at=this.files[M]),at&&!at.dir)delete this.files[M];else for(var Q=this.filter(function(k,ct){return ct.name.slice(0,M.length)===M}),ot=0;ot<Q.length;ot++)delete this.files[Q[ot].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(M){var at,Q={};try{if((Q=a.extend(M||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=Q.type.toLowerCase(),Q.compression=Q.compression.toUpperCase(),Q.type==="binarystring"&&(Q.type="string"),!Q.type)throw new Error("No output type specified.");a.checkSupport(Q.type),Q.platform!=="darwin"&&Q.platform!=="freebsd"&&Q.platform!=="linux"&&Q.platform!=="sunos"||(Q.platform="UNIX"),Q.platform==="win32"&&(Q.platform="DOS");var ot=Q.comment||this.comment||"";at=_.generateWorker(this,Q,ot)}catch(k){(at=new d("error")).error(k)}return new N(at,Q.type||"string",Q.mimeType)},generateAsync:function(M,at){return this.generateInternalStream(M).accumulate(at)},generateNodeStream:function(M,at){return(M=M||{}).type||(M.type="nodebuffer"),this.generateInternalStream(M).toNodejsStream(at)}};n.exports=V},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,s){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,s){var o=e("./DataReader");function l(a){o.call(this,a);for(var d=0;d<this.data.length;d++)a[d]=255&a[d]}e("../utils").inherits(l,o),l.prototype.byteAt=function(a){return this.data[this.zero+a]},l.prototype.lastIndexOfSignature=function(a){for(var d=a.charCodeAt(0),N=a.charCodeAt(1),S=a.charCodeAt(2),I=a.charCodeAt(3),D=this.length-4;0<=D;--D)if(this.data[D]===d&&this.data[D+1]===N&&this.data[D+2]===S&&this.data[D+3]===I)return D-this.zero;return-1},l.prototype.readAndCheckSignature=function(a){var d=a.charCodeAt(0),N=a.charCodeAt(1),S=a.charCodeAt(2),I=a.charCodeAt(3),D=this.readData(4);return d===D[0]&&N===D[1]&&S===D[2]&&I===D[3]},l.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},n.exports=l},{"../utils":32,"./DataReader":18}],18:[function(e,n,s){var o=e("../utils");function l(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var d,N=0;for(this.checkOffset(a),d=this.index+a-1;d>=this.index;d--)N=(N<<8)+this.byteAt(d);return this.index+=a,N},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=l},{"../utils":32}],19:[function(e,n,s){var o=e("./Uint8ArrayReader");function l(a){o.call(this,a)}e("../utils").inherits(l,o),l.prototype.readData=function(a){this.checkOffset(a);var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},n.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,s){var o=e("./DataReader");function l(a){o.call(this,a)}e("../utils").inherits(l,o),l.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},l.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},l.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},l.prototype.readData=function(a){this.checkOffset(a);var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},n.exports=l},{"../utils":32,"./DataReader":18}],21:[function(e,n,s){var o=e("./ArrayReader");function l(a){o.call(this,a)}e("../utils").inherits(l,o),l.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},n.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,s){var o=e("../utils"),l=e("../support"),a=e("./ArrayReader"),d=e("./StringReader"),N=e("./NodeBufferReader"),S=e("./Uint8ArrayReader");n.exports=function(I){var D=o.getTypeOf(I);return o.checkSupport(D),D!=="string"||l.uint8array?D==="nodebuffer"?new N(I):l.uint8array?new S(o.transformTo("uint8array",I)):new a(o.transformTo("array",I)):new d(I)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,s){var o=e("./GenericWorker"),l=e("../utils");function a(d){o.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(a,o),a.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,s){var o=e("./GenericWorker"),l=e("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,o),a.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,s){var o=e("../utils"),l=e("./GenericWorker");function a(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}o.inherits(a,l),a.prototype.processChunk=function(d){if(d){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+d.data.length}l.prototype.processChunk.call(this,d)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,s){var o=e("../utils"),l=e("./GenericWorker");function a(d){l.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(S){N.dataIsReady=!0,N.data=S,N.max=S&&S.length||0,N.type=o.getTypeOf(S),N.isPaused||N._tickAndRepeat()},function(S){N.error(S)})}o.inherits(a,l),a.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,N);break;case"uint8array":d=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":d=this.data.slice(this.index,N)}return this.index=N,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,s){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,a){return this._listeners[l].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,a){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,a)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var a=this;return l.on("data",function(d){a.processChunk(d)}),l.on("end",function(){a.end()}),l.on("error",function(d){a.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,a){return this.extraStreamInfo[l]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},n.exports=o},{}],29:[function(e,n,s){var o=e("../utils"),l=e("./ConvertWorker"),a=e("./GenericWorker"),d=e("../base64"),N=e("../support"),S=e("../external"),I=null;if(N.nodestream)try{I=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function D(v,g){return new S.Promise(function(E,f){var A=[],O=v._internalType,V=v._outputType,M=v._mimeType;v.on("data",function(at,Q){A.push(at),g&&g(Q)}).on("error",function(at){A=[],f(at)}).on("end",function(){try{var at=function(Q,ot,k){switch(Q){case"blob":return o.newBlob(o.transformTo("arraybuffer",ot),k);case"base64":return d.encode(ot);default:return o.transformTo(Q,ot)}}(V,function(Q,ot){var k,ct=0,vt=null,U=0;for(k=0;k<ot.length;k++)U+=ot[k].length;switch(Q){case"string":return ot.join("");case"array":return Array.prototype.concat.apply([],ot);case"uint8array":for(vt=new Uint8Array(U),k=0;k<ot.length;k++)vt.set(ot[k],ct),ct+=ot[k].length;return vt;case"nodebuffer":return _t.concat(ot);default:throw new Error("concat : unsupported type '"+Q+"'")}}(O,A),M);E(at)}catch(Q){f(Q)}A=[]}).resume()})}function _(v,g,E){var f=g;switch(g){case"blob":case"arraybuffer":f="uint8array";break;case"base64":f="string"}try{this._internalType=f,this._outputType=g,this._mimeType=E,o.checkSupport(f),this._worker=v.pipe(new l(f)),v.lock()}catch(A){this._worker=new a("error"),this._worker.error(A)}}_.prototype={accumulate:function(v){return D(this,v)},on:function(v,g){var E=this;return v==="data"?this._worker.on(v,function(f){g.call(E,f.data,f.meta)}):this._worker.on(v,function(){o.delay(g,arguments,E)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new I(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof _t<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var o=new ArrayBuffer(0);try{s.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),s.blob=l.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,s){for(var o=e("./utils"),l=e("./support"),a=e("./nodejsUtils"),d=e("./stream/GenericWorker"),N=new Array(256),S=0;S<256;S++)N[S]=252<=S?6:248<=S?5:240<=S?4:224<=S?3:192<=S?2:1;N[254]=N[254]=1;function I(){d.call(this,"utf-8 decode"),this.leftOver=null}function D(){d.call(this,"utf-8 encode")}s.utf8encode=function(_){return l.nodebuffer?a.newBufferFrom(_,"utf-8"):function(v){var g,E,f,A,O,V=v.length,M=0;for(A=0;A<V;A++)(64512&(E=v.charCodeAt(A)))==55296&&A+1<V&&(64512&(f=v.charCodeAt(A+1)))==56320&&(E=65536+(E-55296<<10)+(f-56320),A++),M+=E<128?1:E<2048?2:E<65536?3:4;for(g=l.uint8array?new Uint8Array(M):new Array(M),A=O=0;O<M;A++)(64512&(E=v.charCodeAt(A)))==55296&&A+1<V&&(64512&(f=v.charCodeAt(A+1)))==56320&&(E=65536+(E-55296<<10)+(f-56320),A++),E<128?g[O++]=E:(E<2048?g[O++]=192|E>>>6:(E<65536?g[O++]=224|E>>>12:(g[O++]=240|E>>>18,g[O++]=128|E>>>12&63),g[O++]=128|E>>>6&63),g[O++]=128|63&E);return g}(_)},s.utf8decode=function(_){return l.nodebuffer?o.transformTo("nodebuffer",_).toString("utf-8"):function(v){var g,E,f,A,O=v.length,V=new Array(2*O);for(g=E=0;g<O;)if((f=v[g++])<128)V[E++]=f;else if(4<(A=N[f]))V[E++]=65533,g+=A-1;else{for(f&=A===2?31:A===3?15:7;1<A&&g<O;)f=f<<6|63&v[g++],A--;1<A?V[E++]=65533:f<65536?V[E++]=f:(f-=65536,V[E++]=55296|f>>10&1023,V[E++]=56320|1023&f)}return V.length!==E&&(V.subarray?V=V.subarray(0,E):V.length=E),o.applyFromCharCode(V)}(_=o.transformTo(l.uint8array?"uint8array":"array",_))},o.inherits(I,d),I.prototype.processChunk=function(_){var v=o.transformTo(l.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var g=v;(v=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),v.set(g,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var E=function(A,O){var V;for((O=O||A.length)>A.length&&(O=A.length),V=O-1;0<=V&&(192&A[V])==128;)V--;return V<0||V===0?O:V+N[A[V]]>O?V:O}(v),f=v;E!==v.length&&(l.uint8array?(f=v.subarray(0,E),this.leftOver=v.subarray(E,v.length)):(f=v.slice(0,E),this.leftOver=v.slice(E,v.length))),this.push({data:s.utf8decode(f),meta:_.meta})},I.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=I,o.inherits(D,d),D.prototype.processChunk=function(_){this.push({data:s.utf8encode(_.data),meta:_.meta})},s.Utf8EncodeWorker=D},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,s){var o=e("./support"),l=e("./base64"),a=e("./nodejsUtils"),d=e("./external");function N(g){return g}function S(g,E){for(var f=0;f<g.length;++f)E[f]=255&g.charCodeAt(f);return E}e("setimmediate"),s.newBlob=function(g,E){s.checkSupport("blob");try{return new Blob([g],{type:E})}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return f.append(g),f.getBlob(E)}catch{throw new Error("Bug : can't construct the Blob.")}}};var I={stringifyByChunk:function(g,E,f){var A=[],O=0,V=g.length;if(V<=f)return String.fromCharCode.apply(null,g);for(;O<V;)E==="array"||E==="nodebuffer"?A.push(String.fromCharCode.apply(null,g.slice(O,Math.min(O+f,V)))):A.push(String.fromCharCode.apply(null,g.subarray(O,Math.min(O+f,V)))),O+=f;return A.join("")},stringifyByChar:function(g){for(var E="",f=0;f<g.length;f++)E+=String.fromCharCode(g[f]);return E},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function D(g){var E=65536,f=s.getTypeOf(g),A=!0;if(f==="uint8array"?A=I.applyCanBeUsed.uint8array:f==="nodebuffer"&&(A=I.applyCanBeUsed.nodebuffer),A)for(;1<E;)try{return I.stringifyByChunk(g,f,E)}catch{E=Math.floor(E/2)}return I.stringifyByChar(g)}function _(g,E){for(var f=0;f<g.length;f++)E[f]=g[f];return E}s.applyFromCharCode=D;var v={};v.string={string:N,array:function(g){return S(g,new Array(g.length))},arraybuffer:function(g){return v.string.uint8array(g).buffer},uint8array:function(g){return S(g,new Uint8Array(g.length))},nodebuffer:function(g){return S(g,a.allocBuffer(g.length))}},v.array={string:D,array:N,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},v.arraybuffer={string:function(g){return D(new Uint8Array(g))},array:function(g){return _(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:N,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},v.uint8array={string:D,array:function(g){return _(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:N,nodebuffer:function(g){return a.newBufferFrom(g)}},v.nodebuffer={string:D,array:function(g){return _(g,new Array(g.length))},arraybuffer:function(g){return v.nodebuffer.uint8array(g).buffer},uint8array:function(g){return _(g,new Uint8Array(g.length))},nodebuffer:N},s.transformTo=function(g,E){if(E=E||"",!g)return E;s.checkSupport(g);var f=s.getTypeOf(E);return v[f][g](E)},s.resolve=function(g){for(var E=g.split("/"),f=[],A=0;A<E.length;A++){var O=E[A];O==="."||O===""&&A!==0&&A!==E.length-1||(O===".."?f.pop():f.push(O))}return f.join("/")},s.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(g){var E,f,A="";for(f=0;f<(g||"").length;f++)A+="\\x"+((E=g.charCodeAt(f))<16?"0":"")+E.toString(16).toUpperCase();return A},s.delay=function(g,E,f){setImmediate(function(){g.apply(f||null,E||[])})},s.inherits=function(g,E){function f(){}f.prototype=E.prototype,g.prototype=new f},s.extend=function(){var g,E,f={};for(g=0;g<arguments.length;g++)for(E in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],E)&&f[E]===void 0&&(f[E]=arguments[g][E]);return f},s.prepareContent=function(g,E,f,A,O){return d.Promise.resolve(E).then(function(V){return o.blob&&(V instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(V))!==-1)&&typeof FileReader<"u"?new d.Promise(function(M,at){var Q=new FileReader;Q.onload=function(ot){M(ot.target.result)},Q.onerror=function(ot){at(ot.target.error)},Q.readAsArrayBuffer(V)}):V}).then(function(V){var M=s.getTypeOf(V);return M?(M==="arraybuffer"?V=s.transformTo("uint8array",V):M==="string"&&(O?V=l.decode(V):f&&A!==!0&&(V=function(at){return S(at,o.uint8array?new Uint8Array(at.length):new Array(at.length))}(V))),V):d.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,s){var o=e("./reader/readerFor"),l=e("./utils"),a=e("./signature"),d=e("./zipEntry"),N=e("./support");function S(I){this.files=[],this.loadOptions=I}S.prototype={checkSignature:function(I){if(!this.reader.readAndCheckSignature(I)){this.reader.index-=4;var D=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(D)+", expected "+l.pretty(I)+")")}},isSignature:function(I,D){var _=this.reader.index;this.reader.setIndex(I);var v=this.reader.readString(4)===D;return this.reader.setIndex(_),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var I=this.reader.readData(this.zipCommentLength),D=N.uint8array?"uint8array":"array",_=l.transformTo(D,I);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var I,D,_,v=this.zip64EndOfCentralSize-44;0<v;)I=this.reader.readInt(2),D=this.reader.readInt(4),_=this.reader.readData(D),this.zip64ExtensibleData[I]={id:I,length:D,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var I,D;for(I=0;I<this.files.length;I++)D=this.files[I],this.reader.setIndex(D.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),D.readLocalPart(this.reader),D.handleUTF8(),D.processAttributes()},readCentralDir:function(){var I;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(I=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(I);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var I=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(I<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(I);var D=I;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(I=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(I),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var _=this.centralDirOffset+this.centralDirSize;this.zip64&&(_+=20,_+=12+this.zip64EndOfCentralSize);var v=D-_;if(0<v)this.isSignature(D,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(I){this.reader=o(I)},load:function(I){this.prepareReader(I),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=S},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,s){var o=e("./reader/readerFor"),l=e("./utils"),a=e("./compressedObject"),d=e("./crc32"),N=e("./utf8"),S=e("./compressions"),I=e("./support");function D(_,v){this.options=_,this.loadOptions=v}D.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(_){var v,g;if(_.skip(22),this.fileNameLength=_.readInt(2),g=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(E){for(var f in S)if(Object.prototype.hasOwnProperty.call(S,f)&&S[f].magic===E)return S[f];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var v=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(v),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),_==0&&(this.dosPermissions=63&this.externalFileAttributes),_==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var _=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(_){var v,g,E,f=_.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});_.index+4<f;)v=_.readInt(2),g=_.readInt(2),E=_.readData(g),this.extraFields[v]={id:v,length:g,value:E};_.setIndex(f)},handleUTF8:function(){var _=I.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var g=l.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var f=l.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(f)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var v=o(_.value);return v.readInt(1)!==1||d(this.fileName)!==v.readInt(4)?null:N.utf8decode(v.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var v=o(_.value);return v.readInt(1)!==1||d(this.fileComment)!==v.readInt(4)?null:N.utf8decode(v.readData(_.length-5))}return null}},n.exports=D},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,s){function o(v,g,E){this.name=v,this.dir=E.dir,this.date=E.date,this.comment=E.comment,this.unixPermissions=E.unixPermissions,this.dosPermissions=E.dosPermissions,this._data=g,this._dataBinary=E.binary,this.options={compression:E.compression,compressionOptions:E.compressionOptions}}var l=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),d=e("./utf8"),N=e("./compressedObject"),S=e("./stream/GenericWorker");o.prototype={internalStream:function(v){var g=null,E="string";try{if(!v)throw new Error("No output type specified.");var f=(E=v.toLowerCase())==="string"||E==="text";E!=="binarystring"&&E!=="text"||(E="string"),g=this._decompressWorker();var A=!this._dataBinary;A&&!f&&(g=g.pipe(new d.Utf8EncodeWorker)),!A&&f&&(g=g.pipe(new d.Utf8DecodeWorker))}catch(O){(g=new S("error")).error(O)}return new l(g,E,"")},async:function(v,g){return this.internalStream(v).accumulate(g)},nodeStream:function(v,g){return this.internalStream(v||"nodebuffer").toNodejsStream(g)},_compressWorker:function(v,g){if(this._data instanceof N&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var E=this._decompressWorker();return this._dataBinary||(E=E.pipe(new d.Utf8EncodeWorker)),N.createWorkerFrom(E,v,g)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof S?this._data:new a(this._data)}};for(var I=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],D=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<I.length;_++)o.prototype[I[_]]=D;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,s){(function(o){var l,a,d=o.MutationObserver||o.WebKitMutationObserver;if(d){var N=0,S=new d(v),I=o.document.createTextNode("");S.observe(I,{characterData:!0}),l=function(){I.data=N=++N%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){v(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(v,0)};else{var D=new o.MessageChannel;D.port1.onmessage=v,l=function(){D.port2.postMessage(0)}}var _=[];function v(){var g,E;a=!0;for(var f=_.length;f;){for(E=_,_=[],g=-1;++g<f;)E[g]();f=_.length}a=!1}n.exports=function(g){_.push(g)!==1||a||l()}}).call(this,typeof ce<"u"?ce:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,s){var o=e("immediate");function l(){}var a={},d=["REJECTED"],N=["FULFILLED"],S=["PENDING"];function I(f){if(typeof f!="function")throw new TypeError("resolver must be a function");this.state=S,this.queue=[],this.outcome=void 0,f!==l&&g(this,f)}function D(f,A,O){this.promise=f,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}function _(f,A,O){o(function(){var V;try{V=A(O)}catch(M){return a.reject(f,M)}V===f?a.reject(f,new TypeError("Cannot resolve promise with itself")):a.resolve(f,V)})}function v(f){var A=f&&f.then;if(f&&(typeof f=="object"||typeof f=="function")&&typeof A=="function")return function(){A.apply(f,arguments)}}function g(f,A){var O=!1;function V(Q){O||(O=!0,a.reject(f,Q))}function M(Q){O||(O=!0,a.resolve(f,Q))}var at=E(function(){A(M,V)});at.status==="error"&&V(at.value)}function E(f,A){var O={};try{O.value=f(A),O.status="success"}catch(V){O.status="error",O.value=V}return O}(n.exports=I).prototype.finally=function(f){if(typeof f!="function")return this;var A=this.constructor;return this.then(function(O){return A.resolve(f()).then(function(){return O})},function(O){return A.resolve(f()).then(function(){throw O})})},I.prototype.catch=function(f){return this.then(null,f)},I.prototype.then=function(f,A){if(typeof f!="function"&&this.state===N||typeof A!="function"&&this.state===d)return this;var O=new this.constructor(l);return this.state!==S?_(O,this.state===N?f:A,this.outcome):this.queue.push(new D(O,f,A)),O},D.prototype.callFulfilled=function(f){a.resolve(this.promise,f)},D.prototype.otherCallFulfilled=function(f){_(this.promise,this.onFulfilled,f)},D.prototype.callRejected=function(f){a.reject(this.promise,f)},D.prototype.otherCallRejected=function(f){_(this.promise,this.onRejected,f)},a.resolve=function(f,A){var O=E(v,A);if(O.status==="error")return a.reject(f,O.value);var V=O.value;if(V)g(f,V);else{f.state=N,f.outcome=A;for(var M=-1,at=f.queue.length;++M<at;)f.queue[M].callFulfilled(A)}return f},a.reject=function(f,A){f.state=d,f.outcome=A;for(var O=-1,V=f.queue.length;++O<V;)f.queue[O].callRejected(A);return f},I.resolve=function(f){return f instanceof this?f:a.resolve(new this(l),f)},I.reject=function(f){var A=new this(l);return a.reject(A,f)},I.all=function(f){var A=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=f.length,V=!1;if(!O)return this.resolve([]);for(var M=new Array(O),at=0,Q=-1,ot=new this(l);++Q<O;)k(f[Q],Q);return ot;function k(ct,vt){A.resolve(ct).then(function(U){M[vt]=U,++at!==O||V||(V=!0,a.resolve(ot,M))},function(U){V||(V=!0,a.reject(ot,U))})}},I.race=function(f){var A=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=f.length,V=!1;if(!O)return this.resolve([]);for(var M=-1,at=new this(l);++M<O;)Q=f[M],A.resolve(Q).then(function(ot){V||(V=!0,a.resolve(at,ot))},function(ot){V||(V=!0,a.reject(at,ot))});var Q;return at}},{immediate:36}],38:[function(e,n,s){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,s){var o=e("./zlib/deflate"),l=e("./utils/common"),a=e("./utils/strings"),d=e("./zlib/messages"),N=e("./zlib/zstream"),S=Object.prototype.toString,I=0,D=-1,_=0,v=8;function g(f){if(!(this instanceof g))return new g(f);this.options=l.assign({level:D,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},f||{});var A=this.options;A.raw&&0<A.windowBits?A.windowBits=-A.windowBits:A.gzip&&0<A.windowBits&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var O=o.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(O!==I)throw new Error(d[O]);if(A.header&&o.deflateSetHeader(this.strm,A.header),A.dictionary){var V;if(V=typeof A.dictionary=="string"?a.string2buf(A.dictionary):S.call(A.dictionary)==="[object ArrayBuffer]"?new Uint8Array(A.dictionary):A.dictionary,(O=o.deflateSetDictionary(this.strm,V))!==I)throw new Error(d[O]);this._dict_set=!0}}function E(f,A){var O=new g(A);if(O.push(f,!0),O.err)throw O.msg||d[O.err];return O.result}g.prototype.push=function(f,A){var O,V,M=this.strm,at=this.options.chunkSize;if(this.ended)return!1;V=A===~~A?A:A===!0?4:0,typeof f=="string"?M.input=a.string2buf(f):S.call(f)==="[object ArrayBuffer]"?M.input=new Uint8Array(f):M.input=f,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new l.Buf8(at),M.next_out=0,M.avail_out=at),(O=o.deflate(M,V))!==1&&O!==I)return this.onEnd(O),!(this.ended=!0);M.avail_out!==0&&(M.avail_in!==0||V!==4&&V!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(l.shrinkBuf(M.output,M.next_out))):this.onData(l.shrinkBuf(M.output,M.next_out)))}while((0<M.avail_in||M.avail_out===0)&&O!==1);return V===4?(O=o.deflateEnd(this.strm),this.onEnd(O),this.ended=!0,O===I):V!==2||(this.onEnd(I),!(M.avail_out=0))},g.prototype.onData=function(f){this.chunks.push(f)},g.prototype.onEnd=function(f){f===I&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},s.Deflate=g,s.deflate=E,s.deflateRaw=function(f,A){return(A=A||{}).raw=!0,E(f,A)},s.gzip=function(f,A){return(A=A||{}).gzip=!0,E(f,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,s){var o=e("./zlib/inflate"),l=e("./utils/common"),a=e("./utils/strings"),d=e("./zlib/constants"),N=e("./zlib/messages"),S=e("./zlib/zstream"),I=e("./zlib/gzheader"),D=Object.prototype.toString;function _(g){if(!(this instanceof _))return new _(g);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},g||{});var E=this.options;E.raw&&0<=E.windowBits&&E.windowBits<16&&(E.windowBits=-E.windowBits,E.windowBits===0&&(E.windowBits=-15)),!(0<=E.windowBits&&E.windowBits<16)||g&&g.windowBits||(E.windowBits+=32),15<E.windowBits&&E.windowBits<48&&!(15&E.windowBits)&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new S,this.strm.avail_out=0;var f=o.inflateInit2(this.strm,E.windowBits);if(f!==d.Z_OK)throw new Error(N[f]);this.header=new I,o.inflateGetHeader(this.strm,this.header)}function v(g,E){var f=new _(E);if(f.push(g,!0),f.err)throw f.msg||N[f.err];return f.result}_.prototype.push=function(g,E){var f,A,O,V,M,at,Q=this.strm,ot=this.options.chunkSize,k=this.options.dictionary,ct=!1;if(this.ended)return!1;A=E===~~E?E:E===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof g=="string"?Q.input=a.binstring2buf(g):D.call(g)==="[object ArrayBuffer]"?Q.input=new Uint8Array(g):Q.input=g,Q.next_in=0,Q.avail_in=Q.input.length;do{if(Q.avail_out===0&&(Q.output=new l.Buf8(ot),Q.next_out=0,Q.avail_out=ot),(f=o.inflate(Q,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&k&&(at=typeof k=="string"?a.string2buf(k):D.call(k)==="[object ArrayBuffer]"?new Uint8Array(k):k,f=o.inflateSetDictionary(this.strm,at)),f===d.Z_BUF_ERROR&&ct===!0&&(f=d.Z_OK,ct=!1),f!==d.Z_STREAM_END&&f!==d.Z_OK)return this.onEnd(f),!(this.ended=!0);Q.next_out&&(Q.avail_out!==0&&f!==d.Z_STREAM_END&&(Q.avail_in!==0||A!==d.Z_FINISH&&A!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(O=a.utf8border(Q.output,Q.next_out),V=Q.next_out-O,M=a.buf2string(Q.output,O),Q.next_out=V,Q.avail_out=ot-V,V&&l.arraySet(Q.output,Q.output,O,V,0),this.onData(M)):this.onData(l.shrinkBuf(Q.output,Q.next_out)))),Q.avail_in===0&&Q.avail_out===0&&(ct=!0)}while((0<Q.avail_in||Q.avail_out===0)&&f!==d.Z_STREAM_END);return f===d.Z_STREAM_END&&(A=d.Z_FINISH),A===d.Z_FINISH?(f=o.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===d.Z_OK):A!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(Q.avail_out=0))},_.prototype.onData=function(g){this.chunks.push(g)},_.prototype.onEnd=function(g){g===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},s.Inflate=_,s.inflate=v,s.inflateRaw=function(g,E){return(E=E||{}).raw=!0,v(g,E)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,s){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(d){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var S=N.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var I in S)S.hasOwnProperty(I)&&(d[I]=S[I])}}return d},s.shrinkBuf=function(d,N){return d.length===N?d:d.subarray?d.subarray(0,N):(d.length=N,d)};var l={arraySet:function(d,N,S,I,D){if(N.subarray&&d.subarray)d.set(N.subarray(S,S+I),D);else for(var _=0;_<I;_++)d[D+_]=N[S+_]},flattenChunks:function(d){var N,S,I,D,_,v;for(N=I=0,S=d.length;N<S;N++)I+=d[N].length;for(v=new Uint8Array(I),N=D=0,S=d.length;N<S;N++)_=d[N],v.set(_,D),D+=_.length;return v}},a={arraySet:function(d,N,S,I,D){for(var _=0;_<I;_++)d[D+_]=N[S+_]},flattenChunks:function(d){return[].concat.apply([],d)}};s.setTyped=function(d){d?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,l)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(o)},{}],42:[function(e,n,s){var o=e("./common"),l=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var d=new o.Buf8(256),N=0;N<256;N++)d[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function S(I,D){if(D<65537&&(I.subarray&&a||!I.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(I,D));for(var _="",v=0;v<D;v++)_+=String.fromCharCode(I[v]);return _}d[254]=d[254]=1,s.string2buf=function(I){var D,_,v,g,E,f=I.length,A=0;for(g=0;g<f;g++)(64512&(_=I.charCodeAt(g)))==55296&&g+1<f&&(64512&(v=I.charCodeAt(g+1)))==56320&&(_=65536+(_-55296<<10)+(v-56320),g++),A+=_<128?1:_<2048?2:_<65536?3:4;for(D=new o.Buf8(A),g=E=0;E<A;g++)(64512&(_=I.charCodeAt(g)))==55296&&g+1<f&&(64512&(v=I.charCodeAt(g+1)))==56320&&(_=65536+(_-55296<<10)+(v-56320),g++),_<128?D[E++]=_:(_<2048?D[E++]=192|_>>>6:(_<65536?D[E++]=224|_>>>12:(D[E++]=240|_>>>18,D[E++]=128|_>>>12&63),D[E++]=128|_>>>6&63),D[E++]=128|63&_);return D},s.buf2binstring=function(I){return S(I,I.length)},s.binstring2buf=function(I){for(var D=new o.Buf8(I.length),_=0,v=D.length;_<v;_++)D[_]=I.charCodeAt(_);return D},s.buf2string=function(I,D){var _,v,g,E,f=D||I.length,A=new Array(2*f);for(_=v=0;_<f;)if((g=I[_++])<128)A[v++]=g;else if(4<(E=d[g]))A[v++]=65533,_+=E-1;else{for(g&=E===2?31:E===3?15:7;1<E&&_<f;)g=g<<6|63&I[_++],E--;1<E?A[v++]=65533:g<65536?A[v++]=g:(g-=65536,A[v++]=55296|g>>10&1023,A[v++]=56320|1023&g)}return S(A,v)},s.utf8border=function(I,D){var _;for((D=D||I.length)>I.length&&(D=I.length),_=D-1;0<=_&&(192&I[_])==128;)_--;return _<0||_===0?D:_+d[I[_]]>D?_:D}},{"./common":41}],43:[function(e,n,s){n.exports=function(o,l,a,d){for(var N=65535&o|0,S=o>>>16&65535|0,I=0;a!==0;){for(a-=I=2e3<a?2e3:a;S=S+(N=N+l[d++]|0)|0,--I;);N%=65521,S%=65521}return N|S<<16|0}},{}],44:[function(e,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,s){var o=function(){for(var l,a=[],d=0;d<256;d++){l=d;for(var N=0;N<8;N++)l=1&l?3988292384^l>>>1:l>>>1;a[d]=l}return a}();n.exports=function(l,a,d,N){var S=o,I=N+d;l^=-1;for(var D=N;D<I;D++)l=l>>>8^S[255&(l^a[D])];return-1^l}},{}],46:[function(e,n,s){var o,l=e("../utils/common"),a=e("./trees"),d=e("./adler32"),N=e("./crc32"),S=e("./messages"),I=0,D=4,_=0,v=-2,g=-1,E=4,f=2,A=8,O=9,V=286,M=30,at=19,Q=2*V+1,ot=15,k=3,ct=258,vt=ct+k+1,U=42,tt=113,p=1,st=2,xt=3,P=4;function J(h,et){return h.msg=S[et],et}function G(h){return(h<<1)-(4<h?9:0)}function ut(h){for(var et=h.length;0<=--et;)h[et]=0}function L(h){var et=h.state,c=et.pending;c>h.avail_out&&(c=h.avail_out),c!==0&&(l.arraySet(h.output,et.pending_buf,et.pending_out,c,h.next_out),h.next_out+=c,et.pending_out+=c,h.total_out+=c,h.avail_out-=c,et.pending-=c,et.pending===0&&(et.pending_out=0))}function W(h,et){a._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,et),h.block_start=h.strstart,L(h.strm)}function wt(h,et){h.pending_buf[h.pending++]=et}function mt(h,et){h.pending_buf[h.pending++]=et>>>8&255,h.pending_buf[h.pending++]=255&et}function ht(h,et){var c,r,i=h.max_chain_length,u=h.strstart,y=h.prev_length,z=h.nice_match,x=h.strstart>h.w_size-vt?h.strstart-(h.w_size-vt):0,Z=h.window,it=h.w_mask,rt=h.prev,ft=h.strstart+ct,Ct=Z[u+y-1],kt=Z[u+y];h.prev_length>=h.good_match&&(i>>=2),z>h.lookahead&&(z=h.lookahead);do if(Z[(c=et)+y]===kt&&Z[c+y-1]===Ct&&Z[c]===Z[u]&&Z[++c]===Z[u+1]){u+=2,c++;do;while(Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&Z[++u]===Z[++c]&&u<ft);if(r=ct-(ft-u),u=ft-ct,y<r){if(h.match_start=et,z<=(y=r))break;Ct=Z[u+y-1],kt=Z[u+y]}}while((et=rt[et&it])>x&&--i!=0);return y<=h.lookahead?y:h.lookahead}function Ft(h){var et,c,r,i,u,y,z,x,Z,it,rt=h.w_size;do{if(i=h.window_size-h.lookahead-h.strstart,h.strstart>=rt+(rt-vt)){for(l.arraySet(h.window,h.window,rt,rt,0),h.match_start-=rt,h.strstart-=rt,h.block_start-=rt,et=c=h.hash_size;r=h.head[--et],h.head[et]=rt<=r?r-rt:0,--c;);for(et=c=rt;r=h.prev[--et],h.prev[et]=rt<=r?r-rt:0,--c;);i+=rt}if(h.strm.avail_in===0)break;if(y=h.strm,z=h.window,x=h.strstart+h.lookahead,Z=i,it=void 0,it=y.avail_in,Z<it&&(it=Z),c=it===0?0:(y.avail_in-=it,l.arraySet(z,y.input,y.next_in,it,x),y.state.wrap===1?y.adler=d(y.adler,z,it,x):y.state.wrap===2&&(y.adler=N(y.adler,z,it,x)),y.next_in+=it,y.total_in+=it,it),h.lookahead+=c,h.lookahead+h.insert>=k)for(u=h.strstart-h.insert,h.ins_h=h.window[u],h.ins_h=(h.ins_h<<h.hash_shift^h.window[u+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[u+k-1])&h.hash_mask,h.prev[u&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=u,u++,h.insert--,!(h.lookahead+h.insert<k)););}while(h.lookahead<vt&&h.strm.avail_in!==0)}function b(h,et){for(var c,r;;){if(h.lookahead<vt){if(Ft(h),h.lookahead<vt&&et===I)return p;if(h.lookahead===0)break}if(c=0,h.lookahead>=k&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+k-1])&h.hash_mask,c=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),c!==0&&h.strstart-c<=h.w_size-vt&&(h.match_length=ht(h,c)),h.match_length>=k)if(r=a._tr_tally(h,h.strstart-h.match_start,h.match_length-k),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=k){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+k-1])&h.hash_mask,c=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else r=a._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(r&&(W(h,!1),h.strm.avail_out===0))return p}return h.insert=h.strstart<k-1?h.strstart:k-1,et===D?(W(h,!0),h.strm.avail_out===0?xt:P):h.last_lit&&(W(h,!1),h.strm.avail_out===0)?p:st}function m(h,et){for(var c,r,i;;){if(h.lookahead<vt){if(Ft(h),h.lookahead<vt&&et===I)return p;if(h.lookahead===0)break}if(c=0,h.lookahead>=k&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+k-1])&h.hash_mask,c=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=k-1,c!==0&&h.prev_length<h.max_lazy_match&&h.strstart-c<=h.w_size-vt&&(h.match_length=ht(h,c),h.match_length<=5&&(h.strategy===1||h.match_length===k&&4096<h.strstart-h.match_start)&&(h.match_length=k-1)),h.prev_length>=k&&h.match_length<=h.prev_length){for(i=h.strstart+h.lookahead-k,r=a._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-k),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=i&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+k-1])&h.hash_mask,c=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=k-1,h.strstart++,r&&(W(h,!1),h.strm.avail_out===0))return p}else if(h.match_available){if((r=a._tr_tally(h,0,h.window[h.strstart-1]))&&W(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return p}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(r=a._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<k-1?h.strstart:k-1,et===D?(W(h,!0),h.strm.avail_out===0?xt:P):h.last_lit&&(W(h,!1),h.strm.avail_out===0)?p:st}function Y(h,et,c,r,i){this.good_length=h,this.max_lazy=et,this.nice_length=c,this.max_chain=r,this.func=i}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*Q),this.dyn_dtree=new l.Buf16(2*(2*M+1)),this.bl_tree=new l.Buf16(2*(2*at+1)),ut(this.dyn_ltree),ut(this.dyn_dtree),ut(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(ot+1),this.heap=new l.Buf16(2*V+1),ut(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*V+1),ut(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function bt(h){var et;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=f,(et=h.state).pending=0,et.pending_out=0,et.wrap<0&&(et.wrap=-et.wrap),et.status=et.wrap?U:tt,h.adler=et.wrap===2?0:1,et.last_flush=I,a._tr_init(et),_):J(h,v)}function St(h){var et=bt(h);return et===_&&function(c){c.window_size=2*c.w_size,ut(c.head),c.max_lazy_match=o[c.level].max_lazy,c.good_match=o[c.level].good_length,c.nice_match=o[c.level].nice_length,c.max_chain_length=o[c.level].max_chain,c.strstart=0,c.block_start=0,c.lookahead=0,c.insert=0,c.match_length=c.prev_length=k-1,c.match_available=0,c.ins_h=0}(h.state),et}function Nt(h,et,c,r,i,u){if(!h)return v;var y=1;if(et===g&&(et=6),r<0?(y=0,r=-r):15<r&&(y=2,r-=16),i<1||O<i||c!==A||r<8||15<r||et<0||9<et||u<0||E<u)return J(h,v);r===8&&(r=9);var z=new j;return(h.state=z).strm=h,z.wrap=y,z.gzhead=null,z.w_bits=r,z.w_size=1<<z.w_bits,z.w_mask=z.w_size-1,z.hash_bits=i+7,z.hash_size=1<<z.hash_bits,z.hash_mask=z.hash_size-1,z.hash_shift=~~((z.hash_bits+k-1)/k),z.window=new l.Buf8(2*z.w_size),z.head=new l.Buf16(z.hash_size),z.prev=new l.Buf16(z.w_size),z.lit_bufsize=1<<i+6,z.pending_buf_size=4*z.lit_bufsize,z.pending_buf=new l.Buf8(z.pending_buf_size),z.d_buf=1*z.lit_bufsize,z.l_buf=3*z.lit_bufsize,z.level=et,z.strategy=u,z.method=c,St(h)}o=[new Y(0,0,0,0,function(h,et){var c=65535;for(c>h.pending_buf_size-5&&(c=h.pending_buf_size-5);;){if(h.lookahead<=1){if(Ft(h),h.lookahead===0&&et===I)return p;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var r=h.block_start+c;if((h.strstart===0||h.strstart>=r)&&(h.lookahead=h.strstart-r,h.strstart=r,W(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-vt&&(W(h,!1),h.strm.avail_out===0))return p}return h.insert=0,et===D?(W(h,!0),h.strm.avail_out===0?xt:P):(h.strstart>h.block_start&&(W(h,!1),h.strm.avail_out),p)}),new Y(4,4,8,4,b),new Y(4,5,16,8,b),new Y(4,6,32,32,b),new Y(4,4,16,16,m),new Y(8,16,32,32,m),new Y(8,16,128,128,m),new Y(8,32,128,256,m),new Y(32,128,258,1024,m),new Y(32,258,258,4096,m)],s.deflateInit=function(h,et){return Nt(h,et,A,15,8,0)},s.deflateInit2=Nt,s.deflateReset=St,s.deflateResetKeep=bt,s.deflateSetHeader=function(h,et){return h&&h.state?h.state.wrap!==2?v:(h.state.gzhead=et,_):v},s.deflate=function(h,et){var c,r,i,u;if(!h||!h.state||5<et||et<0)return h?J(h,v):v;if(r=h.state,!h.output||!h.input&&h.avail_in!==0||r.status===666&&et!==D)return J(h,h.avail_out===0?-5:v);if(r.strm=h,c=r.last_flush,r.last_flush=et,r.status===U)if(r.wrap===2)h.adler=0,wt(r,31),wt(r,139),wt(r,8),r.gzhead?(wt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),wt(r,255&r.gzhead.time),wt(r,r.gzhead.time>>8&255),wt(r,r.gzhead.time>>16&255),wt(r,r.gzhead.time>>24&255),wt(r,r.level===9?2:2<=r.strategy||r.level<2?4:0),wt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(wt(r,255&r.gzhead.extra.length),wt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(h.adler=N(h.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(wt(r,0),wt(r,0),wt(r,0),wt(r,0),wt(r,0),wt(r,r.level===9?2:2<=r.strategy||r.level<2?4:0),wt(r,3),r.status=tt);else{var y=A+(r.w_bits-8<<4)<<8;y|=(2<=r.strategy||r.level<2?0:r.level<6?1:r.level===6?2:3)<<6,r.strstart!==0&&(y|=32),y+=31-y%31,r.status=tt,mt(r,y),r.strstart!==0&&(mt(r,h.adler>>>16),mt(r,65535&h.adler)),h.adler=1}if(r.status===69)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),L(h),i=r.pending,r.pending!==r.pending_buf_size));)wt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(r.status===73)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),L(h),i=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,wt(r,u)}while(u!==0);r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),u===0&&(r.gzindex=0,r.status=91)}else r.status=91;if(r.status===91)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),L(h),i=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,wt(r,u)}while(u!==0);r.gzhead.hcrc&&r.pending>i&&(h.adler=N(h.adler,r.pending_buf,r.pending-i,i)),u===0&&(r.status=103)}else r.status=103;if(r.status===103&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&L(h),r.pending+2<=r.pending_buf_size&&(wt(r,255&h.adler),wt(r,h.adler>>8&255),h.adler=0,r.status=tt)):r.status=tt),r.pending!==0){if(L(h),h.avail_out===0)return r.last_flush=-1,_}else if(h.avail_in===0&&G(et)<=G(c)&&et!==D)return J(h,-5);if(r.status===666&&h.avail_in!==0)return J(h,-5);if(h.avail_in!==0||r.lookahead!==0||et!==I&&r.status!==666){var z=r.strategy===2?function(x,Z){for(var it;;){if(x.lookahead===0&&(Ft(x),x.lookahead===0)){if(Z===I)return p;break}if(x.match_length=0,it=a._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,it&&(W(x,!1),x.strm.avail_out===0))return p}return x.insert=0,Z===D?(W(x,!0),x.strm.avail_out===0?xt:P):x.last_lit&&(W(x,!1),x.strm.avail_out===0)?p:st}(r,et):r.strategy===3?function(x,Z){for(var it,rt,ft,Ct,kt=x.window;;){if(x.lookahead<=ct){if(Ft(x),x.lookahead<=ct&&Z===I)return p;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=k&&0<x.strstart&&(rt=kt[ft=x.strstart-1])===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]){Ct=x.strstart+ct;do;while(rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&rt===kt[++ft]&&ft<Ct);x.match_length=ct-(Ct-ft),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=k?(it=a._tr_tally(x,1,x.match_length-k),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(it=a._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),it&&(W(x,!1),x.strm.avail_out===0))return p}return x.insert=0,Z===D?(W(x,!0),x.strm.avail_out===0?xt:P):x.last_lit&&(W(x,!1),x.strm.avail_out===0)?p:st}(r,et):o[r.level].func(r,et);if(z!==xt&&z!==P||(r.status=666),z===p||z===xt)return h.avail_out===0&&(r.last_flush=-1),_;if(z===st&&(et===1?a._tr_align(r):et!==5&&(a._tr_stored_block(r,0,0,!1),et===3&&(ut(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),L(h),h.avail_out===0))return r.last_flush=-1,_}return et!==D?_:r.wrap<=0?1:(r.wrap===2?(wt(r,255&h.adler),wt(r,h.adler>>8&255),wt(r,h.adler>>16&255),wt(r,h.adler>>24&255),wt(r,255&h.total_in),wt(r,h.total_in>>8&255),wt(r,h.total_in>>16&255),wt(r,h.total_in>>24&255)):(mt(r,h.adler>>>16),mt(r,65535&h.adler)),L(h),0<r.wrap&&(r.wrap=-r.wrap),r.pending!==0?_:1)},s.deflateEnd=function(h){var et;return h&&h.state?(et=h.state.status)!==U&&et!==69&&et!==73&&et!==91&&et!==103&&et!==tt&&et!==666?J(h,v):(h.state=null,et===tt?J(h,-3):_):v},s.deflateSetDictionary=function(h,et){var c,r,i,u,y,z,x,Z,it=et.length;if(!h||!h.state||(u=(c=h.state).wrap)===2||u===1&&c.status!==U||c.lookahead)return v;for(u===1&&(h.adler=d(h.adler,et,it,0)),c.wrap=0,it>=c.w_size&&(u===0&&(ut(c.head),c.strstart=0,c.block_start=0,c.insert=0),Z=new l.Buf8(c.w_size),l.arraySet(Z,et,it-c.w_size,c.w_size,0),et=Z,it=c.w_size),y=h.avail_in,z=h.next_in,x=h.input,h.avail_in=it,h.next_in=0,h.input=et,Ft(c);c.lookahead>=k;){for(r=c.strstart,i=c.lookahead-(k-1);c.ins_h=(c.ins_h<<c.hash_shift^c.window[r+k-1])&c.hash_mask,c.prev[r&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=r,r++,--i;);c.strstart=r,c.lookahead=k-1,Ft(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=k-1,c.match_available=0,h.next_in=z,h.input=x,h.avail_in=y,c.wrap=u,_},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,s){n.exports=function(o,l){var a,d,N,S,I,D,_,v,g,E,f,A,O,V,M,at,Q,ot,k,ct,vt,U,tt,p,st;a=o.state,d=o.next_in,p=o.input,N=d+(o.avail_in-5),S=o.next_out,st=o.output,I=S-(l-o.avail_out),D=S+(o.avail_out-257),_=a.dmax,v=a.wsize,g=a.whave,E=a.wnext,f=a.window,A=a.hold,O=a.bits,V=a.lencode,M=a.distcode,at=(1<<a.lenbits)-1,Q=(1<<a.distbits)-1;t:do{O<15&&(A+=p[d++]<<O,O+=8,A+=p[d++]<<O,O+=8),ot=V[A&at];e:for(;;){if(A>>>=k=ot>>>24,O-=k,(k=ot>>>16&255)===0)st[S++]=65535&ot;else{if(!(16&k)){if(!(64&k)){ot=V[(65535&ot)+(A&(1<<k)-1)];continue e}if(32&k){a.mode=12;break t}o.msg="invalid literal/length code",a.mode=30;break t}ct=65535&ot,(k&=15)&&(O<k&&(A+=p[d++]<<O,O+=8),ct+=A&(1<<k)-1,A>>>=k,O-=k),O<15&&(A+=p[d++]<<O,O+=8,A+=p[d++]<<O,O+=8),ot=M[A&Q];r:for(;;){if(A>>>=k=ot>>>24,O-=k,!(16&(k=ot>>>16&255))){if(!(64&k)){ot=M[(65535&ot)+(A&(1<<k)-1)];continue r}o.msg="invalid distance code",a.mode=30;break t}if(vt=65535&ot,O<(k&=15)&&(A+=p[d++]<<O,(O+=8)<k&&(A+=p[d++]<<O,O+=8)),_<(vt+=A&(1<<k)-1)){o.msg="invalid distance too far back",a.mode=30;break t}if(A>>>=k,O-=k,(k=S-I)<vt){if(g<(k=vt-k)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break t}if(tt=f,(U=0)===E){if(U+=v-k,k<ct){for(ct-=k;st[S++]=f[U++],--k;);U=S-vt,tt=st}}else if(E<k){if(U+=v+E-k,(k-=E)<ct){for(ct-=k;st[S++]=f[U++],--k;);if(U=0,E<ct){for(ct-=k=E;st[S++]=f[U++],--k;);U=S-vt,tt=st}}}else if(U+=E-k,k<ct){for(ct-=k;st[S++]=f[U++],--k;);U=S-vt,tt=st}for(;2<ct;)st[S++]=tt[U++],st[S++]=tt[U++],st[S++]=tt[U++],ct-=3;ct&&(st[S++]=tt[U++],1<ct&&(st[S++]=tt[U++]))}else{for(U=S-vt;st[S++]=st[U++],st[S++]=st[U++],st[S++]=st[U++],2<(ct-=3););ct&&(st[S++]=st[U++],1<ct&&(st[S++]=st[U++]))}break}}break}}while(d<N&&S<D);d-=ct=O>>3,A&=(1<<(O-=ct<<3))-1,o.next_in=d,o.next_out=S,o.avail_in=d<N?N-d+5:5-(d-N),o.avail_out=S<D?D-S+257:257-(S-D),a.hold=A,a.bits=O}},{}],49:[function(e,n,s){var o=e("../utils/common"),l=e("./adler32"),a=e("./crc32"),d=e("./inffast"),N=e("./inftrees"),S=1,I=2,D=0,_=-2,v=1,g=852,E=592;function f(U){return(U>>>24&255)+(U>>>8&65280)+((65280&U)<<8)+((255&U)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function O(U){var tt;return U&&U.state?(tt=U.state,U.total_in=U.total_out=tt.total=0,U.msg="",tt.wrap&&(U.adler=1&tt.wrap),tt.mode=v,tt.last=0,tt.havedict=0,tt.dmax=32768,tt.head=null,tt.hold=0,tt.bits=0,tt.lencode=tt.lendyn=new o.Buf32(g),tt.distcode=tt.distdyn=new o.Buf32(E),tt.sane=1,tt.back=-1,D):_}function V(U){var tt;return U&&U.state?((tt=U.state).wsize=0,tt.whave=0,tt.wnext=0,O(U)):_}function M(U,tt){var p,st;return U&&U.state?(st=U.state,tt<0?(p=0,tt=-tt):(p=1+(tt>>4),tt<48&&(tt&=15)),tt&&(tt<8||15<tt)?_:(st.window!==null&&st.wbits!==tt&&(st.window=null),st.wrap=p,st.wbits=tt,V(U))):_}function at(U,tt){var p,st;return U?(st=new A,(U.state=st).window=null,(p=M(U,tt))!==D&&(U.state=null),p):_}var Q,ot,k=!0;function ct(U){if(k){var tt;for(Q=new o.Buf32(512),ot=new o.Buf32(32),tt=0;tt<144;)U.lens[tt++]=8;for(;tt<256;)U.lens[tt++]=9;for(;tt<280;)U.lens[tt++]=7;for(;tt<288;)U.lens[tt++]=8;for(N(S,U.lens,0,288,Q,0,U.work,{bits:9}),tt=0;tt<32;)U.lens[tt++]=5;N(I,U.lens,0,32,ot,0,U.work,{bits:5}),k=!1}U.lencode=Q,U.lenbits=9,U.distcode=ot,U.distbits=5}function vt(U,tt,p,st){var xt,P=U.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new o.Buf8(P.wsize)),st>=P.wsize?(o.arraySet(P.window,tt,p-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(st<(xt=P.wsize-P.wnext)&&(xt=st),o.arraySet(P.window,tt,p-st,xt,P.wnext),(st-=xt)?(o.arraySet(P.window,tt,p-st,st,0),P.wnext=st,P.whave=P.wsize):(P.wnext+=xt,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=xt))),0}s.inflateReset=V,s.inflateReset2=M,s.inflateResetKeep=O,s.inflateInit=function(U){return at(U,15)},s.inflateInit2=at,s.inflate=function(U,tt){var p,st,xt,P,J,G,ut,L,W,wt,mt,ht,Ft,b,m,Y,j,bt,St,Nt,h,et,c,r,i=0,u=new o.Buf8(4),y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!U||!U.state||!U.output||!U.input&&U.avail_in!==0)return _;(p=U.state).mode===12&&(p.mode=13),J=U.next_out,xt=U.output,ut=U.avail_out,P=U.next_in,st=U.input,G=U.avail_in,L=p.hold,W=p.bits,wt=G,mt=ut,et=D;t:for(;;)switch(p.mode){case v:if(p.wrap===0){p.mode=13;break}for(;W<16;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(2&p.wrap&&L===35615){u[p.check=0]=255&L,u[1]=L>>>8&255,p.check=a(p.check,u,2,0),W=L=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&L)<<8)+(L>>8))%31){U.msg="incorrect header check",p.mode=30;break}if((15&L)!=8){U.msg="unknown compression method",p.mode=30;break}if(W-=4,h=8+(15&(L>>>=4)),p.wbits===0)p.wbits=h;else if(h>p.wbits){U.msg="invalid window size",p.mode=30;break}p.dmax=1<<h,U.adler=p.check=1,p.mode=512&L?10:12,W=L=0;break;case 2:for(;W<16;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(p.flags=L,(255&p.flags)!=8){U.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){U.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=L>>8&1),512&p.flags&&(u[0]=255&L,u[1]=L>>>8&255,p.check=a(p.check,u,2,0)),W=L=0,p.mode=3;case 3:for(;W<32;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.head&&(p.head.time=L),512&p.flags&&(u[0]=255&L,u[1]=L>>>8&255,u[2]=L>>>16&255,u[3]=L>>>24&255,p.check=a(p.check,u,4,0)),W=L=0,p.mode=4;case 4:for(;W<16;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.head&&(p.head.xflags=255&L,p.head.os=L>>8),512&p.flags&&(u[0]=255&L,u[1]=L>>>8&255,p.check=a(p.check,u,2,0)),W=L=0,p.mode=5;case 5:if(1024&p.flags){for(;W<16;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.length=L,p.head&&(p.head.extra_len=L),512&p.flags&&(u[0]=255&L,u[1]=L>>>8&255,p.check=a(p.check,u,2,0)),W=L=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(G<(ht=p.length)&&(ht=G),ht&&(p.head&&(h=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),o.arraySet(p.head.extra,st,P,ht,h)),512&p.flags&&(p.check=a(p.check,st,ht,P)),G-=ht,P+=ht,p.length-=ht),p.length))break t;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(G===0)break t;for(ht=0;h=st[P+ht++],p.head&&h&&p.length<65536&&(p.head.name+=String.fromCharCode(h)),h&&ht<G;);if(512&p.flags&&(p.check=a(p.check,st,ht,P)),G-=ht,P+=ht,h)break t}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(G===0)break t;for(ht=0;h=st[P+ht++],p.head&&h&&p.length<65536&&(p.head.comment+=String.fromCharCode(h)),h&&ht<G;);if(512&p.flags&&(p.check=a(p.check,st,ht,P)),G-=ht,P+=ht,h)break t}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;W<16;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(L!==(65535&p.check)){U.msg="header crc mismatch",p.mode=30;break}W=L=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),U.adler=p.check=0,p.mode=12;break;case 10:for(;W<32;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}U.adler=p.check=f(L),W=L=0,p.mode=11;case 11:if(p.havedict===0)return U.next_out=J,U.avail_out=ut,U.next_in=P,U.avail_in=G,p.hold=L,p.bits=W,2;U.adler=p.check=1,p.mode=12;case 12:if(tt===5||tt===6)break t;case 13:if(p.last){L>>>=7&W,W-=7&W,p.mode=27;break}for(;W<3;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}switch(p.last=1&L,W-=1,3&(L>>>=1)){case 0:p.mode=14;break;case 1:if(ct(p),p.mode=20,tt!==6)break;L>>>=2,W-=2;break t;case 2:p.mode=17;break;case 3:U.msg="invalid block type",p.mode=30}L>>>=2,W-=2;break;case 14:for(L>>>=7&W,W-=7&W;W<32;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if((65535&L)!=(L>>>16^65535)){U.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&L,W=L=0,p.mode=15,tt===6)break t;case 15:p.mode=16;case 16:if(ht=p.length){if(G<ht&&(ht=G),ut<ht&&(ht=ut),ht===0)break t;o.arraySet(xt,st,P,ht,J),G-=ht,P+=ht,ut-=ht,J+=ht,p.length-=ht;break}p.mode=12;break;case 17:for(;W<14;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(p.nlen=257+(31&L),L>>>=5,W-=5,p.ndist=1+(31&L),L>>>=5,W-=5,p.ncode=4+(15&L),L>>>=4,W-=4,286<p.nlen||30<p.ndist){U.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;W<3;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.lens[y[p.have++]]=7&L,L>>>=3,W-=3}for(;p.have<19;)p.lens[y[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,c={bits:p.lenbits},et=N(0,p.lens,0,19,p.lencode,0,p.work,c),p.lenbits=c.bits,et){U.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;Y=(i=p.lencode[L&(1<<p.lenbits)-1])>>>16&255,j=65535&i,!((m=i>>>24)<=W);){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(j<16)L>>>=m,W-=m,p.lens[p.have++]=j;else{if(j===16){for(r=m+2;W<r;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(L>>>=m,W-=m,p.have===0){U.msg="invalid bit length repeat",p.mode=30;break}h=p.lens[p.have-1],ht=3+(3&L),L>>>=2,W-=2}else if(j===17){for(r=m+3;W<r;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}W-=m,h=0,ht=3+(7&(L>>>=m)),L>>>=3,W-=3}else{for(r=m+7;W<r;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}W-=m,h=0,ht=11+(127&(L>>>=m)),L>>>=7,W-=7}if(p.have+ht>p.nlen+p.ndist){U.msg="invalid bit length repeat",p.mode=30;break}for(;ht--;)p.lens[p.have++]=h}}if(p.mode===30)break;if(p.lens[256]===0){U.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,c={bits:p.lenbits},et=N(S,p.lens,0,p.nlen,p.lencode,0,p.work,c),p.lenbits=c.bits,et){U.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,c={bits:p.distbits},et=N(I,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,c),p.distbits=c.bits,et){U.msg="invalid distances set",p.mode=30;break}if(p.mode=20,tt===6)break t;case 20:p.mode=21;case 21:if(6<=G&&258<=ut){U.next_out=J,U.avail_out=ut,U.next_in=P,U.avail_in=G,p.hold=L,p.bits=W,d(U,mt),J=U.next_out,xt=U.output,ut=U.avail_out,P=U.next_in,st=U.input,G=U.avail_in,L=p.hold,W=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;Y=(i=p.lencode[L&(1<<p.lenbits)-1])>>>16&255,j=65535&i,!((m=i>>>24)<=W);){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(Y&&!(240&Y)){for(bt=m,St=Y,Nt=j;Y=(i=p.lencode[Nt+((L&(1<<bt+St)-1)>>bt)])>>>16&255,j=65535&i,!(bt+(m=i>>>24)<=W);){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}L>>>=bt,W-=bt,p.back+=bt}if(L>>>=m,W-=m,p.back+=m,p.length=j,Y===0){p.mode=26;break}if(32&Y){p.back=-1,p.mode=12;break}if(64&Y){U.msg="invalid literal/length code",p.mode=30;break}p.extra=15&Y,p.mode=22;case 22:if(p.extra){for(r=p.extra;W<r;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.length+=L&(1<<p.extra)-1,L>>>=p.extra,W-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;Y=(i=p.distcode[L&(1<<p.distbits)-1])>>>16&255,j=65535&i,!((m=i>>>24)<=W);){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(!(240&Y)){for(bt=m,St=Y,Nt=j;Y=(i=p.distcode[Nt+((L&(1<<bt+St)-1)>>bt)])>>>16&255,j=65535&i,!(bt+(m=i>>>24)<=W);){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}L>>>=bt,W-=bt,p.back+=bt}if(L>>>=m,W-=m,p.back+=m,64&Y){U.msg="invalid distance code",p.mode=30;break}p.offset=j,p.extra=15&Y,p.mode=24;case 24:if(p.extra){for(r=p.extra;W<r;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}p.offset+=L&(1<<p.extra)-1,L>>>=p.extra,W-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){U.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(ut===0)break t;if(ht=mt-ut,p.offset>ht){if((ht=p.offset-ht)>p.whave&&p.sane){U.msg="invalid distance too far back",p.mode=30;break}Ft=ht>p.wnext?(ht-=p.wnext,p.wsize-ht):p.wnext-ht,ht>p.length&&(ht=p.length),b=p.window}else b=xt,Ft=J-p.offset,ht=p.length;for(ut<ht&&(ht=ut),ut-=ht,p.length-=ht;xt[J++]=b[Ft++],--ht;);p.length===0&&(p.mode=21);break;case 26:if(ut===0)break t;xt[J++]=p.length,ut--,p.mode=21;break;case 27:if(p.wrap){for(;W<32;){if(G===0)break t;G--,L|=st[P++]<<W,W+=8}if(mt-=ut,U.total_out+=mt,p.total+=mt,mt&&(U.adler=p.check=p.flags?a(p.check,xt,mt,J-mt):l(p.check,xt,mt,J-mt)),mt=ut,(p.flags?L:f(L))!==p.check){U.msg="incorrect data check",p.mode=30;break}W=L=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;W<32;){if(G===0)break t;G--,L+=st[P++]<<W,W+=8}if(L!==(4294967295&p.total)){U.msg="incorrect length check",p.mode=30;break}W=L=0}p.mode=29;case 29:et=1;break t;case 30:et=-3;break t;case 31:return-4;case 32:default:return _}return U.next_out=J,U.avail_out=ut,U.next_in=P,U.avail_in=G,p.hold=L,p.bits=W,(p.wsize||mt!==U.avail_out&&p.mode<30&&(p.mode<27||tt!==4))&&vt(U,U.output,U.next_out,mt-U.avail_out)?(p.mode=31,-4):(wt-=U.avail_in,mt-=U.avail_out,U.total_in+=wt,U.total_out+=mt,p.total+=mt,p.wrap&&mt&&(U.adler=p.check=p.flags?a(p.check,xt,mt,U.next_out-mt):l(p.check,xt,mt,U.next_out-mt)),U.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(wt==0&&mt===0||tt===4)&&et===D&&(et=-5),et)},s.inflateEnd=function(U){if(!U||!U.state)return _;var tt=U.state;return tt.window&&(tt.window=null),U.state=null,D},s.inflateGetHeader=function(U,tt){var p;return U&&U.state&&2&(p=U.state).wrap?((p.head=tt).done=!1,D):_},s.inflateSetDictionary=function(U,tt){var p,st=tt.length;return U&&U.state?(p=U.state).wrap!==0&&p.mode!==11?_:p.mode===11&&l(1,tt,st,0)!==p.check?-3:vt(U,tt,st,st)?(p.mode=31,-4):(p.havedict=1,D):_},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,s){var o=e("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(S,I,D,_,v,g,E,f){var A,O,V,M,at,Q,ot,k,ct,vt=f.bits,U=0,tt=0,p=0,st=0,xt=0,P=0,J=0,G=0,ut=0,L=0,W=null,wt=0,mt=new o.Buf16(16),ht=new o.Buf16(16),Ft=null,b=0;for(U=0;U<=15;U++)mt[U]=0;for(tt=0;tt<_;tt++)mt[I[D+tt]]++;for(xt=vt,st=15;1<=st&&mt[st]===0;st--);if(st<xt&&(xt=st),st===0)return v[g++]=20971520,v[g++]=20971520,f.bits=1,0;for(p=1;p<st&&mt[p]===0;p++);for(xt<p&&(xt=p),U=G=1;U<=15;U++)if(G<<=1,(G-=mt[U])<0)return-1;if(0<G&&(S===0||st!==1))return-1;for(ht[1]=0,U=1;U<15;U++)ht[U+1]=ht[U]+mt[U];for(tt=0;tt<_;tt++)I[D+tt]!==0&&(E[ht[I[D+tt]]++]=tt);if(Q=S===0?(W=Ft=E,19):S===1?(W=l,wt-=257,Ft=a,b-=257,256):(W=d,Ft=N,-1),U=p,at=g,J=tt=L=0,V=-1,M=(ut=1<<(P=xt))-1,S===1&&852<ut||S===2&&592<ut)return 1;for(;;){for(ot=U-J,ct=E[tt]<Q?(k=0,E[tt]):E[tt]>Q?(k=Ft[b+E[tt]],W[wt+E[tt]]):(k=96,0),A=1<<U-J,p=O=1<<P;v[at+(L>>J)+(O-=A)]=ot<<24|k<<16|ct|0,O!==0;);for(A=1<<U-1;L&A;)A>>=1;if(A!==0?(L&=A-1,L+=A):L=0,tt++,--mt[U]==0){if(U===st)break;U=I[D+E[tt]]}if(xt<U&&(L&M)!==V){for(J===0&&(J=xt),at+=p,G=1<<(P=U-J);P+J<st&&!((G-=mt[P+J])<=0);)P++,G<<=1;if(ut+=1<<P,S===1&&852<ut||S===2&&592<ut)return 1;v[V=L&M]=xt<<24|P<<16|at-g|0}}return L!==0&&(v[at+L]=U-J<<24|64<<16|0),f.bits=xt,0}},{"../utils/common":41}],51:[function(e,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,s){var o=e("../utils/common"),l=0,a=1;function d(i){for(var u=i.length;0<=--u;)i[u]=0}var N=0,S=29,I=256,D=I+1+S,_=30,v=19,g=2*D+1,E=15,f=16,A=7,O=256,V=16,M=17,at=18,Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ot=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ct=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vt=new Array(2*(D+2));d(vt);var U=new Array(2*_);d(U);var tt=new Array(512);d(tt);var p=new Array(256);d(p);var st=new Array(S);d(st);var xt,P,J,G=new Array(_);function ut(i,u,y,z,x){this.static_tree=i,this.extra_bits=u,this.extra_base=y,this.elems=z,this.max_length=x,this.has_stree=i&&i.length}function L(i,u){this.dyn_tree=i,this.max_code=0,this.stat_desc=u}function W(i){return i<256?tt[i]:tt[256+(i>>>7)]}function wt(i,u){i.pending_buf[i.pending++]=255&u,i.pending_buf[i.pending++]=u>>>8&255}function mt(i,u,y){i.bi_valid>f-y?(i.bi_buf|=u<<i.bi_valid&65535,wt(i,i.bi_buf),i.bi_buf=u>>f-i.bi_valid,i.bi_valid+=y-f):(i.bi_buf|=u<<i.bi_valid&65535,i.bi_valid+=y)}function ht(i,u,y){mt(i,y[2*u],y[2*u+1])}function Ft(i,u){for(var y=0;y|=1&i,i>>>=1,y<<=1,0<--u;);return y>>>1}function b(i,u,y){var z,x,Z=new Array(E+1),it=0;for(z=1;z<=E;z++)Z[z]=it=it+y[z-1]<<1;for(x=0;x<=u;x++){var rt=i[2*x+1];rt!==0&&(i[2*x]=Ft(Z[rt]++,rt))}}function m(i){var u;for(u=0;u<D;u++)i.dyn_ltree[2*u]=0;for(u=0;u<_;u++)i.dyn_dtree[2*u]=0;for(u=0;u<v;u++)i.bl_tree[2*u]=0;i.dyn_ltree[2*O]=1,i.opt_len=i.static_len=0,i.last_lit=i.matches=0}function Y(i){8<i.bi_valid?wt(i,i.bi_buf):0<i.bi_valid&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0}function j(i,u,y,z){var x=2*u,Z=2*y;return i[x]<i[Z]||i[x]===i[Z]&&z[u]<=z[y]}function bt(i,u,y){for(var z=i.heap[y],x=y<<1;x<=i.heap_len&&(x<i.heap_len&&j(u,i.heap[x+1],i.heap[x],i.depth)&&x++,!j(u,z,i.heap[x],i.depth));)i.heap[y]=i.heap[x],y=x,x<<=1;i.heap[y]=z}function St(i,u,y){var z,x,Z,it,rt=0;if(i.last_lit!==0)for(;z=i.pending_buf[i.d_buf+2*rt]<<8|i.pending_buf[i.d_buf+2*rt+1],x=i.pending_buf[i.l_buf+rt],rt++,z===0?ht(i,x,u):(ht(i,(Z=p[x])+I+1,u),(it=Q[Z])!==0&&mt(i,x-=st[Z],it),ht(i,Z=W(--z),y),(it=ot[Z])!==0&&mt(i,z-=G[Z],it)),rt<i.last_lit;);ht(i,O,u)}function Nt(i,u){var y,z,x,Z=u.dyn_tree,it=u.stat_desc.static_tree,rt=u.stat_desc.has_stree,ft=u.stat_desc.elems,Ct=-1;for(i.heap_len=0,i.heap_max=g,y=0;y<ft;y++)Z[2*y]!==0?(i.heap[++i.heap_len]=Ct=y,i.depth[y]=0):Z[2*y+1]=0;for(;i.heap_len<2;)Z[2*(x=i.heap[++i.heap_len]=Ct<2?++Ct:0)]=1,i.depth[x]=0,i.opt_len--,rt&&(i.static_len-=it[2*x+1]);for(u.max_code=Ct,y=i.heap_len>>1;1<=y;y--)bt(i,Z,y);for(x=ft;y=i.heap[1],i.heap[1]=i.heap[i.heap_len--],bt(i,Z,1),z=i.heap[1],i.heap[--i.heap_max]=y,i.heap[--i.heap_max]=z,Z[2*x]=Z[2*y]+Z[2*z],i.depth[x]=(i.depth[y]>=i.depth[z]?i.depth[y]:i.depth[z])+1,Z[2*y+1]=Z[2*z+1]=x,i.heap[1]=x++,bt(i,Z,1),2<=i.heap_len;);i.heap[--i.heap_max]=i.heap[1],function(kt,Lt){var Zt,qt,Kt,Pt,Jt,Fe,Yt=Lt.dyn_tree,Pe=Lt.max_code,tr=Lt.stat_desc.static_tree,ye=Lt.stat_desc.has_stree,Ae=Lt.stat_desc.extra_bits,Ue=Lt.stat_desc.extra_base,Ut=Lt.stat_desc.max_length,$t=0;for(Pt=0;Pt<=E;Pt++)kt.bl_count[Pt]=0;for(Yt[2*kt.heap[kt.heap_max]+1]=0,Zt=kt.heap_max+1;Zt<g;Zt++)Ut<(Pt=Yt[2*Yt[2*(qt=kt.heap[Zt])+1]+1]+1)&&(Pt=Ut,$t++),Yt[2*qt+1]=Pt,Pe<qt||(kt.bl_count[Pt]++,Jt=0,Ue<=qt&&(Jt=Ae[qt-Ue]),Fe=Yt[2*qt],kt.opt_len+=Fe*(Pt+Jt),ye&&(kt.static_len+=Fe*(tr[2*qt+1]+Jt)));if($t!==0){do{for(Pt=Ut-1;kt.bl_count[Pt]===0;)Pt--;kt.bl_count[Pt]--,kt.bl_count[Pt+1]+=2,kt.bl_count[Ut]--,$t-=2}while(0<$t);for(Pt=Ut;Pt!==0;Pt--)for(qt=kt.bl_count[Pt];qt!==0;)Pe<(Kt=kt.heap[--Zt])||(Yt[2*Kt+1]!==Pt&&(kt.opt_len+=(Pt-Yt[2*Kt+1])*Yt[2*Kt],Yt[2*Kt+1]=Pt),qt--)}}(i,u),b(Z,Ct,i.bl_count)}function h(i,u,y){var z,x,Z=-1,it=u[1],rt=0,ft=7,Ct=4;for(it===0&&(ft=138,Ct=3),u[2*(y+1)+1]=65535,z=0;z<=y;z++)x=it,it=u[2*(z+1)+1],++rt<ft&&x===it||(rt<Ct?i.bl_tree[2*x]+=rt:x!==0?(x!==Z&&i.bl_tree[2*x]++,i.bl_tree[2*V]++):rt<=10?i.bl_tree[2*M]++:i.bl_tree[2*at]++,Z=x,Ct=(rt=0)===it?(ft=138,3):x===it?(ft=6,3):(ft=7,4))}function et(i,u,y){var z,x,Z=-1,it=u[1],rt=0,ft=7,Ct=4;for(it===0&&(ft=138,Ct=3),z=0;z<=y;z++)if(x=it,it=u[2*(z+1)+1],!(++rt<ft&&x===it)){if(rt<Ct)for(;ht(i,x,i.bl_tree),--rt!=0;);else x!==0?(x!==Z&&(ht(i,x,i.bl_tree),rt--),ht(i,V,i.bl_tree),mt(i,rt-3,2)):rt<=10?(ht(i,M,i.bl_tree),mt(i,rt-3,3)):(ht(i,at,i.bl_tree),mt(i,rt-11,7));Z=x,Ct=(rt=0)===it?(ft=138,3):x===it?(ft=6,3):(ft=7,4)}}d(G);var c=!1;function r(i,u,y,z){mt(i,(N<<1)+(z?1:0),3),function(x,Z,it,rt){Y(x),wt(x,it),wt(x,~it),o.arraySet(x.pending_buf,x.window,Z,it,x.pending),x.pending+=it}(i,u,y)}s._tr_init=function(i){c||(function(){var u,y,z,x,Z,it=new Array(E+1);for(x=z=0;x<S-1;x++)for(st[x]=z,u=0;u<1<<Q[x];u++)p[z++]=x;for(p[z-1]=x,x=Z=0;x<16;x++)for(G[x]=Z,u=0;u<1<<ot[x];u++)tt[Z++]=x;for(Z>>=7;x<_;x++)for(G[x]=Z<<7,u=0;u<1<<ot[x]-7;u++)tt[256+Z++]=x;for(y=0;y<=E;y++)it[y]=0;for(u=0;u<=143;)vt[2*u+1]=8,u++,it[8]++;for(;u<=255;)vt[2*u+1]=9,u++,it[9]++;for(;u<=279;)vt[2*u+1]=7,u++,it[7]++;for(;u<=287;)vt[2*u+1]=8,u++,it[8]++;for(b(vt,D+1,it),u=0;u<_;u++)U[2*u+1]=5,U[2*u]=Ft(u,5);xt=new ut(vt,Q,I+1,D,E),P=new ut(U,ot,0,_,E),J=new ut(new Array(0),k,0,v,A)}(),c=!0),i.l_desc=new L(i.dyn_ltree,xt),i.d_desc=new L(i.dyn_dtree,P),i.bl_desc=new L(i.bl_tree,J),i.bi_buf=0,i.bi_valid=0,m(i)},s._tr_stored_block=r,s._tr_flush_block=function(i,u,y,z){var x,Z,it=0;0<i.level?(i.strm.data_type===2&&(i.strm.data_type=function(rt){var ft,Ct=4093624447;for(ft=0;ft<=31;ft++,Ct>>>=1)if(1&Ct&&rt.dyn_ltree[2*ft]!==0)return l;if(rt.dyn_ltree[18]!==0||rt.dyn_ltree[20]!==0||rt.dyn_ltree[26]!==0)return a;for(ft=32;ft<I;ft++)if(rt.dyn_ltree[2*ft]!==0)return a;return l}(i)),Nt(i,i.l_desc),Nt(i,i.d_desc),it=function(rt){var ft;for(h(rt,rt.dyn_ltree,rt.l_desc.max_code),h(rt,rt.dyn_dtree,rt.d_desc.max_code),Nt(rt,rt.bl_desc),ft=v-1;3<=ft&&rt.bl_tree[2*ct[ft]+1]===0;ft--);return rt.opt_len+=3*(ft+1)+5+5+4,ft}(i),x=i.opt_len+3+7>>>3,(Z=i.static_len+3+7>>>3)<=x&&(x=Z)):x=Z=y+5,y+4<=x&&u!==-1?r(i,u,y,z):i.strategy===4||Z===x?(mt(i,2+(z?1:0),3),St(i,vt,U)):(mt(i,4+(z?1:0),3),function(rt,ft,Ct,kt){var Lt;for(mt(rt,ft-257,5),mt(rt,Ct-1,5),mt(rt,kt-4,4),Lt=0;Lt<kt;Lt++)mt(rt,rt.bl_tree[2*ct[Lt]+1],3);et(rt,rt.dyn_ltree,ft-1),et(rt,rt.dyn_dtree,Ct-1)}(i,i.l_desc.max_code+1,i.d_desc.max_code+1,it+1),St(i,i.dyn_ltree,i.dyn_dtree)),m(i),z&&Y(i)},s._tr_tally=function(i,u,y){return i.pending_buf[i.d_buf+2*i.last_lit]=u>>>8&255,i.pending_buf[i.d_buf+2*i.last_lit+1]=255&u,i.pending_buf[i.l_buf+i.last_lit]=255&y,i.last_lit++,u===0?i.dyn_ltree[2*y]++:(i.matches++,u--,i.dyn_ltree[2*(p[y]+I+1)]++,i.dyn_dtree[2*W(u)]++),i.last_lit===i.lit_bufsize-1},s._tr_align=function(i){mt(i,2,3),ht(i,O,vt),function(u){u.bi_valid===16?(wt(u,u.bi_buf),u.bi_buf=0,u.bi_valid=0):8<=u.bi_valid&&(u.pending_buf[u.pending++]=255&u.bi_buf,u.bi_buf>>=8,u.bi_valid-=8)}(i)}},{"../utils/common":41}],53:[function(e,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,s){(function(o){(function(l,a){if(!l.setImmediate){var d,N,S,I,D=1,_={},v=!1,g=l.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(l);E=E&&E.setTimeout?E:l,d={}.toString.call(l.process)==="[object process]"?function(V){fe.nextTick(function(){A(V)})}:function(){if(l.postMessage&&!l.importScripts){var V=!0,M=l.onmessage;return l.onmessage=function(){V=!1},l.postMessage("","*"),l.onmessage=M,V}}()?(I="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",O,!1):l.attachEvent("onmessage",O),function(V){l.postMessage(I+V,"*")}):l.MessageChannel?((S=new MessageChannel).port1.onmessage=function(V){A(V.data)},function(V){S.port2.postMessage(V)}):g&&"onreadystatechange"in g.createElement("script")?(N=g.documentElement,function(V){var M=g.createElement("script");M.onreadystatechange=function(){A(V),M.onreadystatechange=null,N.removeChild(M),M=null},N.appendChild(M)}):function(V){setTimeout(A,0,V)},E.setImmediate=function(V){typeof V!="function"&&(V=new Function(""+V));for(var M=new Array(arguments.length-1),at=0;at<M.length;at++)M[at]=arguments[at+1];var Q={callback:V,args:M};return _[D]=Q,d(D),D++},E.clearImmediate=f}function f(V){delete _[V]}function A(V){if(v)setTimeout(A,0,V);else{var M=_[V];if(M){v=!0;try{(function(at){var Q=at.callback,ot=at.args;switch(ot.length){case 0:Q();break;case 1:Q(ot[0]);break;case 2:Q(ot[0],ot[1]);break;case 3:Q(ot[0],ot[1],ot[2]);break;default:Q.apply(a,ot)}})(M)}finally{f(V),v=!1}}}}function O(V){V.source===l&&typeof V.data=="string"&&V.data.indexOf(I)===0&&A(+V.data.slice(I.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof ce<"u"?ce:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(gi);var wi=gi.exports;const Mr=wi;var Ke={get Promise(){return Mr.external.Promise},set Promise(H){Mr.external.Promise=H}};const En={},Fn=Object.freeze(Object.defineProperty({__proto__:null,default:En},Symbol.toStringTag,{value:"Module"})),Ye=Yi(Fn),kn=Wt;var Qe=H=>(typeof H=="string"&&(H=new RegExp(kn.escapeRegExp(H),"igm")),H.lastIndex=0,H),Sn=()=>_t.from("UEsDBBQAAAAIAAAAIQC1VTAj7AAAAEwCAAALAAAAX3JlbHMvLnJlbHONks1OwzAMgO9IvEPk++puSAihpbsgpN0QKg9gEvdHbeMoCdC9PeGAoNIYPcaxP3+2vD/M06jeOcRenIZtUYJiZ8T2rtXwUj9u7kDFRM7SKI41nDjCobq+2j/zSCkXxa73UWWKixq6lPw9YjQdTxQL8ezyTyNhopSfoUVPZqCWcVeWtxh+M6BaMNXRaghHewOqPnlew5am6Q0/iHmb2KUzLZDnxM6y3fiQ60Pq8zSqptBy0mDFPOVwRPK+yGjA80a79UZ/T4sTJ7KUCI0EvuzzlXFJaLte6P8VLTN+bOYRPyQMryLDtwsubqD6BFBLAwQUAAAACAAAACEA3kEW2XsBAAARAwAAEAAAAGRvY1Byb3BzL2FwcC54bWydkkFP4zAQhe9I/IfId+oElhWqHCNUQBwWbaUWOBtn0lg4tuUZopZfj5OqIV32xO3NzNPLlxmL621rsw4iGu9KVsxyloHTvjJuU7Kn9f3ZFcuQlKuU9Q5KtgNk1/L0RCyjDxDJAGYpwmHJGqIw5xx1A63CWRq7NKl9bBWlMm64r2uj4dbr9xYc8fM8/81hS+AqqM7CGMj2ifOOfhpaed3z4fN6F1KeFDchWKMVpb+Uj0ZHj76m7G6rwQo+HYoUtAL9Hg3tZC74tBQrrSwsUrCslUUQ/KshHkD1S1sqE1GKjuYdaPIxQ/OR1nbOsleF0OOUrFPRKEdsb9sXg7YBKcoXH9+wASAUfGwOcuqdavNLFoMhiWMjH0GSPkZcG7KAf+ulivQf4mJKPDCwCeOq5yu+8R2+9E/2wrdBubRAPqo/xr3hU1j7W0VwWOdxU6waFaFKFxjXPTbEQ+KKtvcvGuU2UB083wf98Z/3L1wWl7P8Is+Hmx96gn+9ZfkJUEsDBBQAAAAIAOehdkc+qGWw1QAAAG0BAAARAAAAZG9jUHJvcHMvY29yZS54bWxtkE1Lw0AQhu9C/0PYezKJBZGQpDdPCkIVvA67Y7qY/WBnNO2/7zZoFOxxeJ95mHm73dFNxRcltsH3qqlqVZDXwVg/9ur15aG8VwULeoNT8NSrE7HaDZubTsdWh0TPKURKYomLbPLc6tirg0hsAVgfyCFXmfA5fA/JoeQxjRBRf+BIcFvXd+BI0KAgXIRlXI3qW2n0qoyfaVoERgNN5MgLQ1M18MsKJcdXF5bkD+msnCJdRX/ClT6yXcF5nqt5u6D5/gbenh73y6ul9ZeuNKmhg38FDWdQSwMEFAAAAAAA2aF2RwAAAAAAAAAAAAAAAAkAAAB4bC9fcmVscy9QSwMEFAAAAAgAAAAhAI2H2nDaAAAALQIAABoAAAB4bC9fcmVscy93b3JrYm9vay54bWwucmVsc62R3YrCMBCF7xf2HcLcb9NWWGQx9UYWeiv1AUI6/cE2CZlZtW9vXMEfEPHCq+FMmO+cySyWh3EQOwzUO6sgS1IQaI2re9sq2FS/X3MQxNrWenAWFUxIsCw+PxZrHDTHIep6TyJSLCnomP2PlGQ6HDUlzqONL40Lo+YoQyu9NlvdoszT9FuGWwYUd0xR1gpCWc9AVJPHV9iuaXqDK2f+RrT8wEIST0NcQFQ6tMgKzjqJHJCP7fN32nOcxav7vzw3s2cZsndm2LuwpQ6RrzkurfhBp3IJI++OXBwBUEsDBBQAAAAIAAAAIQDeI/LTbgIAALEFAAANAAAAeGwvc3R5bGVzLnhtbKWUXWvbMBSG7wf7D0L3rmw3zpJguyxNDYVuDJrBbhVbTkT1YSSlSzb233tkO7FDxzbWK53z6ug5rz7s9OYgBXpmxnKtMhxdhRgxVeqKq22Gv66LYIaRdVRVVGjFMnxkFt/k79+l1h0Fe9wx5hAglM3wzrlmQYgtd0xSe6UbpmCm1kZSB6nZEtsYRivrF0lB4jCcEkm5wh1hIct/gUhqnvZNUGrZUMc3XHB3bFkYyXJxv1Xa0I0Aq4doQssTu01e4SUvjba6dleAI7quecleu5yTOQFSntZaOYtKvVcOzgrQHrp4Uvq7KvyUF7uqPLU/0DMVoESY5GmphTbIQVfmi0BRVLKu4pYKvjHcizWVXBw7OfZCa7Svkxy25kXSdWgHC4u4EGdXMe6EPIXTccyoAhLUx+tjA+0VXGSHaev+Ur019BjFyWhBO0DfjTYVPJzhPE5SngpWO1hg+HbnR6cb4iedg1PO04rTrVZUeORpRR8AtmRCPPrH9a2+YB9qpPaykO6+yjA8U7/7UwiG+rDDdInnj2kd+81YdKgv+Wd02+iCflaRv+8Mf/YPWQwItNlz4bj6jWFgVofBazvr/Mu+7AKMitV0L9z6PJnhIf7EKr6X8bnqC3/Wrq8a4gd/U9HU92AH92BdO6K94Rn+ebf8MF/dFXEwC5ezYHLNkmCeLFdBMrldrlbFPIzD21+jD+0Nn1n7O4BLiSYLK6DK9JvtzT8OWoZHSWe/PT+wPfY+j6fhxyQKg+I6jILJlM6C2fQ6CYokilfTyfIuKZKR9+T/vEchiaLBfLJwXDLBFbu0vx6rcEmQ/mET5HQTZPjX5i9QSwMEFAAAAAAA2aF2RwAAAAAAAAAAAAAAAAkAAAB4bC90aGVtZS9QSwMEFAAAAAgAAAAhAIuCblj1BQAAjhoAABMAAAB4bC90aGVtZS90aGVtZTEueG1s7VlPjxs1FL8j8R2suafzfyZZNVslk6SF7rZVd1vUozNxMm4842js7G5UVULtEQkJURAXJG4cEFCplbiUT7NQBEXqV8DjyR9P4tCFbqWCmkjJ+Pn3nn9+7/nZM3Px0klKwBHKGaZZ07AvWAZAWUwHOBs1jVuHvVrdAIzDbAAJzVDTmCFmXNp9/72LcIcnKEVA6GdsBzaNhPPJjmmyWIghu0AnKBN9Q5qnkItmPjIHOTwWdlNiOpYVmCnEmQEymAqz14dDHCNwWJg0dhfGu0T8ZJwVgpjkB7EcUdWQ2MHYLv7YjEUkB0eQNA0xzoAeH6ITbgACGRcdTcOSH8PcvWgulQjfoqvo9eRnrjdXGIwdqZeP+ktFz/O9oLW075T2N3HdsBt0g6U9CYBxLGZqb2D9dqPd8edYBVReamx3wo5rV/CKfXcD3/KLbwXvrvDeBr7Xi1Y+VEDlpa/xSehEXgXvr/DBBj60Wh0vrOAlKCE4G2+gLT9wo8Vsl5AhJVe08Ibv9UJnDl+hTCW7Sv2Mb8u1FN6leU8AZHAhxxngswkawljgIkhwP8dgD48SkXgTmFEmxJZj9SxX/BZfT15Jj8AdBBXtUhSzDVHBB7A4xxPeND4UVg0F8vLZ9y+fPQEvnz0+ffD09MFPpw8fnj74UaN4BWYjVfHFt5/9+fXH4I8n37x49IUez1T8rz988svPn+uBXAU+//Lxb08fP//q09+/e6SBt3LYV+GHOEUMXEPH4CZNxdw0A6B+/s80DhOIKxowEUgNsMuTCvDaDBIdro2qzrudiyKhA16e3q1wPUjyKcca4NUkrQD3KSVtmmunc7UYS53ONBvpB8+nKu4mhEe6saO10HanE5HtWGcySlCF5g0iog1HKEMcFH10jJBG7Q7GFb/u4zinjA45uINBG2KtSw5xn+uVruBUxGWmIyhCXfHN/m3QpkRnvoOOqkixICDRmUSk4sbLcMphqmUMU6Ii9yBPdCQPZnlccTjjItIjRCjoDhBjOp3r+axC96ooLvqw75NZWkXmHI91yD1IqYrs0HGUwHSi5YyzRMV+wMYiRSG4QbmWBK2ukKIt4gCzreG+jVEl3K9e1rdEXdUnSNEzzXVLAtHqepyRIUTSuLlWzVOcvbK0rxV1/11R1xf1Vo61S2u9lG/D/QcLeAdOsxtIrBkN9F39fle///f1e9taPv+qvSrUZqmonN3TrUf3ISbkgM8I2mOyxDMxvUFPCGVDKi3vFCaJuJwPV8GNciivQU75R5gnBwmciGFsOcKIzU2PGJhQJjYJY6vtooNM0306KKW2vbg5FQqQr+Rik1nIxZbES2kQru7CluZla8RUAr40enYSymBVEq6GROiejYRtnReLhoZF3f47FqYSFbH+ACyea/heyUjkGyRoUMSp1F9E99wjvc2Z1Wk7muk1vLM5+QyRrpBQ0q1KQknDBA7QuvicY91YhbRCz9HSCOtvItbmZm0gWbUFjsWac31hJoaTpjEUx0NxmU6EPVbUTUhGWdOI+dzR/6ayTHLGO5AlJUx2lfNPMUc5IDgVua6GgWQrbrYTWm8vuYb19nnOXA8yGg5RzLdIVk3RVxrR9r4muGjQqSB9kAyOQZ9M85tQOMoP7cKBA8z40psDnCvJvfLiWrmaL8XKQ7PVEoVkksD5jqIW8xIur5d0lHlIpuuzqrbnk+mPeuex675aqehQiuaWDSTcWsXe3CavsHL1rHxtrWvUl1L9LvH6G4JCra6n5uqpWVuoneOBQBku2OK35R5x3rvBetaayrlStjbeTtD+XZH5HXFcnRLOJFV0Iu4RosVz5bISSOmiupxwMM1x07hn+S0vcvyoZtX9bs1zPatW91tureX7rt31bavTdu4Lp/Aktf1y7J64nyGz+csXKd94AZMujtkXYpqaVJ6DTaksX8DYzvYXMAALz9wLnF7DbbSDWsNt9Wpep12vNaKgXesEUdjpdSK/3ujdN8CRBHstN/KCbr0W2FFU8wKroF9v1ELPcVpe2Kp3vdb9ua/FzBf/C/dKXrt/AVBLAwQUAAAACAAAACEAfDzuwy4CAACbBAAADwAAAHhsL3dvcmtib29rLnhtbK2UTY+bMBCG75X6H5DvhI9AN0Ehq81H1UjVarXN7l5yccwQ3Bib2qZJVPW/d4CSps1lK+0Fj8344Z13bCa3x1I430EbrmRKgoFPHJBMZVzuUvK0/uiOiGMslRkVSkJKTmDI7fT9u8lB6f1Wqb2DAGlSUlhbJZ5nWAElNQNVgcQ3udIltTjVO89UGmhmCgBbCi/0/Q9eSbkkHSHRr2GoPOcMForVJUjbQTQIalG+KXhlelrJXoMrqd7XlctUWSFiywW3pxZKnJIlq51Umm4Fln0M4p6M4RW65Ewro3I7QNRvkVf1Br4XBF3J00nOBTx3tju0qu5p2XxFEEdQY5cZt5ClBGUIdYC/FnRdzWoucBJEUegTb3puxYN2MshpLewaZfV4TIyHYRg2mVjUnbCgJbUwV9Kih2/kV8ueFwoLdx7hW801mM626QSflCV0ax6oLZxai5TMk82TQX2b7KsqpFFyM1cZbI7CHN1KVTV2FDaCbzcXrtNrif/hO2WNAd5ZZRf/68Z00hj5zOFg/vjaTJ3jC5eZOqRkPMQ7cupnGB/a8IVntkhJOPRvzmufgO8Kiw3wh12nvAt6K7AfHdkegC9NHOCNa8ZV02NseMIx0KssaAn9NkYFw4Y3Q5sYh3HQZsDRfja2HdFrnpIfQeTf3fjjyPWXw9iNRuPQHUXD0J1Hi3AZ3ywXy1n8822PN1KSi2PJCqrtWlO2x//KI+QzaqAprikIdXbPVrXX75r+AlBLAwQUAAAAAADZoXZHAAAAAAAAAAAAAAAADgAAAHhsL3dvcmtzaGVldHMvUEsDBBQAAAAIAAAAIQDmVajjXQEAAIQCAAAYAAAAeGwvd29ya3NoZWV0cy9zaGVldDEueG1sjZJPawIxEMXvhX6HkLtGbW2ruEpBpB4Kpf/u2ezsbjDJLMlY9dt3dq1S8OJtXibz471JZou9d+IHYrIYMjnsD6SAYLCwocrk1+eq9yRFIh0K7TBAJg+Q5GJ+ezPbYdykGoAEE0LKZE3UTJVKpgavUx8bCNwpMXpNLGOlUhNBF92Qd2o0GDwor22QR8I0XsPAsrQGlmi2HgIdIRGcJvafatukE82ba3Bex8226Rn0DSNy6ywdOqgU3kzXVcCoc8e598N7bU7sTlzgvTURE5bUZ9yf0cvMEzVRTJrPCssJ2rWLCGUmn4dSzWfdxW8Lu/SvFqTzD3BgCAp+Iyna3eeIm7a55qNBO6ouZldd0LcoCij11tE77l7AVjUxZMxZ2hTT4rCEZHiXjOmPxmcTS02a60ZX8KpjZUMSDsru1qMU8YjpasKmqxiZIxH6k6o5OcRW3UlRItJJtG7P/2f+C1BLAwQUAAAACAAAACEApFPFz0EBAAAIBAAAEwAAAFtDb250ZW50X1R5cGVzXS54bWytk89OAjEQxu8mvkPTK9kWPBhjWDj456gc8AFqO8s2dNumUxDe3tmCHgiKBC/b7M583+/bdjqebjrH1pDQBl/zkRhyBl4HY/2i5m/z5+qOM8zKG+WCh5pvAfl0cn01nm8jICO1x5q3Ocd7KVG30CkUIYKnShNSpzK9poWMSi/VAuTNcHgrdfAZfK5y78En40do1Mpl9rShz7skCRxy9rBr7Fk1VzE6q1Wmulx7c0Cp9gRBytKDrY04oAYujxL6ys+Ave6VtiZZA2ymUn5RHXXJjZMfIS3fQ1iK302OpAxNYzWYoFcdSQTGBMpgC5A7J8oqOmX94DS/NKMsy+ifg3z7n8iR6bxh97w8QrE5AcS8dYAXow62vZj+RibhLIWINLkJzqd/jWavriIZQcr2j0SyPh948LvQT70Bc4Qtyz2efAJQSwECFAAUAAAACAAAACEAtVUwI+wAAABMAgAACwAAAAAAAAABAAAAAAAAAAAAX3JlbHMvLnJlbHNQSwECFAAUAAAACAAAACEA3kEW2XsBAAARAwAAEAAAAAAAAAABAAAAAAAVAQAAZG9jUHJvcHMvYXBwLnhtbFBLAQIUABQAAAAIAOehdkc+qGWw1QAAAG0BAAARAAAAAAAAAAEAIAAAAL4CAABkb2NQcm9wcy9jb3JlLnhtbFBLAQIUABQAAAAAANmhdkcAAAAAAAAAAAAAAAAJAAAAAAAAAAAAEAAAAMIDAAB4bC9fcmVscy9QSwECFAAUAAAACAAAACEAjYfacNoAAAAtAgAAGgAAAAAAAAABAAAAAADpAwAAeGwvX3JlbHMvd29ya2Jvb2sueG1sLnJlbHNQSwECFAAUAAAACAAAACEA3iPy024CAACxBQAADQAAAAAAAAABAAAAAAD7BAAAeGwvc3R5bGVzLnhtbFBLAQIUABQAAAAAANmhdkcAAAAAAAAAAAAAAAAJAAAAAAAAAAAAEAAAAJQHAAB4bC90aGVtZS9QSwECFAAUAAAACAAAACEAi4JuWPUFAACOGgAAEwAAAAAAAAABAAAAAAC7BwAAeGwvdGhlbWUvdGhlbWUxLnhtbFBLAQIUABQAAAAIAAAAIQB8PO7DLgIAAJsEAAAPAAAAAAAAAAEAAAAAAOENAAB4bC93b3JrYm9vay54bWxQSwECFAAUAAAAAADZoXZHAAAAAAAAAAAAAAAADgAAAAAAAAAAABAAAAA8EAAAeGwvd29ya3NoZWV0cy9QSwECFAAUAAAACAAAACEA5lWo410BAACEAgAAGAAAAAAAAAABAAAAAABoEAAAeGwvd29ya3NoZWV0cy9zaGVldDEueG1sUEsBAhQAFAAAAAgAAAAhAKRTxc9BAQAACAQAABMAAAAAAAAAAQAAAAAA+xEAAFtDb250ZW50X1R5cGVzXS54bWxQSwUGAAAAAAwADADoAgAAbRMAAAAA","base64");const se=Wt;var me={appendChild(H,t){H.children||(H.children=[]),H.children.push(t)},appendChildIfNotFound(H,t){let e=this.findChild(H,t);return e||(e={name:t,attributes:{},children:[]},this.appendChild(H,e)),e},findChild(H,t){return se.find(H.children,{name:t})},getChildAttribute(H,t,e){const n=this.findChild(H,t);if(n)return n.attributes&&n.attributes[e]},hasChild(H,t){return se.some(H.children,{name:t})},insertAfter(H,t,e){H.children||(H.children=[]);const n=H.children.indexOf(e);H.children.splice(n+1,0,t)},insertBefore(H,t,e){H.children||(H.children=[]);const n=H.children.indexOf(e);H.children.splice(n,0,t)},insertInOrder(H,t,e){const n=e.indexOf(t.name);if(H.children&&n>=0)for(let s=n+1;s<e.length;s++){const o=this.findChild(H,e[s]);if(o){this.insertBefore(H,t,o);return}}this.appendChild(H,t)},isEmpty(H){return se.isEmpty(H.children)&&se.isEmpty(H.attributes)},removeChild(H,t){if(H.children)if(typeof t=="string")se.remove(H.children,{name:t});else{const e=H.children.indexOf(t);e>=0&&H.children.splice(e,1)}},setAttributes(H,t){se.forOwn(t,(e,n)=>{se.isNil(e)?H.attributes&&delete H.attributes[n]:(H.attributes||(H.attributes={}),H.attributes[n]=e)})},setChildAttributes(H,t,e){let n=this.findChild(H,t);return se.forOwn(e,(s,o)=>{se.isNil(s)?n&&n.attributes&&delete n.attributes[o]:(n||(n={name:t,attributes:{},children:[]},this.appendChild(H,n)),n.attributes||(n.attributes={}),n.attributes[o]=s)}),n},removeChildIfEmpty(H,t){typeof t=="string"&&(t=this.findChild(H,t)),t&&this.isEmpty(t)&&this.removeChild(H,t)}};const ur=Wt;let In=class{constructor(t){this._name=t,this._cases=[]}case(t,e){return arguments.length===1&&(e=t,t=[]),Array.isArray(t)||(t=[t]),this._cases.push({types:t,handler:e}),this}handle(t){for(let e=0;e<this._cases.length;e++){const n=this._cases[e];if(this._argsMatchTypes(t,n.types))return n.handler.apply(null,t)}throw new Error(`${this._name}: Invalid arguments.`)}_argsMatchTypes(t,e){return t.length!==e.length?!1:ur.every(t,(n,s)=>{const o=e[s];if(o==="*")return!0;if(o==="nil")return ur.isNil(n);if(o==="string")return typeof n=="string";if(o==="boolean")return typeof n=="boolean";if(o==="number")return typeof n=="number";if(o==="integer")return typeof n=="number"&&ur.isInteger(n);if(o==="function")return typeof n=="function";if(o==="array")return Array.isArray(n);if(o==="date")return n&&n.constructor===Date;if(o==="object")return n&&n.constructor===Object;if(n&&n.constructor&&n.constructor.name===o)return!0;throw new Error(`Unknown type: ${o}`)})}};var de=In;const Tn=/^(?:'?(.+?)'?!)?(?:(\$)?([A-Z]+)(\$)?(\d+)(?::(\$)?([A-Z]+)(\$)?(\d+))?|(\$)?([A-Z]+):(\$)?([A-Z]+)|(\$)?(\d+):(\$)?(\d+))$/;var Ee={columnNameToNumber(H){if(!H||typeof H!="string")return;H=H.toUpperCase();let t=0;for(let e=0;e<H.length;e++)t=t*26,t=t+(H[e].charCodeAt(0)-65+1);return t},columnNumberToName(H){let t=H,e="",n=0;for(;t>0;)n=(t-1)%26,e=String.fromCharCode(65+n)+e,t=Math.floor((t-n)/26);return e},fromAddress(H){const t=H.match(Tn);if(!t)return;const e={};return t[1]&&(e.sheetName=t[1].replace(/''/g,"'")),t[3]&&t[7]?(e.type="range",e.startColumnAnchored=!!t[2],e.startColumnName=t[3],e.startColumnNumber=this.columnNameToNumber(e.startColumnName),e.startRowAnchored=!!t[4],e.startRowNumber=parseInt(t[5]),e.endColumnAnchored=!!t[6],e.endColumnName=t[7],e.endColumnNumber=this.columnNameToNumber(e.endColumnName),e.endRowAnchored=!!t[8],e.endRowNumber=parseInt(t[9])):t[3]?(e.type="cell",e.columnAnchored=!!t[2],e.columnName=t[3],e.columnNumber=this.columnNameToNumber(e.columnName),e.rowAnchored=!!t[4],e.rowNumber=parseInt(t[5])):t[11]&&t[11]!==t[13]?(e.type="columnRange",e.startColumnAnchored=!!t[10],e.startColumnName=t[11],e.startColumnNumber=this.columnNameToNumber(e.startColumnName),e.endColumnAnchored=!!t[12],e.endColumnName=t[13],e.endColumnNumber=this.columnNameToNumber(e.endColumnName)):t[11]?(e.type="column",e.columnAnchored=!!t[10],e.columnName=t[11],e.columnNumber=this.columnNameToNumber(e.columnName)):t[15]&&t[15]!==t[17]?(e.type="rowRange",e.startRowAnchored=!!t[14],e.startRowNumber=parseInt(t[15]),e.endRowAnchored=!!t[16],e.endRowNumber=parseInt(t[17])):t[15]&&(e.type="row",e.rowAnchored=!!t[14],e.rowNumber=parseInt(t[15])),e},toAddress(H){let t,e;const n=H.sheetName;H.type==="cell"?t={columnName:H.columnName,columnNumber:H.columnNumber,columnAnchored:H.columnAnchored,rowNumber:H.rowNumber,rowAnchored:H.rowAnchored}:H.type==="range"?(t={columnName:H.startColumnName,columnNumber:H.startColumnNumber,columnAnchored:H.startColumnAnchored,rowNumber:H.startRowNumber,rowAnchored:H.startRowAnchored},e={columnName:H.endColumnName,columnNumber:H.endColumnNumber,columnAnchored:H.endColumnAnchored,rowNumber:H.endRowNumber,rowAnchored:H.endRowAnchored}):H.type==="column"?t=e={columnName:H.columnName,columnNumber:H.columnNumber,columnAnchored:H.columnAnchored}:H.type==="row"?t=e={rowNumber:H.rowNumber,rowAnchored:H.rowAnchored}:H.type==="columnRange"?(t={columnName:H.startColumnName,columnNumber:H.startColumnNumber,columnAnchored:H.startColumnAnchored},e={columnName:H.endColumnName,columnNumber:H.endColumnNumber,columnAnchored:H.endColumnAnchored}):H.type==="rowRange"&&(t={rowNumber:H.startRowNumber,rowAnchored:H.startRowAnchored},e={rowNumber:H.endRowNumber,rowAnchored:H.endRowAnchored});let s="";return n&&(s=`${s}'${n.replace(/'/g,"''")}'!`),t.columnAnchored&&(s=`${s}$`),t.columnName?s=s+t.columnName:t.columnNumber&&(s=s+this.columnNumberToName(t.columnNumber)),t.rowAnchored&&(s=`${s}$`),t.rowNumber&&(s=s+t.rowNumber),e&&(s=`${s}:`,e.columnAnchored&&(s=`${s}$`),e.columnName?s=s+e.columnName:e.columnNumber&&(s=s+this.columnNumberToName(e.columnNumber)),e.rowAnchored&&(s=`${s}$`),e.rowNumber&&(s=s+e.rowNumber)),s}};const Vr=new Date(1900,0,0),jr=new Date(1900,1,28),cr=1e3*60*60*24;var yi={dateToNumber(H){const t=new Date(H.getTime());t.setHours(0,0,0,0);let e=Math.round((t-Vr)/cr);return e+=(H-t)/cr,H>jr&&(e+=1),e},numberToDate(H){H>this.dateToNumber(jr)&&H--;const t=Math.floor(H),e=Math.round((H-t)*cr),n=new Date(Vr.getTime()+e);return n.setDate(n.getDate()+t),n}};const Bn=Wt;let Mt=class{constructor(t){this._error=t}error(){return this._error}};Mt.DIV0=new Mt("#DIV/0!");Mt.NA=new Mt("#N/A");Mt.NAME=new Mt("#NAME?");Mt.NULL=new Mt("#NULL!");Mt.NUM=new Mt("#NUM!");Mt.REF=new Mt("#REF!");Mt.VALUE=new Mt("#VALUE!");Mt.getError=H=>Bn.find(Mt,t=>t instanceof Mt&&t.error()===H)||new Mt(H);var Ai=Mt,xr=["000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","800000","008000","000080","808000","800080","008080","C0C0C0","808080","9999FF","993366","FFFFCC","CCFFFF","660066","FF8080","0066CC","CCCCFF","000080","FF00FF","FFFF00","00FFFF","800080","800000","008080","0000FF","00CCFF","CCFFFF","CCFFCC","FFFF99","99CCFF","FF99CC","CC99FF","FFCC99","3366FF","33CCCC","99CC00","FFCC00","FF9900","FF6600","666699","969696","003366","339966","003300","333300","993300","993366","333399","333333","System Foreground","System Background"];const Rn=de,Xt=Wt,At=me,Dn=xr;let ue=class{constructor(t,e,n,s,o,l){this._styleSheet=t,this._id=e,this._xfNode=n,this._fontNode=s,this._fillNode=o,this._borderNode=l}id(){return this._id}style(){return new Rn("_Style.style").case("string",t=>{const e=`_get_${t}`;if(!this[e])throw new Error(`_Style.style: '${t}' is not a valid style`);return this[e]()}).case(["string","*"],(t,e)=>{const n=`_set_${t}`;if(!this[n])throw new Error(`_Style.style: '${t}' is not a valid style`);return this[n](e),this}).handle(arguments)}_getColor(t,e){const n=At.findChild(t,e);if(!n||!n.attributes)return;const s={};if(n.attributes.hasOwnProperty("rgb")?s.rgb=n.attributes.rgb:n.attributes.hasOwnProperty("theme")?s.theme=n.attributes.theme:n.attributes.hasOwnProperty("indexed")&&(s.rgb=Dn[n.attributes.indexed]),n.attributes.hasOwnProperty("tint")&&(s.tint=n.attributes.tint),!Xt.isEmpty(s))return s}_setColor(t,e,n){typeof n=="string"?n={rgb:n}:typeof n=="number"&&(n={theme:n}),At.setChildAttributes(t,e,{rgb:n&&n.rgb&&n.rgb.toUpperCase(),indexed:null,theme:n&&n.theme,tint:n&&n.tint}),At.removeChildIfEmpty(t,"color")}_get_bold(){return At.hasChild(this._fontNode,"b")}_set_bold(t){t?At.appendChildIfNotFound(this._fontNode,"b"):At.removeChild(this._fontNode,"b")}_get_italic(){return At.hasChild(this._fontNode,"i")}_set_italic(t){t?At.appendChildIfNotFound(this._fontNode,"i"):At.removeChild(this._fontNode,"i")}_get_underline(){const t=At.findChild(this._fontNode,"u");return t?t.attributes.val||!0:!1}_set_underline(t){if(t){const e=At.appendChildIfNotFound(this._fontNode,"u"),n=typeof t=="string"?t:null;At.setAttributes(e,{val:n})}else At.removeChild(this._fontNode,"u")}_get_strikethrough(){return At.hasChild(this._fontNode,"strike")}_set_strikethrough(t){t?At.appendChildIfNotFound(this._fontNode,"strike"):At.removeChild(this._fontNode,"strike")}_getFontVerticalAlignment(){return At.getChildAttribute(this._fontNode,"vertAlign","val")}_setFontVerticalAlignment(t){At.setChildAttributes(this._fontNode,"vertAlign",{val:t}),At.removeChildIfEmpty(this._fontNode,"vertAlign")}_get_subscript(){return this._getFontVerticalAlignment()==="subscript"}_set_subscript(t){this._setFontVerticalAlignment(t?"subscript":null)}_get_superscript(){return this._getFontVerticalAlignment()==="superscript"}_set_superscript(t){this._setFontVerticalAlignment(t?"superscript":null)}_get_fontSize(){return At.getChildAttribute(this._fontNode,"sz","val")}_set_fontSize(t){At.setChildAttributes(this._fontNode,"sz",{val:t}),At.removeChildIfEmpty(this._fontNode,"sz")}_get_fontFamily(){return At.getChildAttribute(this._fontNode,"name","val")}_set_fontFamily(t){At.setChildAttributes(this._fontNode,"name",{val:t}),At.removeChildIfEmpty(this._fontNode,"name")}_get_fontGenericFamily(){return At.getChildAttribute(this._fontNode,"family","val")}_set_fontGenericFamily(t){At.setChildAttributes(this._fontNode,"family",{val:t}),At.removeChildIfEmpty(this._fontNode,"family")}_get_fontColor(){return this._getColor(this._fontNode,"color")}_set_fontColor(t){this._setColor(this._fontNode,"color",t)}_get_fontScheme(){return At.getChildAttribute(this._fontNode,"scheme","val")}_set_fontScheme(t){At.setChildAttributes(this._fontNode,"scheme",{val:t}),At.removeChildIfEmpty(this._fontNode,"scheme")}_get_horizontalAlignment(){return At.getChildAttribute(this._xfNode,"alignment","horizontal")}_set_horizontalAlignment(t){At.setChildAttributes(this._xfNode,"alignment",{horizontal:t}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_justifyLastLine(){return At.getChildAttribute(this._xfNode,"alignment","justifyLastLine")===1}_set_justifyLastLine(t){At.setChildAttributes(this._xfNode,"alignment",{justifyLastLine:t?1:null}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_indent(){return At.getChildAttribute(this._xfNode,"alignment","indent")}_set_indent(t){At.setChildAttributes(this._xfNode,"alignment",{indent:t}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_verticalAlignment(){return At.getChildAttribute(this._xfNode,"alignment","vertical")}_set_verticalAlignment(t){At.setChildAttributes(this._xfNode,"alignment",{vertical:t}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_wrapText(){return At.getChildAttribute(this._xfNode,"alignment","wrapText")===1}_set_wrapText(t){At.setChildAttributes(this._xfNode,"alignment",{wrapText:t?1:null}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_shrinkToFit(){return At.getChildAttribute(this._xfNode,"alignment","shrinkToFit")===1}_set_shrinkToFit(t){At.setChildAttributes(this._xfNode,"alignment",{shrinkToFit:t?1:null}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_textDirection(){const t=At.getChildAttribute(this._xfNode,"alignment","readingOrder");return t===1?"left-to-right":t===2?"right-to-left":t}_set_textDirection(t){let e;t==="left-to-right"?e=1:t==="right-to-left"&&(e=2),At.setChildAttributes(this._xfNode,"alignment",{readingOrder:e}),At.removeChildIfEmpty(this._xfNode,"alignment")}_getTextRotation(){return At.getChildAttribute(this._xfNode,"alignment","textRotation")}_setTextRotation(t){At.setChildAttributes(this._xfNode,"alignment",{textRotation:t}),At.removeChildIfEmpty(this._xfNode,"alignment")}_get_textRotation(){let t=this._getTextRotation();return t>90&&(t=90-t),t}_set_textRotation(t){t<0&&(t=90-t),this._setTextRotation(t)}_get_angleTextCounterclockwise(){return this._getTextRotation()===45}_set_angleTextCounterclockwise(t){this._setTextRotation(t?45:null)}_get_angleTextClockwise(){return this._getTextRotation()===135}_set_angleTextClockwise(t){this._setTextRotation(t?135:null)}_get_rotateTextUp(){return this._getTextRotation()===90}_set_rotateTextUp(t){this._setTextRotation(t?90:null)}_get_rotateTextDown(){return this._getTextRotation()===180}_set_rotateTextDown(t){this._setTextRotation(t?180:null)}_get_verticalText(){return this._getTextRotation()===255}_set_verticalText(t){this._setTextRotation(t?255:null)}_get_fill(){const t=At.findChild(this._fillNode,"patternFill"),e=At.findChild(this._fillNode,"gradientFill"),n=t&&t.attributes.patternType;if(n==="solid")return{type:"solid",color:this._getColor(t,"fgColor")};if(n)return{type:"pattern",pattern:n,foreground:this._getColor(t,"fgColor"),background:this._getColor(t,"bgColor")};if(e){const s=e.attributes.type||"linear",o={type:"gradient",gradientType:s,stops:Xt.map(e.children,l=>({position:l.attributes.position,color:this._getColor(l,"color")}))};return s==="linear"?o.angle=e.attributes.degree:(o.left=e.attributes.left,o.right=e.attributes.right,o.top=e.attributes.top,o.bottom=e.attributes.bottom),o}}_set_fill(t){if(this._fillNode.children=[],Xt.isNil(t))return;if(t.type==="pattern"){const n={name:"patternFill",attributes:{patternType:t.pattern},children:[]};this._fillNode.children.push(n),this._setColor(n,"fgColor",t.foreground),this._setColor(n,"bgColor",t.background);return}if(t.type==="gradient"){const n={name:"gradientFill",attributes:{},children:[]};this._fillNode.children.push(n),At.setAttributes(n,{type:t.gradientType==="path"?"path":void 0,left:t.left,right:t.right,top:t.top,bottom:t.bottom,degree:t.angle}),Xt.forEach(t.stops,(s,o)=>{const l={name:"stop",attributes:{position:s.position},children:[]};n.children.push(l),this._setColor(l,"color",s.color)});return}Xt.isObject(t)?(t.hasOwnProperty("rgb")||t.hasOwnProperty("theme"))&&(t={color:t}):t={type:"solid",color:t};const e={name:"patternFill",attributes:{patternType:"solid"}};this._fillNode.children.push(e),this._setColor(e,"fgColor",t.color)}_getBorder(){const t={};return["left","right","top","bottom","diagonal"].forEach(e=>{const n=At.findChild(this._borderNode,e),s={},o=At.getChildAttribute(this._borderNode,e,"style");o&&(s.style=o);const l=this._getColor(n,"color");if(l&&(s.color=l),e==="diagonal"){const a=this._borderNode.attributes.diagonalUp,d=this._borderNode.attributes.diagonalDown;let N;a&&d?N="both":a?N="up":d&&(N="down"),N&&(s.direction=N)}Xt.isEmpty(s)||(t[e]=s)}),t}_setBorder(t){Xt.forOwn(t,(e,n)=>{if(typeof e=="boolean"?e={style:e?"thin":null}:typeof e=="string"?e={style:e}:e==null&&(e={style:null,color:null,direction:null}),e.hasOwnProperty("style")&&At.setChildAttributes(this._borderNode,n,{style:e.style}),e.hasOwnProperty("color")){const s=At.findChild(this._borderNode,n);this._setColor(s,"color",e.color)}n==="diagonal"&&At.setAttributes(this._borderNode,{diagonalUp:e.direction==="up"||e.direction==="both"?1:null,diagonalDown:e.direction==="down"||e.direction==="both"?1:null})})}_get_border(){return this._getBorder()}_set_border(t){Xt.isObject(t)&&!t.hasOwnProperty("style")&&!t.hasOwnProperty("color")?(t=Xt.defaults(t,{left:null,right:null,top:null,bottom:null,diagonal:null}),this._setBorder(t)):this._setBorder({left:t,right:t,top:t,bottom:t})}_get_borderColor(){return Xt.mapValues(this._getBorder(),t=>t.color)}_set_borderColor(t){Xt.isObject(t)?this._setBorder(Xt.mapValues(t,e=>({color:e}))):this._setBorder({left:{color:t},right:{color:t},top:{color:t},bottom:{color:t},diagonal:{color:t}})}_get_borderStyle(){return Xt.mapValues(this._getBorder(),t=>t.style)}_set_borderStyle(t){Xt.isObject(t)?this._setBorder(Xt.mapValues(t,e=>({style:e}))):this._setBorder({left:{style:t},right:{style:t},top:{style:t},bottom:{style:t}})}_get_diagonalBorderDirection(){const t=this._getBorder().diagonal;return t&&t.direction}_set_diagonalBorderDirection(t){this._setBorder({diagonal:{direction:t}})}_get_numberFormat(){const t=this._xfNode.attributes.numFmtId||0;return this._styleSheet.getNumberFormatCode(t)}_set_numberFormat(t){this._xfNode.attributes.numFmtId=this._styleSheet.getNumberFormatId(t)}};["left","right","top","bottom","diagonal"].forEach(H=>{ue.prototype[`_get_${H}Border`]=function(){return this._getBorder()[H]},ue.prototype[`_set_${H}Border`]=function(t){this._setBorder({[H]:t})},ue.prototype[`_get_${H}BorderColor`]=function(){const t=this._getBorder()[H];return t&&t.color},ue.prototype[`_set_${H}BorderColor`]=function(t){this._setBorder({[H]:{color:t}})},ue.prototype[`_get_${H}BorderStyle`]=function(){const t=this._getBorder()[H];return t&&t.style},ue.prototype[`_set_${H}BorderStyle`]=function(t){this._setBorder({[H]:{style:t}})}});ue.name||(ue.name="Style");var vi=ue;const Hr=de,On=Wt,Bt=me,Pn=xr;let vr=class{constructor(t,e,n){this._richText=n,t.name==="r"?(this._node=t,this._fontNode=Bt.findChild(this._node,"rPr"),this._fontNode||(this._fontNode={name:"rPr",attributes:{},children:[]},this._node.children.unshift(this._fontNode)),this._valueNode=Bt.findChild(this._node,"t")):(this._node={name:"r",attributes:{},children:[{name:"rPr",attributes:{},children:[]},{name:"t",attributes:{},children:[]}]},this._fontNode=Bt.findChild(this._node,"rPr"),this._valueNode=Bt.findChild(this._node,"t"),this.value(t),e&&this.style(e))}value(){return new Hr("_RichText.value").case(()=>this._valueNode.children[0]).case("string",t=>{t=t.replace(/(?:\r\n|\r|\n)/g,`\r
`);const e=t.indexOf(`\r
`)!==-1;return this._valueNode.children[0]=t,t.charAt(0)===" "&&Bt.setAttributes(this._valueNode,{"xml:space":"preserve"}),this._richText&&this._richText.removeUnsupportedNodes(),e&&(this._richText.cell&&this._richText.cell.style("wrapText",!0),Bt.setAttributes(this._valueNode,{"xml:space":"preserve"})),this}).handle(arguments)}toXml(){return this._node}style(){return new Hr("_RichText.style").case("string",t=>{const e=`_get_${t}`;if(!this[e])throw new Error(`_RichText.style: '${t}' is not a valid style`);return this[e]()}).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this.style(n)}),e}).case(["string","*"],(t,e)=>{const n=`_set_${t}`;if(!this[n])throw new Error(`_RichText.style: '${t}' is not a valid style`);return this[n](e)}).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this.style(e,n)}return this}).handle(arguments)}_getColor(t,e){const n=Bt.findChild(t,e);if(!n||!n.attributes)return;const s={};if(n.attributes.hasOwnProperty("rgb")?s.rgb=n.attributes.rgb:n.attributes.hasOwnProperty("theme")?s.theme=n.attributes.theme:n.attributes.hasOwnProperty("indexed")&&(s.rgb=Pn[n.attributes.indexed]),n.attributes.hasOwnProperty("tint")&&(s.tint=n.attributes.tint),!On.isEmpty(s))return s}_setColor(t,e,n){typeof n=="string"?n={rgb:n}:typeof n=="number"&&(n={theme:n}),Bt.setChildAttributes(t,e,{rgb:n&&n.rgb&&n.rgb.toUpperCase(),indexed:null,theme:n&&n.theme,tint:n&&n.tint}),Bt.removeChildIfEmpty(t,"color")}_get_bold(){return Bt.hasChild(this._fontNode,"b")}_set_bold(t){t?Bt.appendChildIfNotFound(this._fontNode,"b"):Bt.removeChild(this._fontNode,"b")}_get_italic(){return Bt.hasChild(this._fontNode,"i")}_set_italic(t){t?Bt.appendChildIfNotFound(this._fontNode,"i"):Bt.removeChild(this._fontNode,"i")}_get_underline(){const t=Bt.findChild(this._fontNode,"u");return t?t.attributes.val||!0:!1}_set_underline(t){if(t){const e=Bt.appendChildIfNotFound(this._fontNode,"u"),n=typeof t=="string"?t:null;Bt.setAttributes(e,{val:n})}else Bt.removeChild(this._fontNode,"u")}_get_strikethrough(){return Bt.hasChild(this._fontNode,"strike")}_set_strikethrough(t){t?Bt.appendChildIfNotFound(this._fontNode,"strike"):Bt.removeChild(this._fontNode,"strike")}_getFontVerticalAlignment(){return Bt.getChildAttribute(this._fontNode,"vertAlign","val")}_setFontVerticalAlignment(t){Bt.setChildAttributes(this._fontNode,"vertAlign",{val:t}),Bt.removeChildIfEmpty(this._fontNode,"vertAlign")}_get_subscript(){return this._getFontVerticalAlignment()==="subscript"}_set_subscript(t){this._setFontVerticalAlignment(t?"subscript":null)}_get_superscript(){return this._getFontVerticalAlignment()==="superscript"}_set_superscript(t){this._setFontVerticalAlignment(t?"superscript":null)}_get_fontSize(){return Bt.getChildAttribute(this._fontNode,"sz","val")}_set_fontSize(t){Bt.setChildAttributes(this._fontNode,"sz",{val:t}),Bt.removeChildIfEmpty(this._fontNode,"sz")}_get_fontFamily(){return Bt.getChildAttribute(this._fontNode,"rFont","val")}_set_fontFamily(t){Bt.setChildAttributes(this._fontNode,"rFont",{val:t}),Bt.removeChildIfEmpty(this._fontNode,"rFont")}_get_fontGenericFamily(){return Bt.getChildAttribute(this._fontNode,"family","val")}_set_fontGenericFamily(t){Bt.setChildAttributes(this._fontNode,"family",{val:t}),Bt.removeChildIfEmpty(this._fontNode,"family")}_get_fontColor(){return this._getColor(this._fontNode,"color")}_set_fontColor(t){this._setColor(this._fontNode,"color",t)}_get_fontScheme(){return Bt.getChildAttribute(this._fontNode,"scheme","val")}_set_fontScheme(t){Bt.setChildAttributes(this._fontNode,"scheme",{val:t}),Bt.removeChildIfEmpty(this._fontNode,"scheme")}};vr.name||(vr.name="RichTextFragment");var Un=vr;const Wr=Wt,fr=Un;let br=class bi{constructor(t){if(this._node=[],this._cell=null,this._remainingNodes=[],t)for(let e=0;e<t.length;e++){const n=t[e];n.name==="r"?this._node.push(new fr(n,null,this)):this._remainingNodes.push(n)}}get cell(){return this._cell}get length(){return this._node.length}text(){let t="";for(let e=0;e<this._node.length;e++)t+=this.get(e).value();return t}getInstanceWithCellRef(t){return this._cell=t,this}copy(t){const e=new bi(Wr.cloneDeep(this.toXml()));return t&&Wr.includes(this.text(),`
`)&&t.style("wrapText",!0),e}get(t){return this._node[t]}remove(t){return this._node.splice(t,1),this.removeUnsupportedNodes(),this}add(t,e,n){return n==null?this._node.push(new fr(t,e,this)):this._node.splice(n,0,new fr(t,e,this)),this.removeUnsupportedNodes(),this}clear(){return this._node=[],this._remainingNodes=[],this._cell=void 0,this}removeUnsupportedNodes(){this._remainingNodes=[]}toXml(){const t=[];for(let e=0;e<this._node.length;e++)t.push(this._node[e].toXml());return t.concat(this._remainingNodes)}};br.name||(br.name="RichText");var xi=br;const jt=Wt,be=de,dr=Ee,zn=yi,Ln=Qe,ee=me,Mn=Ai,Vn=vi,We=xi;let jn=class{constructor(t,e,n){this._row=t,this._init(e,n)}active(){return new be("Cell.active").case(()=>this.sheet().activeCell()===this).case("boolean",t=>{if(!t)throw new Error("Deactivating cell directly not supported. Activate a different cell instead.");return this.sheet().activeCell(this),this}).handle(arguments)}address(t){return dr.toAddress({type:"cell",rowNumber:this.rowNumber(),columnNumber:this.columnNumber(),sheetName:t&&t.includeSheetName&&this.sheet().name(),rowAnchored:t&&(t.rowAnchored||t.anchored),columnAnchored:t&&(t.columnAnchored||t.anchored)})}column(){return this.sheet().column(this.columnNumber())}clear(){const t=this._formulaRef&&this._sharedFormulaId;return delete this._value,delete this._formulaType,delete this._formula,delete this._sharedFormulaId,delete this._formulaRef,jt.isNil(t)||this.sheet().clearCellsUsingSharedFormula(t),this}columnName(){return dr.columnNumberToName(this.columnNumber())}columnNumber(){return this._columnNumber}find(t,e){t=Ln(t);const n=this.value();if(typeof n!="string")return!1;if(jt.isNil(e))return t.test(n);{const s=n.replace(t,e);return s===n?!1:(this.value(s),!0)}}formula(){return new be("Cell.formula").case(()=>this._formulaType==="shared"&&!this._formulaRef?"SHARED":this._formula).case("nil",()=>(this.clear(),this)).case("string",t=>(this.clear(),this._formulaType="normal",this._formula=t,this)).handle(arguments)}hyperlink(){return new be("Cell.hyperlink").case(()=>this.sheet().hyperlink(this.address())).case("string",t=>(this.sheet().hyperlink(this.address(),t),this)).case(["object"],t=>(this.sheet().hyperlink(this.address(),t),this)).handle(arguments)}dataValidation(){return new be("Cell.dataValidation").case(()=>this.sheet().dataValidation(this.address())).case("boolean",t=>this.sheet().dataValidation(this.address(),t)).case("*",t=>(this.sheet().dataValidation(this.address(),t),this)).handle(arguments)}tap(t){return t(this),this}thru(t){return t(this)}rangeTo(t){return this.sheet().range(this,t)}relativeCell(t,e){const n=t+this.rowNumber(),s=e+this.columnNumber();return this.sheet().cell(n,s)}row(){return this._row}rowNumber(){return this.row().rowNumber()}sheet(){return this.row().sheet()}style(){return!this._style&&!(arguments[0]instanceof Vn)&&(this._style=this.workbook().styleSheet().createStyle(this._styleId)),new be("Cell.style").case("string",t=>this._style.style(t)).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this.style(n)}),e}).case(["string","array"],(t,e)=>{const n=e.length,s=e[0].length;return this.rangeTo(this.relativeCell(n-1,s-1)).style(t,e)}).case(["string","*"],(t,e)=>(this._style.style(t,e),this)).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this.style(e,n)}return this}).case("Style",t=>(this._style=t,this._styleId=t.id(),this)).handle(arguments)}value(){return new be("Cell.value").case(()=>this._value instanceof We?this._value.getInstanceWithCellRef(this):this._value).case("array",t=>{const e=t.length,n=t[0].length;return this.rangeTo(this.relativeCell(e-1,n-1)).value(t)}).case("*",t=>(this.clear(),t instanceof We?this._value=t.copy(this):this._value=t,this)).handle(arguments)}workbook(){return this.row().workbook()}addHorizontalPageBreak(){return this.row().addPageBreak(),this}getSharedRefFormula(){return this._formulaType==="shared"?this._formulaRef&&this._formula:void 0}sharesFormula(t){return this._formulaType==="shared"&&this._sharedFormulaId===t}setSharedFormula(t,e,n){this.clear(),this._formulaType="shared",this._sharedFormulaId=t,this._formula=e,this._formulaRef=n}toXml(){const t={name:"c",attributes:this._remainingAttributes||{},children:[]};if(t.attributes.r=this.address(),jt.isNil(this._formulaType)){if(!jt.isNil(this._value)){let e,n;typeof this._value=="string"?(e="s",n=this.workbook().sharedStrings().getIndexForString(this._value)):typeof this._value=="boolean"?(e="b",n=this._value?1:0):typeof this._value=="number"?n=this._value:this._value instanceof Date?n=zn.dateToNumber(this._value):(this._value instanceof We||typeof this._value=="object"&&this._value.constructor.name==="RichText")&&(e="s",n=this.workbook().sharedStrings().getIndexForString(this._value.toXml())),e&&(t.attributes.t=e);const s={name:"v",children:[n]};t.children.push(s)}}else{const e={name:"f",attributes:this._remainingFormulaAttributes||{}};this._formulaType!=="normal"&&(e.attributes.t=this._formulaType),jt.isNil(this._formulaRef)||(e.attributes.ref=this._formulaRef),jt.isNil(this._sharedFormulaId)||(e.attributes.si=this._sharedFormulaId),jt.isNil(this._formula)||(e.children=[this._formula]),t.children.push(e)}return jt.isNil(this._style)?jt.isNil(this._styleId)||(t.attributes.s=this._styleId):t.attributes.s=this._style.id(),this._remainingChildren&&(t.children=t.children.concat(this._remainingChildren)),t}_init(t,e){jt.isObject(t)?this._parseNode(t):(this._columnNumber=t,jt.isNil(e)||(this._styleId=e))}_parseNode(t){const e=dr.fromAddress(t.attributes.r);this._columnNumber=e.columnNumber,jt.isNil(t.attributes.s)||(this._styleId=t.attributes.s);const n=ee.findChild(t,"f");n&&(this._formulaType=n.attributes.t||"normal",this._formulaRef=n.attributes.ref,this._formula=n.children[0],this._sharedFormulaId=n.attributes.si,jt.isNil(this._sharedFormulaId)||this.sheet().updateMaxSharedFormulaId(this._sharedFormulaId),delete n.attributes.t,delete n.attributes.ref,delete n.attributes.si,jt.isEmpty(n.attributes)||(this._remainingFormulaAttributes=n.attributes));const s=t.attributes.t;if(s==="s"){const o=ee.findChild(t,"v");if(o){const l=o.children[0];this._value=this.workbook().sharedStrings().getStringByIndex(l),jt.isArray(this._value)&&(this._value=new We(this._value))}else this._value=""}else if(s==="str"){const o=ee.findChild(t,"v");this._value=o&&o.children[0]}else if(s==="inlineStr"){const o=ee.findChild(t,"is");if(o.children[0].name==="t"){const l=o.children[0];this._value=l.children[0]}else this._value=o.children}else if(s==="b")this._value=ee.findChild(t,"v").children[0]===1;else if(s==="e"){const o=ee.findChild(t,"v").children[0];this._value=Mn.getError(o)}else{const o=ee.findChild(t,"v");this._value=o&&Number(o.children[0])}delete t.attributes.r,delete t.attributes.s,delete t.attributes.t,jt.isEmpty(t.attributes)||(this._remainingAttributes=t.attributes),ee.removeChild(t,"f"),ee.removeChild(t,"v"),ee.removeChild(t,"is"),jt.isEmpty(t.children)||(this._remainingChildren=t.children)}};var Ci=jn;const ge=Wt,Gr=Ci,Hn=Qe,mr=de,Xr=Ee;let Wn=class{constructor(t,e){this._sheet=t,this._init(e)}address(t){return Xr.toAddress({type:"row",rowNumber:this.rowNumber(),sheetName:t&&t.includeSheetName&&this.sheet().name(),rowAnchored:t&&t.anchored})}cell(t){let e=t;if(typeof t=="string"&&(e=Xr.columnNameToNumber(t)),e<1)throw new RangeError(`Invalid column number ${e}. Remember that spreadsheets use 1-based indexing.`);if(this._cells[e])return this._cells[e];let n;const s=this._node.attributes.s,o=this.sheet().existingColumnStyleId(e);ge.isNil(s)?ge.isNil(o)||(n=o):n=s;const l=new Gr(this,e,n);return this._cells[e]=l,l}height(){return new mr("Row.height").case(()=>this._node.attributes.customHeight?this._node.attributes.ht:void 0).case("number",t=>(this._node.attributes.ht=t,this._node.attributes.customHeight=1,this)).case("nil",()=>(delete this._node.attributes.ht,delete this._node.attributes.customHeight,this)).handle(arguments)}hidden(){return new mr("Row.hidden").case(()=>this._node.attributes.hidden===1).case("boolean",t=>(t?this._node.attributes.hidden=1:delete this._node.attributes.hidden,this)).handle(arguments)}rowNumber(){return this._node.attributes.r}sheet(){return this._sheet}style(){return new mr("Row.style").case("string",t=>(this._createStyleIfNeeded(),this._style.style(t))).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this.style(n)}),e}).case(["string","*"],(t,e)=>(this._createCellStylesIfNeeded(),ge.forEach(this._cells,n=>{n&&n.style(t,e)}),this._createStyleIfNeeded(),this._style.style(t,e),this)).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this.style(e,n)}return this}).case("Style",t=>(this._createCellStylesIfNeeded(),ge.forEach(this._cells,e=>{e&&e.style(t)}),this._style=t,this._node.attributes.s=t.id(),this._node.attributes.customFormat=1,this)).handle(arguments)}workbook(){return this.sheet().workbook()}addPageBreak(){return this.sheet().horizontalPageBreaks().add(this.rowNumber()),this}clearCellsUsingSharedFormula(t){this._cells.forEach(e=>{e&&e.sharesFormula(t)&&e.clear()})}find(t,e){t=Hn(t);const n=[];return this._cells.forEach(s=>{s&&s.find(t,e)&&n.push(s)}),n}hasCell(t){if(t<1)throw new RangeError(`Invalid column number ${t}. Remember that spreadsheets use 1-based indexing.`);return!!this._cells[t]}hasStyle(){return!ge.isNil(this._node.attributes.s)}minUsedColumnNumber(){return ge.findIndex(this._cells)}maxUsedColumnNumber(){return this._cells.length-1}toXml(){return this._node}_createCellStylesIfNeeded(){this.sheet().forEachExistingColumnNumber(t=>{ge.isNil(this.sheet().existingColumnStyleId(t))||this.cell(t)})}_createStyleIfNeeded(){if(!this._style){const t=this._node.attributes.s;this._style=this.workbook().styleSheet().createStyle(t),this._node.attributes.s=this._style.id(),this._node.attributes.customFormat=1}}_init(t){this._node=t,this._cells=[],this._node.children.forEach(e=>{const n=new Gr(this,e);this._cells[n.columnNumber()]=n}),this._node.children=this._cells}};var Gn=Wn;const pr=de,Zr=Ee,Xn=9.140625;let Zn=class{constructor(t,e){this._sheet=t,this._node=e}address(t){return Zr.toAddress({type:"column",columnName:this.columnName(),sheetName:t&&t.includeSheetName&&this.sheet().name(),columnAnchored:t&&t.anchored})}cell(t){return this.sheet().cell(t,this.columnNumber())}columnName(){return Zr.columnNumberToName(this.columnNumber())}columnNumber(){return this._node.attributes.min}hidden(){return new pr("Column.hidden").case(()=>this._node.attributes.hidden===1).case("boolean",t=>(t?this._node.attributes.hidden=1:delete this._node.attributes.hidden,this)).handle(arguments)}sheet(){return this._sheet}style(){return new pr("Column.style").case("string",t=>(this._createStyleIfNeeded(),this._style.style(t))).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this.style(n)}),e}).case(["string","*"],(t,e)=>(this.sheet().forEachExistingRow(n=>{(n.hasStyle()||n.hasCell(this.columnNumber()))&&n.cell(this.columnNumber()).style(t,e)}),this._createStyleIfNeeded(),this._style.style(t,e),this)).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this.style(e,n)}return this}).case("Style",t=>(this.sheet().forEachExistingRow(e=>{(e.hasStyle()||e.hasCell(this.columnNumber()))&&e.cell(this.columnNumber()).style(t)}),this._style=t,this._node.attributes.style=t.id(),this)).handle(arguments)}width(t){return new pr("Column.width").case(()=>this._node.attributes.customWidth?this._node.attributes.width:void 0).case("number",e=>(this._node.attributes.width=e,this._node.attributes.customWidth=1,this)).case("nil",()=>(delete this._node.attributes.width,delete this._node.attributes.customWidth,this)).handle(arguments)}workbook(){return this.sheet().workbook()}addPageBreak(){return this.sheet().verticalPageBreaks().add(this.columnNumber()),this}toXml(){return this._node}_createStyleIfNeeded(){if(!this._style){const t=this._node.attributes.style;this._style=this.workbook().styleSheet().createStyle(t),this._node.attributes.style=this._style.id(),this.width()||this.width(Xn)}}};var $n=Zn;const Te=de,qn=Ee;let Kn=class{constructor(t,e){this._startCell=t,this._endCell=e,this._findRangeExtent(t,e)}address(t){return qn.toAddress({type:"range",startRowNumber:this.startCell().rowNumber(),startRowAnchored:t&&(t.startRowAnchored||t.anchored),startColumnName:this.startCell().columnName(),startColumnAnchored:t&&(t.startColumnAnchored||t.anchored),endRowNumber:this.endCell().rowNumber(),endRowAnchored:t&&(t.endRowAnchored||t.anchored),endColumnName:this.endCell().columnName(),endColumnAnchored:t&&(t.endColumnAnchored||t.anchored),sheetName:t&&t.includeSheetName&&this.sheet().name()})}cell(t,e){return this.sheet().cell(this._minRowNumber+t,this._minColumnNumber+e)}autoFilter(){return this.sheet().autoFilter(this),this}cells(){return this.map(t=>t)}clear(){return this.value(void 0)}endCell(){return this._endCell}forEach(t){for(let e=0;e<this._numRows;e++)for(let n=0;n<this._numColumns;n++)t(this.cell(e,n),e,n,this);return this}formula(){return new Te("Range.formula").case(()=>this.startCell().getSharedRefFormula()).case("string",t=>{const e=this.sheet().incrementMaxSharedFormulaId();return this.forEach((n,s,o)=>{s===0&&o===0?n.setSharedFormula(e,t,this.address()):n.setSharedFormula(e)}),this}).handle(arguments)}map(t){const e=[];return this.forEach((n,s,o)=>{e[s]||(e[s]=[]),e[s][o]=t(n,s,o,this)}),e}merged(t){return new Te("Range.merged").case(()=>this.sheet().merged(this.address())).case("*",e=>(this.sheet().merged(this.address(),e),this)).handle(arguments)}dataValidation(){return new Te("Range.dataValidation").case(()=>this.sheet().dataValidation(this.address())).case("boolean",t=>this.sheet().dataValidation(this.address(),t)).case("*",t=>(this.sheet().dataValidation(this.address(),t),this)).handle(arguments)}reduce(t,e){let n=e;return this.forEach((s,o,l)=>{n=t(n,s,o,l,this)}),n}sheet(){return this.startCell().sheet()}startCell(){return this._startCell}style(){return new Te("Range.style").case("string",t=>this.map(e=>e.style(t))).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this.style(n)}),e}).case(["string","function"],(t,e)=>this.forEach((n,s,o)=>{n.style(t,e(n,s,o,this))})).case(["string","array"],(t,e)=>this.forEach((n,s,o)=>{e[s]&&e[s][o]!==void 0&&n.style(t,e[s][o])})).case(["string","*"],(t,e)=>this.forEach(n=>n.style(t,e))).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this.style(e,n)}return this}).case("Style",t=>(this._style=t,this.forEach(e=>e.style(t)))).handle(arguments)}tap(t){return t(this),this}thru(t){return t(this)}value(){return new Te("Range.value").case(()=>this.map(t=>t.value())).case("function",t=>this.forEach((e,n,s)=>{e.value(t(e,n,s,this))})).case("array",t=>this.forEach((e,n,s)=>{t[n]&&t[n][s]!==void 0&&e.value(t[n][s])})).case("*",t=>this.forEach(e=>e.value(t))).handle(arguments)}workbook(){return this.sheet().workbook()}_findRangeExtent(){this._minRowNumber=Math.min(this._startCell.rowNumber(),this._endCell.rowNumber()),this._maxRowNumber=Math.max(this._startCell.rowNumber(),this._endCell.rowNumber()),this._minColumnNumber=Math.min(this._startCell.columnNumber(),this._endCell.columnNumber()),this._maxColumnNumber=Math.max(this._startCell.columnNumber(),this._endCell.columnNumber()),this._numRows=this._maxRowNumber-this._minRowNumber+1,this._numColumns=this._maxColumnNumber-this._minColumnNumber+1}};var Yn=Kn;const $r=Wt,qr="http://schemas.openxmlformats.org/officeDocument/2006/relationships/";let Qn=class{constructor(t){this._init(t),this._getStartingId()}add(t,e,n){const s={name:"Relationship",attributes:{Id:`rId${this._nextId++}`,Type:`${qr}${t}`,Target:e}};return n&&(s.attributes.TargetMode=n),this._node.children.push(s),s}findById(t){return $r.find(this._node.children,e=>e.attributes.Id===t)}findByType(t){return $r.find(this._node.children,e=>e.attributes.Type===`${qr}${t}`)}toXml(){if(this._node.children.length)return this._node}_getStartingId(){this._nextId=1,this._node.children.forEach(t=>{const e=parseInt(t.attributes.Id.substr(3));e>=this._nextId&&(this._nextId=e+1)})}_init(t){t||(t={name:"Relationships",attributes:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},children:[]}),this._node=t}};var Ni=Qn;let Jn=class{constructor(t){this._node=t}add(t){return this._node.children.push({name:"brk",children:[],attributes:{id:t,max:16383,man:1}}),this._node.attributes.count++,this._node.attributes.manualBreakCount++,this}remove(t){const e=this._node.children[t];return e&&(this._node.children.splice(t,1),this._node.attributes.count--,e.man&&this._node.attributes.manualBreakCount--),this}get count(){return this._node.attributes.count}get list(){return this._node.children.map(t=>({id:t.id,isManual:!!t.man}))}};var ts=Jn;const Dt=Wt,Kr=Ci,Yr=Gn,es=$n,rs=Yn,is=Ni,Tt=me,ns=Qe,xe=Ee,zt=de,ss=xr,Qr=ts,re=["sheetPr","dimension","sheetViews","sheetFormatPr","cols","sheetData","sheetCalcPr","sheetProtection","autoFilter","protectedRanges","scenarios","autoFilter","sortState","dataConsolidate","customSheetViews","mergeCells","phoneticPr","conditionalFormatting","dataValidations","hyperlinks","printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","customProperties","cellWatches","ignoredErrors","smartTags","drawing","drawingHF","legacyDrawing","legacyDrawingHF","picture","oleObjects","controls","webPublishItems","tableParts","extLst"];let as=class{constructor(t,e,n,s){this._init(t,e,n,s)}active(){return new zt("Sheet.active").case(()=>this.workbook().activeSheet()===this).case("boolean",t=>{if(!t)throw new Error("Deactivating sheet directly not supported. Activate a different sheet instead.");return this.workbook().activeSheet(this),this}).handle(arguments)}activeCell(){const t=this._getOrCreateSheetViewNode();let e=Tt.findChild(t,"selection");return new zt("Sheet.activeCell").case(()=>{const n=e?e.attributes.activeCell:"A1";return this.cell(n)}).case(["number","*"],(n,s)=>{const o=this.cell(n,s);return this.activeCell(o)}).case("*",n=>(e||(e={name:"selection",attributes:{},children:[]},Tt.appendChild(t,e)),n instanceof Kr||(n=this.cell(n)),e.attributes.activeCell=e.attributes.sqref=n.address(),this)).handle(arguments)}cell(){return new zt("Sheet.cell").case("string",t=>{const e=xe.fromAddress(t);if(e.type!=="cell")throw new Error("Sheet.cell: Invalid address.");return this.row(e.rowNumber).cell(e.columnNumber)}).case(["number","*"],(t,e)=>this.row(t).cell(e)).handle(arguments)}column(t){const e=typeof t=="string"?xe.columnNameToNumber(t):t;if(this._columns[e])return this._columns[e];const n=this._colNodes[e];let s;if(n){if(n.attributes.min<e){const l=Dt.cloneDeep(n);l.attributes.max=e-1;for(let a=l.attributes.min;a<=l.attributes.max;a++)this._colNodes[a]=l}if(s=Dt.cloneDeep(n),s.attributes.min=e,s.attributes.max=e,this._colNodes[e]=s,n.attributes.max>e){const l=Dt.cloneDeep(n);l.attributes.min=e+1;for(let a=l.attributes.min;a<=l.attributes.max;a++)this._colNodes[a]=l}}else s={name:"col",attributes:{min:e,max:e},children:[]},this._colNodes[e]=s;const o=new es(this,s);return this._columns[e]=o,o}definedName(){return new zt("Workbook.definedName").case("string",t=>this.workbook().scopedDefinedName(this,t)).case(["string","*"],(t,e)=>(this.workbook().scopedDefinedName(this,t,e),this)).handle(arguments)}delete(){return this.workbook().deleteSheet(this),this.workbook()}find(t,e){t=ns(t);let n=[];return this._rows.forEach(s=>{s&&(n=n.concat(s.find(t,e)))}),n}gridLinesVisible(){const t=this._getOrCreateSheetViewNode();return new zt("Sheet.gridLinesVisible").case(()=>t.attributes.showGridLines===1||t.attributes.showGridLines===void 0).case("boolean",e=>(t.attributes.showGridLines=e?1:0,this)).handle(arguments)}hidden(){return new zt("Sheet.hidden").case(()=>this._idNode.attributes.state==="hidden"?!0:this._idNode.attributes.state==="veryHidden"?"very":!1).case("*",t=>{if(t){const e=Dt.filter(this.workbook().sheets(),n=>!n.hidden());if(e.length===1&&e[0]===this)throw new Error("This sheet may not be hidden as a workbook must contain at least one visible sheet.");if(this.active()){const n=e[0]===this?1:0;e[n].active(!0)}}return t==="very"?this._idNode.attributes.state="veryHidden":t?this._idNode.attributes.state="hidden":delete this._idNode.attributes.state,this}).handle(arguments)}move(t){return this.workbook().moveSheet(this,t),this}name(){return new zt("Sheet.name").case(()=>`${this._idNode.attributes.name}`).case("string",t=>(this._idNode.attributes.name=t,this)).handle(arguments)}range(){return new zt("Sheet.range").case("string",t=>{const e=xe.fromAddress(t);if(e.type!=="range")throw new Error("Sheet.range: Invalid address");return this.range(e.startRowNumber,e.startColumnNumber,e.endRowNumber,e.endColumnNumber)}).case(["*","*"],(t,e)=>(typeof t=="string"&&(t=this.cell(t)),typeof e=="string"&&(e=this.cell(e)),new rs(t,e))).case(["number","*","number","*"],(t,e,n,s)=>this.range(this.cell(t,e),this.cell(n,s))).handle(arguments)}autoFilter(t){return this._autoFilter=t,this}row(t){if(t<1)throw new RangeError(`Invalid row number ${t}. Remember that spreadsheets use 1-based indexing.`);if(this._rows[t])return this._rows[t];const e={name:"row",attributes:{r:t},children:[]},n=new Yr(this,e);return this._rows[t]=n,n}tabColor(){return new zt("Sheet.tabColor").case(()=>{const t=Tt.findChild(this._sheetPrNode,"tabColor");if(!t)return;const e={};return t.attributes.hasOwnProperty("rgb")?e.rgb=t.attributes.rgb:t.attributes.hasOwnProperty("theme")?e.theme=t.attributes.theme:t.attributes.hasOwnProperty("indexed")&&(e.rgb=ss[t.attributes.indexed]),t.attributes.hasOwnProperty("tint")&&(e.tint=t.attributes.tint),e}).case("string",t=>this.tabColor({rgb:t})).case("integer",t=>this.tabColor({theme:t})).case("nil",()=>(Tt.removeChild(this._sheetPrNode,"tabColor"),this)).case("object",t=>{const e=Tt.appendChildIfNotFound(this._sheetPrNode,"tabColor");return Tt.setAttributes(e,{rgb:t.rgb&&t.rgb.toUpperCase(),indexed:null,theme:t.theme,tint:t.tint}),this}).handle(arguments)}tabSelected(){const t=this._getOrCreateSheetViewNode();return new zt("Sheet.tabSelected").case(()=>t.attributes.tabSelected===1).case("boolean",e=>(e?t.attributes.tabSelected=1:delete t.attributes.tabSelected,this)).handle(arguments)}rightToLeft(){const t=this._getOrCreateSheetViewNode();return new zt("Sheet.rightToLeft").case(()=>t.attributes.rightToLeft).case("boolean",e=>(e?t.attributes.rightToLeft=!0:delete t.attributes.rightToLeft,this)).handle(arguments)}usedRange(){const t=Dt.findIndex(this._rows),e=this._rows.length-1;let n=0,s=0;for(let o=0;o<this._rows.length;o++){const l=this._rows[o];if(!l)continue;const a=l.minUsedColumnNumber(),d=l.maxUsedColumnNumber();a>0&&(!n||a<n)&&(n=a),d>0&&(!s||d>s)&&(s=d)}if(!(t<=0||n<=0||e<=0||s<=0))return this.range(t,n,e,s)}workbook(){return this._workbook}pageBreaks(){return this._pageBreaks}verticalPageBreaks(){return this._pageBreaks.colBreaks}horizontalPageBreaks(){return this._pageBreaks.rowBreaks}clearCellsUsingSharedFormula(t){this._rows.forEach(e=>{e&&e.clearCellsUsingSharedFormula(t)})}existingColumnStyleId(t){const e=this._colNodes[t];return e&&e.attributes.style}forEachExistingColumnNumber(t){Dt.forEach(this._colNodes,(e,n)=>{e&&t(n)})}forEachExistingRow(t){return Dt.forEach(this._rows,(e,n)=>{e&&t(e,n)}),this}hyperlink(){return new zt("Sheet.hyperlink").case("string",t=>{const e=this._hyperlinks[t];if(!e)return;const n=this._relationships.findById(e.attributes["r:id"]);return n&&n.attributes.Target}).case(["string","nil"],t=>(delete this._hyperlinks[t],this)).case(["string","string"],(t,e)=>this.hyperlink(t,e,!1)).case(["string","string","boolean"],(t,e,n)=>{const s=n||xe.fromAddress(e);let o;if(s)o={ref:t,location:e,display:e};else{const l=this._relationships.add("hyperlink",e,"External");o={ref:t,"r:id":l.attributes.Id}}return this._hyperlinks[t]={name:"hyperlink",attributes:o,children:[]},this}).case(["string","object"],(t,e)=>{if(e instanceof Kr){const o=e.address({includeSheetName:!0});this.hyperlink(t,o,!0)}else if(e.hyperlink)this.hyperlink(t,e.hyperlink);else if(e.email){const s=e.email,o=e.emailSubject||"";this.hyperlink(t,encodeURI(`mailto:${s}?subject=${o}`))}const n=this._hyperlinks[t];return n&&e.tooltip&&(n.attributes.tooltip=e.tooltip),this}).handle(arguments)}incrementMaxSharedFormulaId(){return++this._maxSharedFormulaId}merged(){return new zt("Sheet.merge").case("string",t=>this._mergeCells.hasOwnProperty(t)).case(["string","*"],(t,e)=>(e?this._mergeCells[t]={name:"mergeCell",attributes:{ref:t},children:[]}:delete this._mergeCells[t],this)).handle(arguments)}dataValidation(){return new zt("Sheet.dataValidation").case("string",t=>this._dataValidations[t]?{type:this._dataValidations[t].attributes.type,allowBlank:this._dataValidations[t].attributes.allowBlank,showInputMessage:this._dataValidations[t].attributes.showInputMessage,prompt:this._dataValidations[t].attributes.prompt,promptTitle:this._dataValidations[t].attributes.promptTitle,showErrorMessage:this._dataValidations[t].attributes.showErrorMessage,error:this._dataValidations[t].attributes.error,errorTitle:this._dataValidations[t].attributes.errorTitle,operator:this._dataValidations[t].attributes.operator,formula1:this._dataValidations[t].children[0].children[0],formula2:this._dataValidations[t].children[1]?this._dataValidations[t].children[1].children[0]:void 0}:!1).case(["string","boolean"],(t,e)=>{if(this._dataValidations[t]){if(e===!1)return delete this._dataValidations[t]}else return!1}).case(["string","*"],(t,e)=>(typeof e=="string"?this._dataValidations[t]={name:"dataValidation",attributes:{type:"list",allowBlank:!1,showInputMessage:!1,prompt:"",promptTitle:"",showErrorMessage:!1,error:"",errorTitle:"",operator:"",sqref:t},children:[{name:"formula1",atrributes:{},children:[e]},{name:"formula2",atrributes:{},children:[""]}]}:typeof e=="object"&&(this._dataValidations[t]={name:"dataValidation",attributes:{type:e.type?e.type:"list",allowBlank:e.allowBlank,showInputMessage:e.showInputMessage,prompt:e.prompt,promptTitle:e.promptTitle,showErrorMessage:e.showErrorMessage,error:e.error,errorTitle:e.errorTitle,operator:e.operator,sqref:t},children:[{name:"formula1",atrributes:{},children:[e.formula1]},{name:"formula2",atrributes:{},children:[e.formula2]}]}),this)).handle(arguments)}toXmls(){const t=Dt.clone(this._node);if(t.children=t.children.slice(),this._colsNode.children=Dt.filter(this._colNodes,(e,n)=>e&&n===e.attributes.min&&Object.keys(e.attributes).length>2),this._colsNode.children.length&&Tt.insertInOrder(t,this._colsNode,re),this._hyperlinksNode.children=Dt.values(this._hyperlinks),this._hyperlinksNode.children.length&&Tt.insertInOrder(t,this._hyperlinksNode,re),this._printOptionsNode&&Object.keys(this._printOptionsNode.attributes).length&&Tt.insertInOrder(t,this._printOptionsNode,re),this._pageMarginsNode&&this._pageMarginsPresetName){const e=Dt.clone(this._pageMarginsNode);Object.keys(this._pageMarginsNode.attributes).length?e.attributes=Dt.assign(this._pageMarginsPresets[this._pageMarginsPresetName],this._pageMarginsNode.attributes):e.attributes=this._pageMarginsPresets[this._pageMarginsPresetName],Tt.insertInOrder(t,e,re)}return this._mergeCellsNode.children=Dt.values(this._mergeCells),this._mergeCellsNode.children.length&&Tt.insertInOrder(t,this._mergeCellsNode,re),this._dataValidationsNode.children=Dt.values(this._dataValidations),this._dataValidationsNode.children.length&&Tt.insertInOrder(t,this._dataValidationsNode,re),this._autoFilter&&Tt.insertInOrder(t,{name:"autoFilter",children:[],attributes:{ref:this._autoFilter.address()}},re),["colBreaks","rowBreaks"].forEach(e=>{const n=this[`_${e}Node`];n.attributes.count&&Tt.insertInOrder(t,n,re)}),{id:this._idNode,sheet:t,relationships:this._relationships}}updateMaxSharedFormulaId(t){t>this._maxSharedFormulaId&&(this._maxSharedFormulaId=t)}printOptions(){const t=["gridLines","gridLinesSet","headings","horizontalCentered","verticalCentered"],e=this._getCheckAttributeNameHelper("printOptions",t);return new zt("Sheet.printOptions").case(["string"],n=>(e(n),this._printOptionsNode.attributes[n]===1)).case(["string","nil"],n=>(e(n),delete this._printOptionsNode.attributes[n],this)).case(["string","boolean"],(n,s)=>(e(n),s?(this._printOptionsNode.attributes[n]=1,this):this.printOptions(n,void 0))).handle(arguments)}printGridLines(){return new zt("Sheet.gridLines").case(()=>this.printOptions("gridLines")&&this.printOptions("gridLinesSet")).case(["nil"],()=>(this.printOptions("gridLines",void 0),this.printOptions("gridLinesSet",void 0),this)).case(["boolean"],t=>(this.printOptions("gridLines",t),this.printOptions("gridLinesSet",t),this)).handle(arguments)}pageMargins(){if(this.pageMarginsPreset()===void 0)throw new Error("Sheet.pageMargins: preset is undefined.");const t=["left","right","top","bottom","header","footer"],e=this._getCheckAttributeNameHelper("pageMargins",t),n=this._getCheckRangeHelper("pageMargins",0,void 0);return new zt("Sheet.pageMargins").case(["string"],s=>{e(s);const o=this._pageMarginsNode.attributes[s];return o!==void 0?parseFloat(o):this._pageMarginsPresetName?parseFloat(this._pageMarginsPresets[this._pageMarginsPresetName][s]):void 0}).case(["string","nil"],s=>(e(s),delete this._pageMarginsNode.attributes[s],this)).case(["string","number"],(s,o)=>(e(s),n(o),this._pageMarginsNode.attributes[s]=o,this)).case(["string","string"],(s,o)=>this.pageMargins(s,parseFloat(o))).handle(arguments)}pageMarginsPreset(){return new zt("Sheet.pageMarginsPreset").case(()=>this._pageMarginsPresetName).case(["nil"],()=>(this._pageMarginsPresetName=void 0,this._pageMarginsNode.attributes={},this)).case(["string"],t=>(this._getCheckAttributeNameHelper("pageMarginsPreset",Object.keys(this._pageMarginsPresets))(t),this._pageMarginsPresetName=t,this._pageMarginsNode.attributes={},this)).case(["string","object"],(t,e)=>{if(this._pageMarginsPresets.hasOwnProperty(t))throw new Error(`Sheet.pageMarginsPreset: The preset ${t} already exists!`);const n=["left","right","top","bottom","header","footer"];if(Dt.isEqual(Dt.sortBy(n),Dt.sortBy(Object.keys(e)))===!1)throw new Error(`Sheet.pageMarginsPreset: Invalid preset attributes for one or key(s)! - "${Object.keys(e)}"`);return Dt.forEach((o,l)=>{const a=parseFloat(o);if(Dt.isNaN(a)||Dt.isNumber(a)===!1)throw new Error(`Sheet.pageMarginsPreset: Invalid preset attribute value! - "${o}"`)}),this._pageMarginsPresetName=t,this._pageMarginsNode.attributes={},this._pageMarginsPresets[t]=e,this}).handle(arguments)}panes(){const t=["split","frozen","frozenSplit"],e=["bottomLeft","bottomRight","topLeft","topRight"],n=this._getCheckAttributeNameHelper("pane.state",t),s=this._getCheckAttributeNameHelper("pane.activePane",e),o=this._getOrCreateSheetViewNode();let l=Tt.findChild(o,"pane");return new zt("Sheet.pane").case(()=>{if(l){const a=Dt.cloneDeep(l.attributes);return a.state||(a.state="split"),a}}).case(["nil"],()=>(Tt.removeChild(o,"pane"),this)).case(["object"],a=>{const d=Dt.assign({activePane:"bottomRight"},a);return n(d.state),s(d.activePane),l?l.attributes=d:(l={name:"pane",attributes:d,children:[]},Tt.appendChild(o,l)),this}).handle(arguments)}freezePanes(){return new zt("Sheet.feezePanes").case(["integer","integer"],(t,e)=>{const n=xe.columnNumberToName(t+1)+(e+1);let s=t===0?"bottomLeft":"bottomRight";return s=e===0?"topRight":s,this.panes({state:"frozen",topLeftCell:n,xSplit:t,ySplit:e,activePane:s})}).case(["string"],t=>{const e=xe.fromAddress(t),n=e.columnNumber-1,s=e.rowNumber-1;let o=n===0?"bottomLeft":"bottomRight";return o=s===0?"topRight":o,this.panes({state:"frozen",topLeftCell:t,xSplit:n,ySplit:s,activePane:o})}).handle(arguments)}splitPanes(t,e){return this.panes({state:"split",xSplit:t,ySplit:e})}resetPanes(){return this.panes(null)}_getCheckAttributeNameHelper(t,e){return n=>{if(!Dt.includes(e,n))throw new Error(`Sheet.${t}: "${n}" is not supported.`)}}_getCheckTypeHelper(t,e){return n=>{if(typeof n!==e)throw new TypeError(`Sheet.${t}: invalid type - value must be of type ${e}.`)}}_getCheckRangeHelper(t,e,n){const s=this._getCheckTypeHelper(t,"number");return o=>{if(s(o),e!==void 0&&o<e)throw new RangeError(`Sheet.${t}: value too small - value must be greater than or equal to ${e}.`);if(n!==void 0&&n<=o)throw new RangeError(`Sheet.${t}: value too large - value must be less than ${n}.`)}}_getOrCreateSheetViewNode(){let t=Tt.findChild(this._node,"sheetViews");return t||(t={name:"sheetViews",attributes:{},children:[{name:"sheetView",attributes:{workbookViewId:0},children:[]}]},Tt.insertInOrder(this._node,t,re)),Tt.findChild(t,"sheetView")}_init(t,e,n,s){n||(n={name:"worksheet",attributes:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},children:[{name:"sheetData",attributes:{},children:[]}]}),this._workbook=t,this._idNode=e,this._node=n,this._maxSharedFormulaId=-1,this._mergeCells={},this._dataValidations={},this._hyperlinks={},this._autoFilter=null,this._relationships=new is(s),Tt.removeChild(this._node,"dimension"),this._rows=[],this._sheetDataNode=Tt.findChild(this._node,"sheetData"),this._sheetDataNode.children.forEach(d=>{const N=new Yr(this,d);this._rows[N.rowNumber()]=N}),this._sheetDataNode.children=this._rows,this._columns=[],this._colsNode=Tt.findChild(this._node,"cols"),this._colsNode?Tt.removeChild(this._node,this._colsNode):this._colsNode={name:"cols",attributes:{},children:[]},this._colNodes=[],Dt.forEach(this._colsNode.children,d=>{const N=d.attributes.min,S=d.attributes.max;for(let I=N;I<=S;I++)this._colNodes[I]=d}),this._sheetPrNode=Tt.findChild(this._node,"sheetPr"),this._sheetPrNode||(this._sheetPrNode={name:"sheetPr",attributes:{},children:[]},Tt.insertInOrder(this._node,this._sheetPrNode,re)),this._mergeCellsNode=Tt.findChild(this._node,"mergeCells"),this._mergeCellsNode?Tt.removeChild(this._node,this._mergeCellsNode):this._mergeCellsNode={name:"mergeCells",attributes:{},children:[]};const o=this._mergeCellsNode.children;this._mergeCellsNode.children=[],o.forEach(d=>{this._mergeCells[d.attributes.ref]=d}),this._dataValidationsNode=Tt.findChild(this._node,"dataValidations"),this._dataValidationsNode?Tt.removeChild(this._node,this._dataValidationsNode):this._dataValidationsNode={name:"dataValidations",attributes:{},children:[]};const l=this._dataValidationsNode.children;this._dataValidationsNode.children=[],l.forEach(d=>{this._dataValidations[d.attributes.sqref]=d}),this._hyperlinksNode=Tt.findChild(this._node,"hyperlinks"),this._hyperlinksNode?Tt.removeChild(this._node,this._hyperlinksNode):this._hyperlinksNode={name:"hyperlinks",attributes:{},children:[]};const a=this._hyperlinksNode.children;if(this._hyperlinksNode.children=[],a.forEach(d=>{this._hyperlinks[d.attributes.ref]=d}),this._printOptionsNode=Tt.findChild(this._node,"printOptions"),this._printOptionsNode?Tt.removeChild(this._node,this._printOptionsNode):this._printOptionsNode={name:"printOptions",attributes:{},children:[]},this._pageMarginsPresets={normal:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},wide:{left:1,right:1,top:1,bottom:1,header:.5,footer:.5},narrow:{left:.25,right:.25,top:.75,bottom:.75,header:.3,footer:.3}},this._pageMarginsNode=Tt.findChild(this._node,"pageMargins"),this._pageMarginsNode){this._pageMarginsPresetName="template";for(const d in this._pageMarginsPresets)if(Dt.isEqual(this._pageMarginsNode.attributes,this._pageMarginsPresets[d])){this._pageMarginsPresetName=d;break}this._pageMarginsPresetName==="template"&&(this._pageMarginsPresets.template=this._pageMarginsNode.attributes,this._pageMarginsNode.attributes={}),Tt.removeChild(this._node,this._pageMarginsNode)}else this._pageMarginsPresetName=void 0,this._pageMarginsNode={name:"pageMargins",attributes:{},children:[]};["colBreaks","rowBreaks"].forEach(d=>{this[`_${d}Node`]=Tt.findChild(this._node,d),this[`_${d}Node`]?Tt.removeChild(this._node,this[`_${d}Node`]):this[`_${d}Node`]={name:d,children:[],attributes:{count:0,manualBreakCount:0}}}),this._pageBreaks={colBreaks:new Qr(this._colBreaksNode),rowBreaks:new Qr(this._rowBreaksNode)}}};var os=as;const hs=Wt;let ls=class{constructor(t){this._node=t}add(t,e){const n={name:"Override",attributes:{PartName:t,ContentType:e}};return this._node.children.push(n),n}findByPartName(t){return hs.find(this._node.children,e=>e.attributes.PartName===t)}toXml(){return this._node}};var us=ls;const Jr=me,cs=de;let fs=class{constructor(t){this._node=t}isSecure(t){return new cs("Range.formula").case(()=>{const e=Jr.findChild(this._node,"DocSecurity");return e?e.children[0]===1:!1}).case("boolean",e=>{const n=Jr.appendChildIfNotFound(this._node,"DocSecurity");return n.children=[e?1:0],this}).handle(arguments)}toXml(){return this._node}};var ds=fs;const _r={title:"dc:title",subject:"dc:subject",author:"dc:creator",creator:"dc:creator",description:"dc:description",keywords:"cp:keywords",category:"cp:category"};let ms=class{constructor(t){this._node=t,this._properties={}}set(t,e){const n=t.toLowerCase();if(typeof _r[n]>"u")throw new Error(`Unknown property name: "${t}"`);return this._properties[n]=e,this}get(t){const e=t.toLowerCase();if(typeof _r[e]>"u")throw new Error(`Unknown property name: "${t}"`);return this._properties[e]}toXml(){for(const t in this._properties)this._properties.hasOwnProperty(t)&&this._node.children.push({name:_r[t],children:[this._properties[t]]});return this._node}};var ps=ms;const ti=Wt;let _s=class{constructor(t){this._stringArray=[],this._indexMap={},this._init(t),this._cacheExistingSharedStrings()}getIndexForString(t){const e=ti.isArray(t)?JSON.stringify(t):t;let n=this._indexMap[e];return n>=0||(n=this._stringArray.length,this._stringArray.push(t),this._indexMap[e]=n,this._node.children.push({name:"si",children:ti.isArray(t)?t:[{name:"t",attributes:{"xml:space":"preserve"},children:[t]}]})),n}getStringByIndex(t){return this._stringArray[t]}toXml(){return this._node}_cacheExistingSharedStrings(){this._node.children.forEach((t,e)=>{const n=t.children[0];if(n.name==="t"){const s=n.children[0];this._stringArray.push(s),this._indexMap[s]=e}else this._stringArray.push(t.children),this._indexMap[JSON.stringify(t.children)]=e})}_init(t){t||(t={name:"sst",attributes:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},children:[]}),this._node=t,delete this._node.attributes.count,delete this._node.attributes.uniqueCount}};var gs=_s;const Be=Wt,Qt=me,ws=vi,gr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},ys=164;let As=class{constructor(t){this._init(t),this._cacheNumberFormats()}createStyle(t){let e,n,s,o;if(t>=0){const l=this._cellXfsNode.children[t];if(o=Be.cloneDeep(l),l.attributes.applyFont){const a=l.attributes.fontId;e=Be.cloneDeep(this._fontsNode.children[a])}if(l.attributes.applyFill){const a=l.attributes.fillId;n=Be.cloneDeep(this._fillsNode.children[a])}if(l.attributes.applyBorder){const a=l.attributes.borderId;s=Be.cloneDeep(this._bordersNode.children[a])}}return e||(e={name:"font",attributes:{},children:[]}),this._fontsNode.children.push(e),n||(n={name:"fill",attributes:{},children:[]}),this._fillsNode.children.push(n),s||(s={name:"border",attributes:{},children:[]}),s.children=[Qt.findChild(s,"left")||{name:"left",attributes:{},children:[]},Qt.findChild(s,"right")||{name:"right",attributes:{},children:[]},Qt.findChild(s,"top")||{name:"top",attributes:{},children:[]},Qt.findChild(s,"bottom")||{name:"bottom",attributes:{},children:[]},Qt.findChild(s,"diagonal")||{name:"diagonal",attributes:{},children:[]}],this._bordersNode.children.push(s),o||(o={name:"xf",attributes:{},children:[]}),Be.assign(o.attributes,{fontId:this._fontsNode.children.length-1,fillId:this._fillsNode.children.length-1,borderId:this._bordersNode.children.length-1,applyFont:1,applyFill:1,applyBorder:1}),this._cellXfsNode.children.push(o),new ws(this,this._cellXfsNode.children.length-1,o,e,n,s)}getNumberFormatCode(t){return this._numberFormatCodesById[t]}getNumberFormatId(t){let e=this._numberFormatIdsByCode[t];return e===void 0&&(e=this._nextNumFormatId++,this._numberFormatCodesById[e]=t,this._numberFormatIdsByCode[t]=e,this._numFmtsNode.children.push({name:"numFmt",attributes:{numFmtId:e,formatCode:t}})),e}toXml(){return this._node}_cacheNumberFormats(){this._numberFormatCodesById={},this._numberFormatIdsByCode={};for(const t in gr){if(!gr.hasOwnProperty(t))continue;const e=gr[t];this._numberFormatCodesById[t]=e,this._numberFormatIdsByCode[e]=parseInt(t)}this._nextNumFormatId=ys,this._numFmtsNode.children.forEach(t=>{const e=t.attributes.numFmtId,n=t.attributes.formatCode;this._numberFormatCodesById[e]=n,this._numberFormatIdsByCode[n]=e,e>=this._nextNumFormatId&&(this._nextNumFormatId=e+1)})}_init(t){this._node=t,this._numFmtsNode=Qt.findChild(this._node,"numFmts"),this._fontsNode=Qt.findChild(this._node,"fonts"),this._fillsNode=Qt.findChild(this._node,"fills"),this._bordersNode=Qt.findChild(this._node,"borders"),this._cellXfsNode=Qt.findChild(this._node,"cellXfs"),this._numFmtsNode||(this._numFmtsNode={name:"numFmts",attributes:{},children:[]},Qt.insertBefore(this._node,this._numFmtsNode,this._fontsNode)),delete this._numFmtsNode.attributes.count,delete this._fontsNode.attributes.count,delete this._fillsNode.attributes.count,delete this._bordersNode.attributes.count,delete this._cellXfsNode.attributes.count}};var vs=As,Ei={exports:{}};(function(H){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function e(P){for(var J="",G=0,ut=0,L=0,W=0,wt=0,mt=0,ht=0,Ft=0;Ft<P.length;)G=P.charCodeAt(Ft++),W=G>>2,ut=P.charCodeAt(Ft++),wt=(G&3)<<4|ut>>4,L=P.charCodeAt(Ft++),mt=(ut&15)<<2|L>>6,ht=L&63,isNaN(ut)?mt=ht=64:isNaN(L)&&(ht=64),J+=t.charAt(W)+t.charAt(wt)+t.charAt(mt)+t.charAt(ht);return J}function n(P){var J="",G=0,ut=0,L=0,W=0,wt=0,mt=0,ht=0;P=P.replace(/[^\w\+\/\=]/g,"");for(var Ft=0;Ft<P.length;)W=t.indexOf(P.charAt(Ft++)),wt=t.indexOf(P.charAt(Ft++)),G=W<<2|wt>>4,J+=String.fromCharCode(G),mt=t.indexOf(P.charAt(Ft++)),ut=(wt&15)<<4|mt>>2,mt!==64&&(J+=String.fromCharCode(ut)),ht=t.indexOf(P.charAt(Ft++)),L=(mt&3)<<6|ht,ht!==64&&(J+=String.fromCharCode(L));return J}var s=function(){return typeof _t<"u"&&typeof fe<"u"&&typeof fe.versions<"u"&&!!fe.versions.node}(),o=function(){if(typeof _t<"u"){var P=!_t.from;if(!P)try{_t.from("foo","utf8")}catch{P=!0}return P?function(J,G){return G?new _t(J,G):new _t(J)}:_t.from.bind(_t)}return function(){}}();function l(P){if(s){if(_t.alloc)return _t.alloc(P);var J=new _t(P);return J.fill(0),J}return typeof Uint8Array<"u"?new Uint8Array(P):new Array(P)}function a(P){return s?_t.allocUnsafe?_t.allocUnsafe(P):new _t(P):typeof Uint8Array<"u"?new Uint8Array(P):new Array(P)}var d=function(J){return s?o(J,"binary"):J.split("").map(function(G){return G.charCodeAt(0)&255})},N=/\u0000/g,S=/[\u0001-\u0006]/g,I=function(P){for(var J=[],G=0;G<P[0].length;++G)J.push.apply(J,P[0][G]);return J},D=I,_=function(P,J,G){for(var ut=[],L=J;L<G;L+=2)ut.push(String.fromCharCode(V(P,L)));return ut.join("").replace(N,"")},v=_,g=function(P,J,G){for(var ut=[],L=J;L<J+G;++L)ut.push(("0"+P[L].toString(16)).slice(-2));return ut.join("")},E=g,f=function(P){if(Array.isArray(P[0]))return[].concat.apply([],P);var J=0,G=0;for(G=0;G<P.length;++G)J+=P[G].length;var ut=new Uint8Array(J);for(G=0,J=0;G<P.length;J+=P[G].length,++G)ut.set(P[G],J);return ut},A=f;s&&(_=function(P,J,G){return _t.isBuffer(P)?P.toString("utf16le",J,G).replace(N,""):v(P,J,G)},g=function(P,J,G){return _t.isBuffer(P)?P.toString("hex",J,J+G):E(P,J,G)},I=function(P){return P[0].length>0&&_t.isBuffer(P[0][0])?_t.concat(P[0]):D(P)},d=function(P){return o(P,"binary")},A=function(P){return _t.isBuffer(P[0])?_t.concat(P):f(P)});var O=function(P,J){return P[J]},V=function(P,J){return P[J+1]*256+P[J]},M=function(P,J){var G=P[J+1]*256+P[J];return G<32768?G:(65535-G+1)*-1},at=function(P,J){return P[J+3]*(1<<24)+(P[J+2]<<16)+(P[J+1]<<8)+P[J]},Q=function(P,J){return(P[J+3]<<24)+(P[J+2]<<16)+(P[J+1]<<8)+P[J]};function ot(P,J){var G,ut,L=0;switch(P){case 1:G=O(this,this.l);break;case 2:G=(J!=="i"?V:M)(this,this.l);break;case 4:G=Q(this,this.l);break;case 16:L=2,ut=g(this,this.l,P)}return this.l+=P,L===0?G:ut}var k=function(P,J,G){P[G]=J&255,P[G+1]=J>>>8&255,P[G+2]=J>>>16&255,P[G+3]=J>>>24&255},ct=function(P,J,G){P[G]=J&255,P[G+1]=J>>8&255,P[G+2]=J>>16&255,P[G+3]=J>>24&255};function vt(P,J,G){var ut=0,L=0;switch(G){case"hex":for(;L<P;++L)this[this.l++]=parseInt(J.slice(2*L,2*L+2),16)||0;return this;case"utf16le":var W=this.l+P;for(L=0;L<Math.min(J.length,P);++L){var wt=J.charCodeAt(L);this[this.l++]=wt&255,this[this.l++]=wt>>8}for(;this.l<W;)this[this.l++]=0;return this}switch(P){case 1:ut=1,this[this.l]=J&255;break;case 2:ut=2,this[this.l]=J&255,J>>>=8,this[this.l+1]=J&255;break;case 4:ut=4,k(this,J,this.l);break;case-4:ut=4,ct(this,J,this.l);break}return this.l+=ut,this}function U(P,J){var G=g(this,this.l,P.length>>1);if(G!==P)throw new Error(J+"Expected "+P+" saw "+G);this.l+=P.length>>1}function tt(P,J){P.l=J,P.read_shift=ot,P.chk=U,P.write_shift=vt}function p(P){var J=l(P);return tt(J,0),J}/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var st=function(){var P={};P.version="1.2.1";function J(){for(var y=0,z=new Array(256),x=0;x!=256;++x)y=x,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,z[x]=y;return typeof Int32Array<"u"?new Int32Array(z):z}var G=J();function ut(y){var z=0,x=0,Z=0,it=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)it[Z]=y[Z];for(Z=0;Z!=256;++Z)for(x=y[Z],z=256+Z;z<4096;z+=256)x=it[z]=x>>>8^y[x&255];var rt=[];for(Z=1;Z!=16;++Z)rt[Z-1]=typeof Int32Array<"u"?it.subarray(Z*256,Z*256+256):it.slice(Z*256,Z*256+256);return rt}var L=ut(G),W=L[0],wt=L[1],mt=L[2],ht=L[3],Ft=L[4],b=L[5],m=L[6],Y=L[7],j=L[8],bt=L[9],St=L[10],Nt=L[11],h=L[12],et=L[13],c=L[14];function r(y,z){for(var x=z^-1,Z=0,it=y.length;Z<it;)x=x>>>8^G[(x^y.charCodeAt(Z++))&255];return~x}function i(y,z){for(var x=z^-1,Z=y.length-15,it=0;it<Z;)x=c[y[it++]^x&255]^et[y[it++]^x>>8&255]^h[y[it++]^x>>16&255]^Nt[y[it++]^x>>>24]^St[y[it++]]^bt[y[it++]]^j[y[it++]]^Y[y[it++]]^m[y[it++]]^b[y[it++]]^Ft[y[it++]]^ht[y[it++]]^mt[y[it++]]^wt[y[it++]]^W[y[it++]]^G[y[it++]];for(Z+=15;it<Z;)x=x>>>8^G[(x^y[it++])&255];return~x}function u(y,z){for(var x=z^-1,Z=0,it=y.length,rt=0,ft=0;Z<it;)rt=y.charCodeAt(Z++),rt<128?x=x>>>8^G[(x^rt)&255]:rt<2048?(x=x>>>8^G[(x^(192|rt>>6&31))&255],x=x>>>8^G[(x^(128|rt&63))&255]):rt>=55296&&rt<57344?(rt=(rt&1023)+64,ft=y.charCodeAt(Z++)&1023,x=x>>>8^G[(x^(240|rt>>8&7))&255],x=x>>>8^G[(x^(128|rt>>2&63))&255],x=x>>>8^G[(x^(128|ft>>6&15|(rt&3)<<4))&255],x=x>>>8^G[(x^(128|ft&63))&255]):(x=x>>>8^G[(x^(224|rt>>12&15))&255],x=x>>>8^G[(x^(128|rt>>6&63))&255],x=x>>>8^G[(x^(128|rt&63))&255]);return~x}return P.table=G,P.bstr=r,P.buf=i,P.str=u,P}(),xt=function(){var J={};J.version="1.2.2";function G(w,T){for(var C=w.split("/"),F=T.split("/"),B=0,R=0,$=Math.min(C.length,F.length);B<$;++B){if(R=C[B].length-F[B].length)return R;if(C[B]!=F[B])return C[B]<F[B]?-1:1}return C.length-F.length}function ut(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:ut(w.slice(0,-1));var T=w.lastIndexOf("/");return T===-1?w:w.slice(0,T+1)}function L(w){if(w.charAt(w.length-1)=="/")return L(w.slice(0,-1));var T=w.lastIndexOf("/");return T===-1?w:w.slice(T+1)}function W(w,T){typeof T=="string"&&(T=new Date(T));var C=T.getHours();C=C<<6|T.getMinutes(),C=C<<5|T.getSeconds()>>>1,w.write_shift(2,C);var F=T.getFullYear()-1980;F=F<<4|T.getMonth()+1,F=F<<5|T.getDate(),w.write_shift(2,F)}function wt(w){var T=w.read_shift(2)&65535,C=w.read_shift(2)&65535,F=new Date,B=C&31;C>>>=5;var R=C&15;C>>>=4,F.setMilliseconds(0),F.setFullYear(C+1980),F.setMonth(R-1),F.setDate(B);var $=T&31;T>>>=5;var nt=T&63;return T>>>=6,F.setHours(T),F.setMinutes(nt),F.setSeconds($<<1),F}function mt(w){tt(w,0);for(var T={},C=0;w.l<=w.length-4;){var F=w.read_shift(2),B=w.read_shift(2),R=w.l+B,$={};switch(F){case 21589:C=w.read_shift(1),C&1&&($.mtime=w.read_shift(4)),B>5&&(C&2&&($.atime=w.read_shift(4)),C&4&&($.ctime=w.read_shift(4))),$.mtime&&($.mt=new Date($.mtime*1e3));break}w.l=R,T[F]=$}return T}var ht;function Ft(){return ht||(ht=Ye)}function b(w,T){if(w[0]==80&&w[1]==75)return Or(w,T);if((w[0]|32)==109&&(w[1]|32)==105)return Gi(w,T);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var C=3,F=512,B=0,R=0,$=0,nt=0,X=0,K=[],q=w.slice(0,512);tt(q,0);var lt=m(q);switch(C=lt[0],C){case 3:F=512;break;case 4:F=4096;break;case 0:if(lt[1]==0)return Or(w,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}F!==512&&(q=w.slice(0,F),tt(q,28));var pt=w.slice(0,F);Y(q,C);var yt=q.read_shift(4,"i");if(C===3&&yt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+yt);q.l+=4,$=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),nt=q.read_shift(4,"i"),B=q.read_shift(4,"i"),X=q.read_shift(4,"i"),R=q.read_shift(4,"i");for(var dt=-1,gt=0;gt<109&&(dt=q.read_shift(4,"i"),!(dt<0));++gt)K[gt]=dt;var Et=j(w,F);Nt(X,R,Et,F,K);var Ot=et(Et,$,K,F);Ot[$].name="!Directory",B>0&&nt!==ft&&(Ot[nt].name="!MiniFAT"),Ot[K[0]].name="!FAT",Ot.fat_addrs=K,Ot.ssz=F;var Rt={},Gt=[],ke=[],Se=[];c($,Ot,Et,Gt,B,Rt,ke,nt),bt(ke,Se,Gt),Gt.shift();var Ie={FileIndex:ke,FullPaths:Se};return T&&T.raw&&(Ie.raw={header:pt,sectors:Et}),Ie}function m(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(Ct,"Header Signature: "),w.l+=16;var T=w.read_shift(2,"u");return[w.read_shift(2,"u"),T]}function Y(w,T){var C=9;switch(w.l+=2,C=w.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function j(w,T){for(var C=Math.ceil(w.length/T)-1,F=[],B=1;B<C;++B)F[B-1]=w.slice(B*T,(B+1)*T);return F[C-1]=w.slice(C*T),F}function bt(w,T,C){for(var F=0,B=0,R=0,$=0,nt=0,X=C.length,K=[],q=[];F<X;++F)K[F]=q[F]=F,T[F]=C[F];for(;nt<q.length;++nt)F=q[nt],B=w[F].L,R=w[F].R,$=w[F].C,K[F]===F&&(B!==-1&&K[B]!==B&&(K[F]=K[B]),R!==-1&&K[R]!==R&&(K[F]=K[R])),$!==-1&&(K[$]=F),B!==-1&&F!=K[F]&&(K[B]=K[F],q.lastIndexOf(B)<nt&&q.push(B)),R!==-1&&F!=K[F]&&(K[R]=K[F],q.lastIndexOf(R)<nt&&q.push(R));for(F=1;F<X;++F)K[F]===F&&(R!==-1&&K[R]!==R?K[F]=K[R]:B!==-1&&K[B]!==B&&(K[F]=K[B]));for(F=1;F<X;++F)if(w[F].type!==0){if(nt=F,nt!=K[nt])do nt=K[nt],T[F]=T[nt]+"/"+T[F];while(nt!==0&&K[nt]!==-1&&nt!=K[nt]);K[F]=-1}for(T[0]+="/",F=1;F<X;++F)w[F].type!==2&&(T[F]+="/")}function St(w,T,C){for(var F=w.start,B=w.size,R=[],$=F;C&&B>0&&$>=0;)R.push(T.slice($*rt,$*rt+rt)),B-=rt,$=Q(C,$*4);return R.length===0?p(0):A(R).slice(0,w.size)}function Nt(w,T,C,F,B){var R=ft;if(w===ft){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var $=C[w],nt=(F>>>2)-1;if(!$)return;for(var X=0;X<nt&&(R=Q($,X*4))!==ft;++X)B.push(R);T>=1&&Nt(Q($,F-4),T-1,C,F,B)}}function h(w,T,C,F,B){var R=[],$=[];B||(B=[]);var nt=F-1,X=0,K=0;for(X=T;X>=0;){B[X]=!0,R[R.length]=X,$.push(w[X]);var q=C[Math.floor(X*4/F)];if(K=X*4&nt,F<4+K)throw new Error("FAT boundary crossed: "+X+" 4 "+F);if(!w[q])break;X=Q(w[q],K)}return{nodes:R,data:I([$])}}function et(w,T,C,F){var B=w.length,R=[],$=[],nt=[],X=[],K=F-1,q=0,lt=0,pt=0,yt=0;for(q=0;q<B;++q)if(nt=[],pt=q+T,pt>=B&&(pt-=B),!$[pt]){X=[];var dt=[];for(lt=pt;lt>=0;){dt[lt]=!0,$[lt]=!0,nt[nt.length]=lt,X.push(w[lt]);var gt=C[Math.floor(lt*4/F)];if(yt=lt*4&K,F<4+yt)throw new Error("FAT boundary crossed: "+lt+" 4 "+F);if(!w[gt]||(lt=Q(w[gt],yt),dt[lt]))break}R[pt]={nodes:nt,data:I([X])}}return R}function c(w,T,C,F,B,R,$,nt){for(var X=0,K=F.length?2:0,q=T[w].data,lt=0,pt=0,yt;lt<q.length;lt+=128){var dt=q.slice(lt,lt+128);tt(dt,64),pt=dt.read_shift(2),yt=_(dt,0,pt-K),F.push(yt);var gt={name:yt,type:dt.read_shift(1),color:dt.read_shift(1),L:dt.read_shift(4,"i"),R:dt.read_shift(4,"i"),C:dt.read_shift(4,"i"),clsid:dt.read_shift(16),state:dt.read_shift(4,"i"),start:0,size:0},Et=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Et!==0&&(gt.ct=r(dt,dt.l-8));var Ot=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Ot!==0&&(gt.mt=r(dt,dt.l-8)),gt.start=dt.read_shift(4,"i"),gt.size=dt.read_shift(4,"i"),gt.size<0&&gt.start<0&&(gt.size=gt.type=0,gt.start=ft,gt.name=""),gt.type===5?(X=gt.start,B>0&&X!==ft&&(T[X].name="!StreamData")):gt.size>=4096?(gt.storage="fat",T[gt.start]===void 0&&(T[gt.start]=h(C,gt.start,T.fat_addrs,T.ssz)),T[gt.start].name=gt.name,gt.content=T[gt.start].data.slice(0,gt.size)):(gt.storage="minifat",gt.size<0?gt.size=0:X!==ft&&gt.start!==ft&&T[X]&&(gt.content=St(gt,T[X].data,(T[nt]||{}).data))),gt.content&&tt(gt.content,0),R[yt]=gt,$.push(gt)}}function r(w,T){return new Date((at(w,T+4)/1e7*Math.pow(2,32)+at(w,T)/1e7-11644473600)*1e3)}function i(w,T){return Ft(),b(ht.readFileSync(w),T)}function u(w,T){var C=T&&T.type;switch(C||s&&_t.isBuffer(w)&&(C="buffer"),C||"base64"){case"file":return i(w,T);case"base64":return b(d(n(w)),T);case"binary":return b(d(w),T)}return b(w,T)}function y(w,T){var C=T||{},F=C.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=F+"/",w.FileIndex[0]={name:F,type:5}),C.CLSID&&(w.FileIndex[0].clsid=C.CLSID),z(w)}function z(w){var T="Sh33tJ5";if(!xt.find(w,"/"+T)){var C=p(4);C[0]=55,C[1]=C[3]=50,C[2]=54,w.FileIndex.push({name:T,type:2,content:C,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+T),x(w)}}function x(w,T){y(w);for(var C=!1,F=!1,B=w.FullPaths.length-1;B>=0;--B){var R=w.FileIndex[B];switch(R.type){case 0:F?C=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(R.R*R.L*R.C)&&(C=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!T)){var $=new Date(1987,1,19),nt=0,X=Object.create?Object.create(null):{},K=[];for(B=0;B<w.FullPaths.length;++B)X[w.FullPaths[B]]=!0,w.FileIndex[B].type!==0&&K.push([w.FullPaths[B],w.FileIndex[B]]);for(B=0;B<K.length;++B){var q=ut(K[B][0]);for(F=X[q];!F;){for(;ut(q)&&!X[ut(q)];)q=ut(q);K.push([q,{name:L(q).replace("/",""),type:1,clsid:Lt,ct:$,mt:$,content:null}]),X[q]=!0,q=ut(K[B][0]),F=X[q]}}for(K.sort(function(yt,dt){return G(yt[0],dt[0])}),w.FullPaths=[],w.FileIndex=[],B=0;B<K.length;++B)w.FullPaths[B]=K[B][0],w.FileIndex[B]=K[B][1];for(B=0;B<K.length;++B){var lt=w.FileIndex[B],pt=w.FullPaths[B];if(lt.name=L(pt).replace("/",""),lt.L=lt.R=lt.C=-(lt.color=1),lt.size=lt.content?lt.content.length:0,lt.start=0,lt.clsid=lt.clsid||Lt,B===0)lt.C=K.length>1?1:-1,lt.size=0,lt.type=5;else if(pt.slice(-1)=="/"){for(nt=B+1;nt<K.length&&ut(w.FullPaths[nt])!=pt;++nt);for(lt.C=nt>=K.length?-1:nt,nt=B+1;nt<K.length&&ut(w.FullPaths[nt])!=ut(pt);++nt);lt.R=nt>=K.length?-1:nt,lt.type=1}else ut(w.FullPaths[B+1]||"")==ut(pt)&&(lt.R=B+1),lt.type=2}}}function Z(w,T){var C=T||{};if(C.fileType=="mad")return Xi(w,C);switch(x(w),C.fileType){case"zip":return Li(w,C)}var F=function(yt){for(var dt=0,gt=0,Et=0;Et<yt.FileIndex.length;++Et){var Ot=yt.FileIndex[Et];if(Ot.content){var Rt=Ot.content.length;Rt>0&&(Rt<4096?dt+=Rt+63>>6:gt+=Rt+511>>9)}}for(var Gt=yt.FullPaths.length+3>>2,ke=dt+7>>3,Se=dt+127>>7,Ie=ke+gt+Gt+Se,_e=Ie+127>>7,or=_e<=109?0:Math.ceil((_e-109)/127);Ie+_e+or+127>>7>_e;)or=++_e<=109?0:Math.ceil((_e-109)/127);var ne=[1,or,_e,Se,Gt,gt,dt,0];return yt.FileIndex[0].size=dt<<6,ne[7]=(yt.FileIndex[0].start=ne[0]+ne[1]+ne[2]+ne[3]+ne[4]+ne[5])+(ne[6]+7>>3),ne}(w),B=p(F[7]<<9),R=0,$=0;{for(R=0;R<8;++R)B.write_shift(1,kt[R]);for(R=0;R<8;++R)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),R=0;R<3;++R)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,F[2]),B.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:ft),B.write_shift(4,F[3]),B.write_shift(-4,F[1]?F[0]-1:ft),B.write_shift(4,F[1]),R=0;R<109;++R)B.write_shift(-4,R<F[2]?F[1]+R:-1)}if(F[1])for($=0;$<F[1];++$){for(;R<236+$*127;++R)B.write_shift(-4,R<F[2]?F[1]+R:-1);B.write_shift(-4,$===F[1]-1?ft:$+1)}var nt=function(yt){for($+=yt;R<$-1;++R)B.write_shift(-4,R+1);yt&&(++R,B.write_shift(-4,ft))};for($=R=0,$+=F[1];R<$;++R)B.write_shift(-4,Zt.DIFSECT);for($+=F[2];R<$;++R)B.write_shift(-4,Zt.FATSECT);nt(F[3]),nt(F[4]);for(var X=0,K=0,q=w.FileIndex[0];X<w.FileIndex.length;++X)q=w.FileIndex[X],q.content&&(K=q.content.length,!(K<4096)&&(q.start=$,nt(K+511>>9)));for(nt(F[6]+7>>3);B.l&511;)B.write_shift(-4,Zt.ENDOFCHAIN);for($=R=0,X=0;X<w.FileIndex.length;++X)q=w.FileIndex[X],q.content&&(K=q.content.length,!(!K||K>=4096)&&(q.start=$,nt(K+63>>6)));for(;B.l&511;)B.write_shift(-4,Zt.ENDOFCHAIN);for(R=0;R<F[4]<<2;++R){var lt=w.FullPaths[R];if(!lt||lt.length===0){for(X=0;X<17;++X)B.write_shift(4,0);for(X=0;X<3;++X)B.write_shift(4,-1);for(X=0;X<12;++X)B.write_shift(4,0);continue}q=w.FileIndex[R],R===0&&(q.start=q.size?q.start-1:ft);var pt=R===0&&C.root||q.name;if(pt.length>32&&(console.error("Name "+pt+" will be truncated to "+pt.slice(0,32)),pt=pt.slice(0,32)),K=2*(pt.length+1),B.write_shift(64,pt,"utf16le"),B.write_shift(2,K),B.write_shift(1,q.type),B.write_shift(1,q.color),B.write_shift(-4,q.L),B.write_shift(-4,q.R),B.write_shift(-4,q.C),q.clsid)B.write_shift(16,q.clsid,"hex");else for(X=0;X<4;++X)B.write_shift(4,0);B.write_shift(4,q.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,q.start),B.write_shift(4,q.size),B.write_shift(4,0)}for(R=1;R<w.FileIndex.length;++R)if(q=w.FileIndex[R],q.size>=4096)if(B.l=q.start+1<<9,s&&_t.isBuffer(q.content))q.content.copy(B,B.l,0,q.size),B.l+=q.size+511&-512;else{for(X=0;X<q.size;++X)B.write_shift(1,q.content[X]);for(;X&511;++X)B.write_shift(1,0)}for(R=1;R<w.FileIndex.length;++R)if(q=w.FileIndex[R],q.size>0&&q.size<4096)if(s&&_t.isBuffer(q.content))q.content.copy(B,B.l,0,q.size),B.l+=q.size+63&-64;else{for(X=0;X<q.size;++X)B.write_shift(1,q.content[X]);for(;X&63;++X)B.write_shift(1,0)}if(s)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function it(w,T){var C=w.FullPaths.map(function(X){return X.toUpperCase()}),F=C.map(function(X){var K=X.split("/");return K[K.length-(X.slice(-1)=="/"?2:1)]}),B=!1;T.charCodeAt(0)===47?(B=!0,T=C[0].slice(0,-1)+T):B=T.indexOf("/")!==-1;var R=T.toUpperCase(),$=B===!0?C.indexOf(R):F.indexOf(R);if($!==-1)return w.FileIndex[$];var nt=!R.match(S);for(R=R.replace(N,""),nt&&(R=R.replace(S,"!")),$=0;$<C.length;++$)if((nt?C[$].replace(S,"!"):C[$]).replace(N,"")==R||(nt?F[$].replace(S,"!"):F[$]).replace(N,"")==R)return w.FileIndex[$];return null}var rt=64,ft=-2,Ct="d0cf11e0a1b11ae1",kt=[208,207,17,224,161,177,26,225],Lt="00000000000000000000000000000000",Zt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ft,FREESECT:-1,HEADER_SIGNATURE:Ct,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Lt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function qt(w,T,C){Ft();var F=Z(w,C);ht.writeFileSync(T,F)}function Kt(w){for(var T=new Array(w.length),C=0;C<w.length;++C)T[C]=String.fromCharCode(w[C]);return T.join("")}function Pt(w,T){var C=Z(w,T);switch(T&&T.type||"buffer"){case"file":return Ft(),ht.writeFileSync(T.filename,C),C;case"binary":return typeof C=="string"?C:Kt(C);case"base64":return e(typeof C=="string"?C:Kt(C));case"buffer":if(s)return _t.isBuffer(C)?C:o(C);case"array":return typeof C=="string"?d(C):C}return C}var Jt;function Fe(w){try{var T=w.InflateRaw,C=new T;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)Jt=w;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function Yt(w,T){if(!Jt)return Dr(w,T);var C=Jt.InflateRaw,F=new C,B=F._processChunk(w.slice(w.l),F._finishFlushFlag);return w.l+=F.bytesRead,B}function Pe(w){return Jt?Jt.deflateRawSync(w):kr(w)}var tr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ue(w){var T=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(T>>16|T>>8|T)&255}for(var Ut=typeof Uint8Array<"u",$t=Ut?new Uint8Array(256):[],ze=0;ze<256;++ze)$t[ze]=Ue(ze);function Ti(w,T){var C=$t[w&255];return T<=8?C>>>8-T:(C=C<<8|$t[w>>8&255],T<=16?C>>>16-T:(C=C<<8|$t[w>>16&255],C>>>24-T))}function Bi(w,T){var C=T&7,F=T>>>3;return(w[F]|(C<=6?0:w[F+1]<<8))>>>C&3}function er(w,T){var C=T&7,F=T>>>3;return(w[F]|(C<=5?0:w[F+1]<<8))>>>C&7}function Ri(w,T){var C=T&7,F=T>>>3;return(w[F]|(C<=4?0:w[F+1]<<8))>>>C&15}function Cr(w,T){var C=T&7,F=T>>>3;return(w[F]|(C<=3?0:w[F+1]<<8))>>>C&31}function Nr(w,T){var C=T&7,F=T>>>3;return(w[F]|(C<=1?0:w[F+1]<<8))>>>C&127}function Le(w,T,C){var F=T&7,B=T>>>3,R=(1<<C)-1,$=w[B]>>>F;return C<8-F||($|=w[B+1]<<8-F,C<16-F)||($|=w[B+2]<<16-F,C<24-F)||($|=w[B+3]<<24-F),$&R}function Er(w,T,C){var F=T&7,B=T>>>3;return F<=5?w[B]|=(C&7)<<F:(w[B]|=C<<F&255,w[B+1]=(C&7)>>8-F),T+3}function Di(w,T,C){var F=T&7,B=T>>>3;return C=(C&1)<<F,w[B]|=C,T+1}function ve(w,T,C){var F=T&7,B=T>>>3;return C<<=F,w[B]|=C&255,C>>>=8,w[B+1]=C,T+8}function Fr(w,T,C){var F=T&7,B=T>>>3;return C<<=F,w[B]|=C&255,C>>>=8,w[B+1]=C&255,w[B+2]=C>>>8,T+16}function rr(w,T){var C=w.length,F=2*C>T?2*C:T+5,B=0;if(C>=T)return w;if(s){var R=a(F);if(w.copy)w.copy(R);else for(;B<w.length;++B)R[B]=w[B];return R}else if(Ut){var $=new Uint8Array(F);if($.set)$.set(w);else for(;B<C;++B)$[B]=w[B];return $}return w.length=F,w}function te(w){for(var T=new Array(w),C=0;C<w;++C)T[C]=0;return T}function Me(w,T,C){var F=1,B=0,R=0,$=0,nt=0,X=w.length,K=Ut?new Uint16Array(32):te(32);for(R=0;R<32;++R)K[R]=0;for(R=X;R<C;++R)w[R]=0;X=w.length;var q=Ut?new Uint16Array(X):te(X);for(R=0;R<X;++R)K[B=w[R]]++,F<B&&(F=B),q[R]=0;for(K[0]=0,R=1;R<=F;++R)K[R+16]=nt=nt+K[R-1]<<1;for(R=0;R<X;++R)nt=w[R],nt!=0&&(q[R]=K[nt+16]++);var lt=0;for(R=0;R<X;++R)if(lt=w[R],lt!=0)for(nt=Ti(q[R],F)>>F-lt,$=(1<<F+4-lt)-1;$>=0;--$)T[nt|$<<lt]=lt&15|R<<4;return F}var ir=Ut?new Uint16Array(512):te(512),nr=Ut?new Uint16Array(32):te(32);if(!Ut){for(var pe=0;pe<512;++pe)ir[pe]=0;for(pe=0;pe<32;++pe)nr[pe]=0}(function(){for(var w=[],T=0;T<32;T++)w.push(5);Me(w,nr,32);var C=[];for(T=0;T<=143;T++)C.push(8);for(;T<=255;T++)C.push(9);for(;T<=279;T++)C.push(7);for(;T<=287;T++)C.push(8);Me(C,ir,288)})();var Oi=function(){for(var T=Ut?new Uint8Array(32768):[],C=0,F=0;C<Ae.length-1;++C)for(;F<Ae[C+1];++F)T[F]=C;for(;F<32768;++F)T[F]=29;var B=Ut?new Uint8Array(259):[];for(C=0,F=0;C<ye.length-1;++C)for(;F<ye[C+1];++F)B[F]=C;function R(nt,X){for(var K=0;K<nt.length;){var q=Math.min(65535,nt.length-K),lt=K+q==nt.length;for(X.write_shift(1,+lt),X.write_shift(2,q),X.write_shift(2,~q&65535);q-- >0;)X[X.l++]=nt[K++]}return X.l}function $(nt,X){for(var K=0,q=0,lt=Ut?new Uint16Array(32768):[];q<nt.length;){var pt=Math.min(65535,nt.length-q);if(pt<10){for(K=Er(X,K,+(q+pt==nt.length)),K&7&&(K+=8-(K&7)),X.l=K/8|0,X.write_shift(2,pt),X.write_shift(2,~pt&65535);pt-- >0;)X[X.l++]=nt[q++];K=X.l*8;continue}K=Er(X,K,+(q+pt==nt.length)+2);for(var yt=0;pt-- >0;){var dt=nt[q];yt=(yt<<5^dt)&32767;var gt=-1,Et=0;if((gt=lt[yt])&&(gt|=q&-32768,gt>q&&(gt-=32768),gt<q))for(;nt[gt+Et]==nt[q+Et]&&Et<250;)++Et;if(Et>2){dt=B[Et],dt<=22?K=ve(X,K,$t[dt+1]>>1)-1:(ve(X,K,3),K+=5,ve(X,K,$t[dt-23]>>5),K+=3);var Ot=dt<8?0:dt-4>>2;Ot>0&&(Fr(X,K,Et-ye[dt]),K+=Ot),dt=T[q-gt],K=ve(X,K,$t[dt]>>3),K-=3;var Rt=dt<4?0:dt-2>>1;Rt>0&&(Fr(X,K,q-gt-Ae[dt]),K+=Rt);for(var Gt=0;Gt<Et;++Gt)lt[yt]=q&32767,yt=(yt<<5^nt[q])&32767,++q;pt-=Et-1}else dt<=143?dt=dt+48:K=Di(X,K,1),K=ve(X,K,$t[dt]),lt[yt]=q&32767,++q}K=ve(X,K,0)-1}return X.l=(K+7)/8|0,X.l}return function(X,K){return X.length<8?R(X,K):$(X,K)}}();function kr(w){var T=p(50+Math.floor(w.length*1.1)),C=Oi(w,T);return T.slice(0,C)}var Sr=Ut?new Uint16Array(32768):te(32768),Ir=Ut?new Uint16Array(32768):te(32768),Tr=Ut?new Uint16Array(128):te(128),Br=1,Rr=1;function Pi(w,T){var C=Cr(w,T)+257;T+=5;var F=Cr(w,T)+1;T+=5;var B=Ri(w,T)+4;T+=4;for(var R=0,$=Ut?new Uint8Array(19):te(19),nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,K=Ut?new Uint8Array(8):te(8),q=Ut?new Uint8Array(8):te(8),lt=$.length,pt=0;pt<B;++pt)$[tr[pt]]=R=er(w,T),X<R&&(X=R),K[R]++,T+=3;var yt=0;for(K[0]=0,pt=1;pt<=X;++pt)q[pt]=yt=yt+K[pt-1]<<1;for(pt=0;pt<lt;++pt)(yt=$[pt])!=0&&(nt[pt]=q[yt]++);var dt=0;for(pt=0;pt<lt;++pt)if(dt=$[pt],dt!=0){yt=$t[nt[pt]]>>8-dt;for(var gt=(1<<7-dt)-1;gt>=0;--gt)Tr[yt|gt<<dt]=dt&7|pt<<3}var Et=[];for(X=1;Et.length<C+F;)switch(yt=Tr[Nr(w,T)],T+=yt&7,yt>>>=3){case 16:for(R=3+Bi(w,T),T+=2,yt=Et[Et.length-1];R-- >0;)Et.push(yt);break;case 17:for(R=3+er(w,T),T+=3;R-- >0;)Et.push(0);break;case 18:for(R=11+Nr(w,T),T+=7;R-- >0;)Et.push(0);break;default:Et.push(yt),X<yt&&(X=yt);break}var Ot=Et.slice(0,C),Rt=Et.slice(C);for(pt=C;pt<286;++pt)Ot[pt]=0;for(pt=F;pt<30;++pt)Rt[pt]=0;return Br=Me(Ot,Sr,286),Rr=Me(Rt,Ir,30),T}function Ui(w,T){if(w[0]==3&&!(w[1]&3))return[l(T),2];for(var C=0,F=0,B=a(T||1<<18),R=0,$=B.length>>>0,nt=0,X=0;!(F&1);){if(F=er(w,C),C+=3,F>>>1)F>>1==1?(nt=9,X=5):(C=Pi(w,C),nt=Br,X=Rr);else{C&7&&(C+=8-(C&7));var K=w[C>>>3]|w[(C>>>3)+1]<<8;if(C+=32,K>0)for(!T&&$<R+K&&(B=rr(B,R+K),$=B.length);K-- >0;)B[R++]=w[C>>>3],C+=8;continue}for(;;){!T&&$<R+32767&&(B=rr(B,R+32767),$=B.length);var q=Le(w,C,nt),lt=F>>>1==1?ir[q]:Sr[q];if(C+=lt&15,lt>>>=4,!(lt>>>8&255))B[R++]=lt;else{if(lt==256)break;lt-=257;var pt=lt<8?0:lt-4>>2;pt>5&&(pt=0);var yt=R+ye[lt];pt>0&&(yt+=Le(w,C,pt),C+=pt),q=Le(w,C,X),lt=F>>>1==1?nr[q]:Ir[q],C+=lt&15,lt>>>=4;var dt=lt<4?0:lt-2>>1,gt=Ae[lt];for(dt>0&&(gt+=Le(w,C,dt),C+=dt),!T&&$<yt&&(B=rr(B,yt+100),$=B.length);R<yt;)B[R]=B[R-gt],++R}}}return T?[B,C+7>>>3]:[B.slice(0,R),C+7>>>3]}function Dr(w,T){var C=w.slice(w.l||0),F=Ui(C,T);return w.l+=F[1],F[0]}function sr(w,T){if(w)typeof console<"u"&&console.error(T);else throw new Error(T)}function Or(w,T){var C=w;tt(C,0);var F=[],B=[],R={FileIndex:F,FullPaths:B};y(R,{root:T.root});for(var $=C.length-4;(C[$]!=80||C[$+1]!=75||C[$+2]!=5||C[$+3]!=6)&&$>=0;)--$;C.l=$+4,C.l+=4;var nt=C.read_shift(2);C.l+=6;var X=C.read_shift(4);for(C.l=X,$=0;$<nt;++$){C.l+=20;var K=C.read_shift(4),q=C.read_shift(4),lt=C.read_shift(2),pt=C.read_shift(2),yt=C.read_shift(2);C.l+=8;var dt=C.read_shift(4),gt=mt(C.slice(C.l+lt,C.l+lt+pt));C.l+=lt+pt+yt;var Et=C.l;C.l=dt+4,zi(C,K,q,R,gt),C.l=Et}return R}function zi(w,T,C,F,B){w.l+=2;var R=w.read_shift(2),$=w.read_shift(2),nt=wt(w);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var X=w.read_shift(4),K=w.read_shift(4),q=w.read_shift(4),lt=w.read_shift(2),pt=w.read_shift(2),yt="",dt=0;dt<lt;++dt)yt+=String.fromCharCode(w[w.l++]);if(pt){var gt=mt(w.slice(w.l,w.l+pt));(gt[21589]||{}).mt&&(nt=gt[21589].mt),((B||{})[21589]||{}).mt&&(nt=B[21589].mt)}w.l+=pt;var Et=w.slice(w.l,w.l+K);switch($){case 8:Et=Yt(w,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+$)}var Ot=!1;R&8&&(X=w.read_shift(4),X==134695760&&(X=w.read_shift(4),Ot=!0),K=w.read_shift(4),q=w.read_shift(4)),K!=T&&sr(Ot,"Bad compressed size: "+T+" != "+K),q!=C&&sr(Ot,"Bad uncompressed size: "+C+" != "+q);var Rt=st.buf(Et,0);X>>0!=Rt>>0&&sr(Ot,"Bad CRC32 checksum: "+X+" != "+Rt),ar(F,yt,Et,{unsafe:!0,mt:nt})}function Li(w,T){var C=T||{},F=[],B=[],R=p(1),$=C.compression?8:0,nt=0,X=0,K=0,q=0,lt=0,pt=w.FullPaths[0],yt=pt,dt=w.FileIndex[0],gt=[],Et=0;for(X=1;X<w.FullPaths.length;++X)if(yt=w.FullPaths[X].slice(pt.length),dt=w.FileIndex[X],!(!dt.size||!dt.content||yt=="Sh33tJ5")){var Ot=q,Rt=p(yt.length);for(K=0;K<yt.length;++K)Rt.write_shift(1,yt.charCodeAt(K)&127);Rt=Rt.slice(0,Rt.l),gt[lt]=st.buf(dt.content,0);var Gt=dt.content;$==8&&(Gt=Pe(Gt)),R=p(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,nt),R.write_shift(2,$),dt.mt?W(R,dt.mt):R.write_shift(4,0),R.write_shift(-4,gt[lt]),R.write_shift(4,Gt.length),R.write_shift(4,dt.content.length),R.write_shift(2,Rt.length),R.write_shift(2,0),q+=R.length,F.push(R),q+=Rt.length,F.push(Rt),q+=Gt.length,F.push(Gt),R=p(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,nt),R.write_shift(2,$),R.write_shift(4,0),R.write_shift(-4,gt[lt]),R.write_shift(4,Gt.length),R.write_shift(4,dt.content.length),R.write_shift(2,Rt.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,Ot),Et+=R.l,B.push(R),Et+=Rt.length,B.push(Rt),++lt}return R=p(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,lt),R.write_shift(2,lt),R.write_shift(4,Et),R.write_shift(4,q),R.write_shift(2,0),A([A(F),A(B),R])}var Ve={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Mi(w,T){if(w.ctype)return w.ctype;var C=w.name||"",F=C.match(/\.([^\.]+)$/);return F&&Ve[F[1]]||T&&(F=(C=T).match(/[\.\\]([^\.\\])+$/),F&&Ve[F[1]])?Ve[F[1]]:"application/octet-stream"}function Vi(w){for(var T=e(w),C=[],F=0;F<T.length;F+=76)C.push(T.slice(F,F+76));return C.join(`\r
`)+`\r
`}function ji(w){var T=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var q=K.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],F=T.split(`\r
`),B=0;B<F.length;++B){var R=F[B];if(R.length==0){C.push("");continue}for(var $=0;$<R.length;){var nt=76,X=R.slice($,$+nt);X.charAt(nt-1)=="="?nt--:X.charAt(nt-2)=="="?nt-=2:X.charAt(nt-3)=="="&&(nt-=3),X=R.slice($,$+nt),$+=nt,$<R.length&&(X+="="),C.push(X)}}return C.join(`\r
`)}function Hi(w){for(var T=[],C=0;C<w.length;++C){for(var F=w[C];C<=w.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+w[++C];T.push(F)}for(var B=0;B<T.length;++B)T[B]=T[B].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return d(T.join(`\r
`))}function Wi(w,T,C){for(var F="",B="",R="",$,nt=0;nt<10;++nt){var X=T[nt];if(!X||X.match(/^\s*$/))break;var K=X.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":F=K[2].trim();break;case"content-type":R=K[2].trim();break;case"content-transfer-encoding":B=K[2].trim();break}}switch(++nt,B.toLowerCase()){case"base64":$=d(n(T.slice(nt).join("")));break;case"quoted-printable":$=Hi(T.slice(nt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var q=ar(w,F.slice(C.length),$,{unsafe:!0});R&&(q.ctype=R)}function Gi(w,T){if(Kt(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=T&&T.root||"",F=(s&&_t.isBuffer(w)?w.toString("binary"):Kt(w)).split(`\r
`),B=0,R="";for(B=0;B<F.length;++B)if(R=F[B],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),C||(C=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),R.slice(0,C.length)!=C););var $=(F[1]||"").match(/boundary="(.*?)"/);if(!$)throw new Error("MAD cannot find boundary");var nt="--"+($[1]||""),X=[],K=[],q={FileIndex:X,FullPaths:K};y(q);var lt,pt=0;for(B=0;B<F.length;++B){var yt=F[B];yt!==nt&&yt!==nt+"--"||(pt++&&Wi(q,F.slice(lt,B),C),lt=B)}return q}function Xi(w,T){var C=T||{},F=C.boundary||"SheetJS";F="------="+F;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],R=w.FullPaths[0],$=R,nt=w.FileIndex[0],X=1;X<w.FullPaths.length;++X)if($=w.FullPaths[X].slice(R.length),nt=w.FileIndex[X],!(!nt.size||!nt.content||$=="Sh33tJ5")){$=$.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Et){return"_x"+Et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Et){return"_u"+Et.charCodeAt(0).toString(16)+"_"});for(var K=nt.content,q=s&&_t.isBuffer(K)?K.toString("binary"):Kt(K),lt=0,pt=Math.min(1024,q.length),yt=0,dt=0;dt<=pt;++dt)(yt=q.charCodeAt(dt))>=32&&yt<128&&++lt;var gt=lt>=pt*4/5;B.push(F),B.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+$),B.push("Content-Transfer-Encoding: "+(gt?"quoted-printable":"base64")),B.push("Content-Type: "+Mi(nt,$)),B.push(""),B.push(gt?ji(q):Vi(q))}return B.push(F+`--\r
`),B.join(`\r
`)}function Zi(w){var T={};return y(T,w),T}function ar(w,T,C,F){var B=F&&F.unsafe;B||y(w);var R=!B&&xt.find(w,T);if(!R){var $=w.FullPaths[0];T.slice(0,$.length)==$?$=T:($.slice(-1)!="/"&&($+="/"),$=($+T).replace("//","/")),R={name:L(T),type:2},w.FileIndex.push(R),w.FullPaths.push($),B||xt.utils.cfb_gc(w)}return R.content=C,R.size=C?C.length:0,F&&(F.CLSID&&(R.clsid=F.CLSID),F.mt&&(R.mt=F.mt),F.ct&&(R.ct=F.ct)),R}function $i(w,T){y(w);var C=xt.find(w,T);if(C){for(var F=0;F<w.FileIndex.length;++F)if(w.FileIndex[F]==C)return w.FileIndex.splice(F,1),w.FullPaths.splice(F,1),!0}return!1}function qi(w,T,C){y(w);var F=xt.find(w,T);if(F){for(var B=0;B<w.FileIndex.length;++B)if(w.FileIndex[B]==F)return w.FileIndex[B].name=L(C),w.FullPaths[B]=C,!0}return!1}function Ki(w){x(w,!0)}return J.find=it,J.read=u,J.parse=b,J.write=Pt,J.writeFile=qt,J.utils={cfb_new:Zi,cfb_add:ar,cfb_del:$i,cfb_mov:qi,cfb_gc:Ki,ReadShift:ot,CheckField:U,prep_blob:tt,bconcat:A,use_zlib:Fe,_deflateRaw:kr,_inflateRaw:Dr,consts:Zt},J}();typeof De<"u"&&typeof DO_NOT_EXPORT_CFB>"u"&&(H.exports=xt)})(Ei);var bs=Ei.exports,Fi={},wr={},Ge={exports:{}},yr={},Re={},ei;function xs(){if(ei)return Re;ei=1,Re.byteLength=a,Re.toByteArray=N,Re.fromByteArray=D;for(var H=[],t=[],e=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=n.length;s<o;++s)H[s]=n[s],t[n.charCodeAt(s)]=s;t[45]=62,t[95]=63;function l(_){var v=_.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=_.indexOf("=");g===-1&&(g=v);var E=g===v?0:4-g%4;return[g,E]}function a(_){var v=l(_),g=v[0],E=v[1];return(g+E)*3/4-E}function d(_,v,g){return(v+g)*3/4-g}function N(_){var v,g=l(_),E=g[0],f=g[1],A=new e(d(_,E,f)),O=0,V=f>0?E-4:E,M;for(M=0;M<V;M+=4)v=t[_.charCodeAt(M)]<<18|t[_.charCodeAt(M+1)]<<12|t[_.charCodeAt(M+2)]<<6|t[_.charCodeAt(M+3)],A[O++]=v>>16&255,A[O++]=v>>8&255,A[O++]=v&255;return f===2&&(v=t[_.charCodeAt(M)]<<2|t[_.charCodeAt(M+1)]>>4,A[O++]=v&255),f===1&&(v=t[_.charCodeAt(M)]<<10|t[_.charCodeAt(M+1)]<<4|t[_.charCodeAt(M+2)]>>2,A[O++]=v>>8&255,A[O++]=v&255),A}function S(_){return H[_>>18&63]+H[_>>12&63]+H[_>>6&63]+H[_&63]}function I(_,v,g){for(var E,f=[],A=v;A<g;A+=3)E=(_[A]<<16&16711680)+(_[A+1]<<8&65280)+(_[A+2]&255),f.push(S(E));return f.join("")}function D(_){for(var v,g=_.length,E=g%3,f=[],A=16383,O=0,V=g-E;O<V;O+=A)f.push(I(_,O,O+A>V?V:O+A));return E===1?(v=_[g-1],f.push(H[v>>2]+H[v<<4&63]+"==")):E===2&&(v=(_[g-2]<<8)+_[g-1],f.push(H[v>>10]+H[v>>4&63]+H[v<<2&63]+"=")),f.join("")}return Re}var Xe={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var ri;function Cs(){return ri||(ri=1,Xe.read=function(H,t,e,n,s){var o,l,a=s*8-n-1,d=(1<<a)-1,N=d>>1,S=-7,I=e?s-1:0,D=e?-1:1,_=H[t+I];for(I+=D,o=_&(1<<-S)-1,_>>=-S,S+=a;S>0;o=o*256+H[t+I],I+=D,S-=8);for(l=o&(1<<-S)-1,o>>=-S,S+=n;S>0;l=l*256+H[t+I],I+=D,S-=8);if(o===0)o=1-N;else{if(o===d)return l?NaN:(_?-1:1)*(1/0);l=l+Math.pow(2,n),o=o-N}return(_?-1:1)*l*Math.pow(2,o-n)},Xe.write=function(H,t,e,n,s,o){var l,a,d,N=o*8-s-1,S=(1<<N)-1,I=S>>1,D=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=n?0:o-1,v=n?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,l=S):(l=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+I>=1?t+=D/d:t+=D*Math.pow(2,1-I),t*d>=2&&(l++,d/=2),l+I>=S?(a=0,l=S):l+I>=1?(a=(t*d-1)*Math.pow(2,s),l=l+I):(a=t*Math.pow(2,I-1)*Math.pow(2,s),l=0));s>=8;H[e+_]=a&255,_+=v,a/=256,s-=8);for(l=l<<s|a,N+=s;N>0;H[e+_]=l&255,_+=v,l/=256,N-=8);H[e+_-v]|=g*128}),Xe}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ii;function Ns(){return ii||(ii=1,function(H){var t=xs(),e=Cs(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;H.Buffer=a,H.SlowBuffer=A,H.INSPECT_MAX_BYTES=50;var s=2147483647;H.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var c=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(c,r),c.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function l(c){if(c>s)throw new RangeError('The value "'+c+'" is invalid for option "size"');var r=new Uint8Array(c);return Object.setPrototypeOf(r,a.prototype),r}function a(c,r,i){if(typeof c=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(c)}return d(c,r,i)}a.poolSize=8192;function d(c,r,i){if(typeof c=="string")return D(c,r);if(ArrayBuffer.isView(c))return v(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(Nt(c,ArrayBuffer)||c&&Nt(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Nt(c,SharedArrayBuffer)||c&&Nt(c.buffer,SharedArrayBuffer)))return g(c,r,i);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var u=c.valueOf&&c.valueOf();if(u!=null&&u!==c)return a.from(u,r,i);var y=E(c);if(y)return y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return a.from(c[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}a.from=function(c,r,i){return d(c,r,i)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function N(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function S(c,r,i){return N(c),c<=0?l(c):r!==void 0?typeof i=="string"?l(c).fill(r,i):l(c).fill(r):l(c)}a.alloc=function(c,r,i){return S(c,r,i)};function I(c){return N(c),l(c<0?0:f(c)|0)}a.allocUnsafe=function(c){return I(c)},a.allocUnsafeSlow=function(c){return I(c)};function D(c,r){if((typeof r!="string"||r==="")&&(r="utf8"),!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=O(c,r)|0,u=l(i),y=u.write(c,r);return y!==i&&(u=u.slice(0,y)),u}function _(c){for(var r=c.length<0?0:f(c.length)|0,i=l(r),u=0;u<r;u+=1)i[u]=c[u]&255;return i}function v(c){if(Nt(c,Uint8Array)){var r=new Uint8Array(c);return g(r.buffer,r.byteOffset,r.byteLength)}return _(c)}function g(c,r,i){if(r<0||c.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');var u;return r===void 0&&i===void 0?u=new Uint8Array(c):i===void 0?u=new Uint8Array(c,r):u=new Uint8Array(c,r,i),Object.setPrototypeOf(u,a.prototype),u}function E(c){if(a.isBuffer(c)){var r=f(c.length)|0,i=l(r);return i.length===0||c.copy(i,0,0,r),i}if(c.length!==void 0)return typeof c.length!="number"||h(c.length)?l(0):_(c);if(c.type==="Buffer"&&Array.isArray(c.data))return _(c.data)}function f(c){if(c>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return c|0}function A(c){return+c!=c&&(c=0),a.alloc(+c)}a.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==a.prototype},a.compare=function(r,i){if(Nt(r,Uint8Array)&&(r=a.from(r,r.offset,r.byteLength)),Nt(i,Uint8Array)&&(i=a.from(i,i.offset,i.byteLength)),!a.isBuffer(r)||!a.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===i)return 0;for(var u=r.length,y=i.length,z=0,x=Math.min(u,y);z<x;++z)if(r[z]!==i[z]){u=r[z],y=i[z];break}return u<y?-1:y<u?1:0},a.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(r,i){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return a.alloc(0);var u;if(i===void 0)for(i=0,u=0;u<r.length;++u)i+=r[u].length;var y=a.allocUnsafe(i),z=0;for(u=0;u<r.length;++u){var x=r[u];if(Nt(x,Uint8Array))z+x.length>y.length?a.from(x).copy(y,z):Uint8Array.prototype.set.call(y,x,z);else if(a.isBuffer(x))x.copy(y,z);else throw new TypeError('"list" argument must be an Array of Buffers');z+=x.length}return y};function O(c,r){if(a.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||Nt(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);var i=c.length,u=arguments.length>2&&arguments[2]===!0;if(!u&&i===0)return 0;for(var y=!1;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return m(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return bt(c).length;default:if(y)return u?-1:m(c).length;r=(""+r).toLowerCase(),y=!0}}a.byteLength=O;function V(c,r,i){var u=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,r>>>=0,i<=r))return"";for(c||(c="utf8");;)switch(c){case"hex":return G(this,r,i);case"utf8":case"utf-8":return p(this,r,i);case"ascii":return P(this,r,i);case"latin1":case"binary":return J(this,r,i);case"base64":return tt(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,r,i);default:if(u)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),u=!0}}a.prototype._isBuffer=!0;function M(c,r,i){var u=c[r];c[r]=c[i],c[i]=u}a.prototype.swap16=function(){var r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<r;i+=2)M(this,i,i+1);return this},a.prototype.swap32=function(){var r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<r;i+=4)M(this,i,i+3),M(this,i+1,i+2);return this},a.prototype.swap64=function(){var r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<r;i+=8)M(this,i,i+7),M(this,i+1,i+6),M(this,i+2,i+5),M(this,i+3,i+4);return this},a.prototype.toString=function(){var r=this.length;return r===0?"":arguments.length===0?p(this,0,r):V.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(r){if(!a.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:a.compare(this,r)===0},a.prototype.inspect=function(){var r="",i=H.INSPECT_MAX_BYTES;return r=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(r+=" ... "),"<Buffer "+r+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(r,i,u,y,z){if(Nt(r,Uint8Array)&&(r=a.from(r,r.offset,r.byteLength)),!a.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(i===void 0&&(i=0),u===void 0&&(u=r?r.length:0),y===void 0&&(y=0),z===void 0&&(z=this.length),i<0||u>r.length||y<0||z>this.length)throw new RangeError("out of range index");if(y>=z&&i>=u)return 0;if(y>=z)return-1;if(i>=u)return 1;if(i>>>=0,u>>>=0,y>>>=0,z>>>=0,this===r)return 0;for(var x=z-y,Z=u-i,it=Math.min(x,Z),rt=this.slice(y,z),ft=r.slice(i,u),Ct=0;Ct<it;++Ct)if(rt[Ct]!==ft[Ct]){x=rt[Ct],Z=ft[Ct];break}return x<Z?-1:Z<x?1:0};function at(c,r,i,u,y){if(c.length===0)return-1;if(typeof i=="string"?(u=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,h(i)&&(i=y?0:c.length-1),i<0&&(i=c.length+i),i>=c.length){if(y)return-1;i=c.length-1}else if(i<0)if(y)i=0;else return-1;if(typeof r=="string"&&(r=a.from(r,u)),a.isBuffer(r))return r.length===0?-1:Q(c,r,i,u,y);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?y?Uint8Array.prototype.indexOf.call(c,r,i):Uint8Array.prototype.lastIndexOf.call(c,r,i):Q(c,[r],i,u,y);throw new TypeError("val must be string, number or Buffer")}function Q(c,r,i,u,y){var z=1,x=c.length,Z=r.length;if(u!==void 0&&(u=String(u).toLowerCase(),u==="ucs2"||u==="ucs-2"||u==="utf16le"||u==="utf-16le")){if(c.length<2||r.length<2)return-1;z=2,x/=2,Z/=2,i/=2}function it(Lt,Zt){return z===1?Lt[Zt]:Lt.readUInt16BE(Zt*z)}var rt;if(y){var ft=-1;for(rt=i;rt<x;rt++)if(it(c,rt)===it(r,ft===-1?0:rt-ft)){if(ft===-1&&(ft=rt),rt-ft+1===Z)return ft*z}else ft!==-1&&(rt-=rt-ft),ft=-1}else for(i+Z>x&&(i=x-Z),rt=i;rt>=0;rt--){for(var Ct=!0,kt=0;kt<Z;kt++)if(it(c,rt+kt)!==it(r,kt)){Ct=!1;break}if(Ct)return rt}return-1}a.prototype.includes=function(r,i,u){return this.indexOf(r,i,u)!==-1},a.prototype.indexOf=function(r,i,u){return at(this,r,i,u,!0)},a.prototype.lastIndexOf=function(r,i,u){return at(this,r,i,u,!1)};function ot(c,r,i,u){i=Number(i)||0;var y=c.length-i;u?(u=Number(u),u>y&&(u=y)):u=y;var z=r.length;u>z/2&&(u=z/2);for(var x=0;x<u;++x){var Z=parseInt(r.substr(x*2,2),16);if(h(Z))return x;c[i+x]=Z}return x}function k(c,r,i,u){return St(m(r,c.length-i),c,i,u)}function ct(c,r,i,u){return St(Y(r),c,i,u)}function vt(c,r,i,u){return St(bt(r),c,i,u)}function U(c,r,i,u){return St(j(r,c.length-i),c,i,u)}a.prototype.write=function(r,i,u,y){if(i===void 0)y="utf8",u=this.length,i=0;else if(u===void 0&&typeof i=="string")y=i,u=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(u)?(u=u>>>0,y===void 0&&(y="utf8")):(y=u,u=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var z=this.length-i;if((u===void 0||u>z)&&(u=z),r.length>0&&(u<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");y||(y="utf8");for(var x=!1;;)switch(y){case"hex":return ot(this,r,i,u);case"utf8":case"utf-8":return k(this,r,i,u);case"ascii":case"latin1":case"binary":return ct(this,r,i,u);case"base64":return vt(this,r,i,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,r,i,u);default:if(x)throw new TypeError("Unknown encoding: "+y);y=(""+y).toLowerCase(),x=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function tt(c,r,i){return r===0&&i===c.length?t.fromByteArray(c):t.fromByteArray(c.slice(r,i))}function p(c,r,i){i=Math.min(c.length,i);for(var u=[],y=r;y<i;){var z=c[y],x=null,Z=z>239?4:z>223?3:z>191?2:1;if(y+Z<=i){var it,rt,ft,Ct;switch(Z){case 1:z<128&&(x=z);break;case 2:it=c[y+1],(it&192)===128&&(Ct=(z&31)<<6|it&63,Ct>127&&(x=Ct));break;case 3:it=c[y+1],rt=c[y+2],(it&192)===128&&(rt&192)===128&&(Ct=(z&15)<<12|(it&63)<<6|rt&63,Ct>2047&&(Ct<55296||Ct>57343)&&(x=Ct));break;case 4:it=c[y+1],rt=c[y+2],ft=c[y+3],(it&192)===128&&(rt&192)===128&&(ft&192)===128&&(Ct=(z&15)<<18|(it&63)<<12|(rt&63)<<6|ft&63,Ct>65535&&Ct<1114112&&(x=Ct))}}x===null?(x=65533,Z=1):x>65535&&(x-=65536,u.push(x>>>10&1023|55296),x=56320|x&1023),u.push(x),y+=Z}return xt(u)}var st=4096;function xt(c){var r=c.length;if(r<=st)return String.fromCharCode.apply(String,c);for(var i="",u=0;u<r;)i+=String.fromCharCode.apply(String,c.slice(u,u+=st));return i}function P(c,r,i){var u="";i=Math.min(c.length,i);for(var y=r;y<i;++y)u+=String.fromCharCode(c[y]&127);return u}function J(c,r,i){var u="";i=Math.min(c.length,i);for(var y=r;y<i;++y)u+=String.fromCharCode(c[y]);return u}function G(c,r,i){var u=c.length;(!r||r<0)&&(r=0),(!i||i<0||i>u)&&(i=u);for(var y="",z=r;z<i;++z)y+=et[c[z]];return y}function ut(c,r,i){for(var u=c.slice(r,i),y="",z=0;z<u.length-1;z+=2)y+=String.fromCharCode(u[z]+u[z+1]*256);return y}a.prototype.slice=function(r,i){var u=this.length;r=~~r,i=i===void 0?u:~~i,r<0?(r+=u,r<0&&(r=0)):r>u&&(r=u),i<0?(i+=u,i<0&&(i=0)):i>u&&(i=u),i<r&&(i=r);var y=this.subarray(r,i);return Object.setPrototypeOf(y,a.prototype),y};function L(c,r,i){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+r>i)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(r,i,u){r=r>>>0,i=i>>>0,u||L(r,i,this.length);for(var y=this[r],z=1,x=0;++x<i&&(z*=256);)y+=this[r+x]*z;return y},a.prototype.readUintBE=a.prototype.readUIntBE=function(r,i,u){r=r>>>0,i=i>>>0,u||L(r,i,this.length);for(var y=this[r+--i],z=1;i>0&&(z*=256);)y+=this[r+--i]*z;return y},a.prototype.readUint8=a.prototype.readUInt8=function(r,i){return r=r>>>0,i||L(r,1,this.length),this[r]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(r,i){return r=r>>>0,i||L(r,2,this.length),this[r]|this[r+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(r,i){return r=r>>>0,i||L(r,2,this.length),this[r]<<8|this[r+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(r,i){return r=r>>>0,i||L(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])},a.prototype.readIntLE=function(r,i,u){r=r>>>0,i=i>>>0,u||L(r,i,this.length);for(var y=this[r],z=1,x=0;++x<i&&(z*=256);)y+=this[r+x]*z;return z*=128,y>=z&&(y-=Math.pow(2,8*i)),y},a.prototype.readIntBE=function(r,i,u){r=r>>>0,i=i>>>0,u||L(r,i,this.length);for(var y=i,z=1,x=this[r+--y];y>0&&(z*=256);)x+=this[r+--y]*z;return z*=128,x>=z&&(x-=Math.pow(2,8*i)),x},a.prototype.readInt8=function(r,i){return r=r>>>0,i||L(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]},a.prototype.readInt16LE=function(r,i){r=r>>>0,i||L(r,2,this.length);var u=this[r]|this[r+1]<<8;return u&32768?u|4294901760:u},a.prototype.readInt16BE=function(r,i){r=r>>>0,i||L(r,2,this.length);var u=this[r+1]|this[r]<<8;return u&32768?u|4294901760:u},a.prototype.readInt32LE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},a.prototype.readInt32BE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},a.prototype.readFloatLE=function(r,i){return r=r>>>0,i||L(r,4,this.length),e.read(this,r,!0,23,4)},a.prototype.readFloatBE=function(r,i){return r=r>>>0,i||L(r,4,this.length),e.read(this,r,!1,23,4)},a.prototype.readDoubleLE=function(r,i){return r=r>>>0,i||L(r,8,this.length),e.read(this,r,!0,52,8)},a.prototype.readDoubleBE=function(r,i){return r=r>>>0,i||L(r,8,this.length),e.read(this,r,!1,52,8)};function W(c,r,i,u,y,z){if(!a.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>y||r<z)throw new RangeError('"value" argument is out of bounds');if(i+u>c.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(r,i,u,y){if(r=+r,i=i>>>0,u=u>>>0,!y){var z=Math.pow(2,8*u)-1;W(this,r,i,u,z,0)}var x=1,Z=0;for(this[i]=r&255;++Z<u&&(x*=256);)this[i+Z]=r/x&255;return i+u},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(r,i,u,y){if(r=+r,i=i>>>0,u=u>>>0,!y){var z=Math.pow(2,8*u)-1;W(this,r,i,u,z,0)}var x=u-1,Z=1;for(this[i+x]=r&255;--x>=0&&(Z*=256);)this[i+x]=r/Z&255;return i+u},a.prototype.writeUint8=a.prototype.writeUInt8=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,1,255,0),this[i]=r&255,i+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,2,65535,0),this[i]=r&255,this[i+1]=r>>>8,i+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,2,65535,0),this[i]=r>>>8,this[i+1]=r&255,i+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,4,4294967295,0),this[i+3]=r>>>24,this[i+2]=r>>>16,this[i+1]=r>>>8,this[i]=r&255,i+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,4,4294967295,0),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4},a.prototype.writeIntLE=function(r,i,u,y){if(r=+r,i=i>>>0,!y){var z=Math.pow(2,8*u-1);W(this,r,i,u,z-1,-z)}var x=0,Z=1,it=0;for(this[i]=r&255;++x<u&&(Z*=256);)r<0&&it===0&&this[i+x-1]!==0&&(it=1),this[i+x]=(r/Z>>0)-it&255;return i+u},a.prototype.writeIntBE=function(r,i,u,y){if(r=+r,i=i>>>0,!y){var z=Math.pow(2,8*u-1);W(this,r,i,u,z-1,-z)}var x=u-1,Z=1,it=0;for(this[i+x]=r&255;--x>=0&&(Z*=256);)r<0&&it===0&&this[i+x+1]!==0&&(it=1),this[i+x]=(r/Z>>0)-it&255;return i+u},a.prototype.writeInt8=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,1,127,-128),r<0&&(r=255+r+1),this[i]=r&255,i+1},a.prototype.writeInt16LE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,2,32767,-32768),this[i]=r&255,this[i+1]=r>>>8,i+2},a.prototype.writeInt16BE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,2,32767,-32768),this[i]=r>>>8,this[i+1]=r&255,i+2},a.prototype.writeInt32LE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,4,2147483647,-2147483648),this[i]=r&255,this[i+1]=r>>>8,this[i+2]=r>>>16,this[i+3]=r>>>24,i+4},a.prototype.writeInt32BE=function(r,i,u){return r=+r,i=i>>>0,u||W(this,r,i,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4};function wt(c,r,i,u,y,z){if(i+u>c.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function mt(c,r,i,u,y){return r=+r,i=i>>>0,y||wt(c,r,i,4),e.write(c,r,i,u,23,4),i+4}a.prototype.writeFloatLE=function(r,i,u){return mt(this,r,i,!0,u)},a.prototype.writeFloatBE=function(r,i,u){return mt(this,r,i,!1,u)};function ht(c,r,i,u,y){return r=+r,i=i>>>0,y||wt(c,r,i,8),e.write(c,r,i,u,52,8),i+8}a.prototype.writeDoubleLE=function(r,i,u){return ht(this,r,i,!0,u)},a.prototype.writeDoubleBE=function(r,i,u){return ht(this,r,i,!1,u)},a.prototype.copy=function(r,i,u,y){if(!a.isBuffer(r))throw new TypeError("argument should be a Buffer");if(u||(u=0),!y&&y!==0&&(y=this.length),i>=r.length&&(i=r.length),i||(i=0),y>0&&y<u&&(y=u),y===u||r.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(u<0||u>=this.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("sourceEnd out of bounds");y>this.length&&(y=this.length),r.length-i<y-u&&(y=r.length-i+u);var z=y-u;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,u,y):Uint8Array.prototype.set.call(r,this.subarray(u,y),i),z},a.prototype.fill=function(r,i,u,y){if(typeof r=="string"){if(typeof i=="string"?(y=i,i=0,u=this.length):typeof u=="string"&&(y=u,u=this.length),y!==void 0&&typeof y!="string")throw new TypeError("encoding must be a string");if(typeof y=="string"&&!a.isEncoding(y))throw new TypeError("Unknown encoding: "+y);if(r.length===1){var z=r.charCodeAt(0);(y==="utf8"&&z<128||y==="latin1")&&(r=z)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(i<0||this.length<i||this.length<u)throw new RangeError("Out of range index");if(u<=i)return this;i=i>>>0,u=u===void 0?this.length:u>>>0,r||(r=0);var x;if(typeof r=="number")for(x=i;x<u;++x)this[x]=r;else{var Z=a.isBuffer(r)?r:a.from(r,y),it=Z.length;if(it===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(x=0;x<u-i;++x)this[x+i]=Z[x%it]}return this};var Ft=/[^+/0-9A-Za-z-_]/g;function b(c){if(c=c.split("=")[0],c=c.trim().replace(Ft,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function m(c,r){r=r||1/0;for(var i,u=c.length,y=null,z=[],x=0;x<u;++x){if(i=c.charCodeAt(x),i>55295&&i<57344){if(!y){if(i>56319){(r-=3)>-1&&z.push(239,191,189);continue}else if(x+1===u){(r-=3)>-1&&z.push(239,191,189);continue}y=i;continue}if(i<56320){(r-=3)>-1&&z.push(239,191,189),y=i;continue}i=(y-55296<<10|i-56320)+65536}else y&&(r-=3)>-1&&z.push(239,191,189);if(y=null,i<128){if((r-=1)<0)break;z.push(i)}else if(i<2048){if((r-=2)<0)break;z.push(i>>6|192,i&63|128)}else if(i<65536){if((r-=3)<0)break;z.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((r-=4)<0)break;z.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return z}function Y(c){for(var r=[],i=0;i<c.length;++i)r.push(c.charCodeAt(i)&255);return r}function j(c,r){for(var i,u,y,z=[],x=0;x<c.length&&!((r-=2)<0);++x)i=c.charCodeAt(x),u=i>>8,y=i%256,z.push(y),z.push(u);return z}function bt(c){return t.toByteArray(b(c))}function St(c,r,i,u){for(var y=0;y<u&&!(y+i>=r.length||y>=c.length);++y)r[y+i]=c[y];return y}function Nt(c,r){return c instanceof r||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===r.name}function h(c){return c!==c}var et=function(){for(var c="0123456789abcdef",r=new Array(256),i=0;i<16;++i)for(var u=i*16,y=0;y<16;++y)r[u+y]=c[i]+c[y];return r}()}(yr)),yr}var ni;function Es(){return ni||(ni=1,function(H,t){var e=Ns(),n=e.Buffer;function s(l,a){for(var d in l)a[d]=l[d]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?H.exports=e:(s(e,t),t.Buffer=o);function o(l,a,d){return n(l,a,d)}s(n,o),o.from=function(l,a,d){if(typeof l=="number")throw new TypeError("Argument must not be a number");return n(l,a,d)},o.alloc=function(l,a,d){if(typeof l!="number")throw new TypeError("Argument must be a number");var N=n(l);return a!==void 0?typeof d=="string"?N.fill(a,d):N.fill(a):N.fill(0),N},o.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return n(l)},o.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return e.SlowBuffer(l)}}(Ge,Ge.exports)),Ge.exports}var si;function Fs(){if(si)return wr;si=1;var H=Es().Buffer,t=H.isEncoding||function(f){switch(f=""+f,f&&f.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function e(f){if(!f)return"utf8";for(var A;;)switch(f){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return f;default:if(A)return;f=(""+f).toLowerCase(),A=!0}}function n(f){var A=e(f);if(typeof A!="string"&&(H.isEncoding===t||!t(f)))throw new Error("Unknown encoding: "+f);return A||f}wr.StringDecoder=s;function s(f){this.encoding=n(f);var A;switch(this.encoding){case"utf16le":this.text=I,this.end=D,A=4;break;case"utf8":this.fillLast=d,A=4;break;case"base64":this.text=_,this.end=v,A=3;break;default:this.write=g,this.end=E;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=H.allocUnsafe(A)}s.prototype.write=function(f){if(f.length===0)return"";var A,O;if(this.lastNeed){if(A=this.fillLast(f),A===void 0)return"";O=this.lastNeed,this.lastNeed=0}else O=0;return O<f.length?A?A+this.text(f,O):this.text(f,O):A||""},s.prototype.end=S,s.prototype.text=N,s.prototype.fillLast=function(f){if(this.lastNeed<=f.length)return f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,f.length),this.lastNeed-=f.length};function o(f){return f<=127?0:f>>5===6?2:f>>4===14?3:f>>3===30?4:f>>6===2?-1:-2}function l(f,A,O){var V=A.length-1;if(V<O)return 0;var M=o(A[V]);return M>=0?(M>0&&(f.lastNeed=M-1),M):--V<O||M===-2?0:(M=o(A[V]),M>=0?(M>0&&(f.lastNeed=M-2),M):--V<O||M===-2?0:(M=o(A[V]),M>=0?(M>0&&(M===2?M=0:f.lastNeed=M-3),M):0))}function a(f,A,O){if((A[0]&192)!==128)return f.lastNeed=0,"";if(f.lastNeed>1&&A.length>1){if((A[1]&192)!==128)return f.lastNeed=1,"";if(f.lastNeed>2&&A.length>2&&(A[2]&192)!==128)return f.lastNeed=2,""}}function d(f){var A=this.lastTotal-this.lastNeed,O=a(this,f);if(O!==void 0)return O;if(this.lastNeed<=f.length)return f.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,A,0,f.length),this.lastNeed-=f.length}function N(f,A){var O=l(this,f,A);if(!this.lastNeed)return f.toString("utf8",A);this.lastTotal=O;var V=f.length-(O-this.lastNeed);return f.copy(this.lastChar,0,V),f.toString("utf8",A,V)}function S(f){var A=f&&f.length?this.write(f):"";return this.lastNeed?A+"":A}function I(f,A){if((f.length-A)%2===0){var O=f.toString("utf16le",A);if(O){var V=O.charCodeAt(O.length-1);if(V>=55296&&V<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1],O.slice(0,-1)}return O}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=f[f.length-1],f.toString("utf16le",A,f.length-1)}function D(f){var A=f&&f.length?this.write(f):"";if(this.lastNeed){var O=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,O)}return A}function _(f,A){var O=(f.length-A)%3;return O===0?f.toString("base64",A):(this.lastNeed=3-O,this.lastTotal=3,O===1?this.lastChar[0]=f[f.length-1]:(this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1]),f.toString("base64",A,f.length-O))}function v(f){var A=f&&f.length?this.write(f):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function g(f){return f.toString(this.encoding)}function E(f){return f&&f.length?this.write(f):""}return wr}(function(H){(function(t){t.parser=function(b,m){return new n(b,m)},t.SAXParser=n,t.SAXStream=S,t.createStream=N,t.MAX_BUFFER_LENGTH=64*1024;var e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(b,m){if(!(this instanceof n))return new n(b,m);var Y=this;o(Y),Y.q=Y.c="",Y.bufferCheckPosition=t.MAX_BUFFER_LENGTH,Y.opt=m||{},Y.opt.lowercase=Y.opt.lowercase||Y.opt.lowercasetags,Y.looseCase=Y.opt.lowercase?"toLowerCase":"toUpperCase",Y.tags=[],Y.closed=Y.closedRoot=Y.sawRoot=!1,Y.tag=Y.error=null,Y.strict=!!b,Y.noscript=!!(b||Y.opt.noscript),Y.state=k.BEGIN,Y.strictEntities=Y.opt.strictEntities,Y.ENTITIES=Y.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),Y.attribList=[],Y.opt.xmlns&&(Y.ns=Object.create(g)),Y.opt.unquotedAttributeValues===void 0&&(Y.opt.unquotedAttributeValues=!b),Y.trackPosition=Y.opt.position!==!1,Y.trackPosition&&(Y.position=Y.line=Y.column=0),vt(Y,"onready")}Object.create||(Object.create=function(b){function m(){}m.prototype=b;var Y=new m;return Y}),Object.keys||(Object.keys=function(b){var m=[];for(var Y in b)b.hasOwnProperty(Y)&&m.push(Y);return m});function s(b){for(var m=Math.max(t.MAX_BUFFER_LENGTH,10),Y=0,j=0,bt=e.length;j<bt;j++){var St=b[e[j]].length;if(St>m)switch(e[j]){case"textNode":tt(b);break;case"cdata":U(b,"oncdata",b.cdata),b.cdata="";break;case"script":U(b,"onscript",b.script),b.script="";break;default:st(b,"Max buffer length exceeded: "+e[j])}Y=Math.max(Y,St)}var Nt=t.MAX_BUFFER_LENGTH-Y;b.bufferCheckPosition=Nt+b.position}function o(b){for(var m=0,Y=e.length;m<Y;m++)b[e[m]]=""}function l(b){tt(b),b.cdata!==""&&(U(b,"oncdata",b.cdata),b.cdata=""),b.script!==""&&(U(b,"onscript",b.script),b.script="")}n.prototype={end:function(){xt(this)},write:Ft,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){l(this)}};var a;try{a=Ye.Stream}catch{a=function(){}}a||(a=function(){});var d=t.EVENTS.filter(function(b){return b!=="error"&&b!=="end"});function N(b,m){return new S(b,m)}function S(b,m){if(!(this instanceof S))return new S(b,m);a.apply(this),this._parser=new n(b,m),this.writable=!0,this.readable=!0;var Y=this;this._parser.onend=function(){Y.emit("end")},this._parser.onerror=function(j){Y.emit("error",j),Y._parser.error=null},this._decoder=null,d.forEach(function(j){Object.defineProperty(Y,"on"+j,{get:function(){return Y._parser["on"+j]},set:function(bt){if(!bt)return Y.removeAllListeners(j),Y._parser["on"+j]=bt,bt;Y.on(j,bt)},enumerable:!0,configurable:!1})})}S.prototype=Object.create(a.prototype,{constructor:{value:S}}),S.prototype.write=function(b){if(typeof _t=="function"&&typeof _t.isBuffer=="function"&&_t.isBuffer(b)){if(!this._decoder){var m=Fs().StringDecoder;this._decoder=new m("utf8")}b=this._decoder.write(b)}return this._parser.write(b.toString()),this.emit("data",b),!0},S.prototype.end=function(b){return b&&b.length&&this.write(b),this._parser.end(),!0},S.prototype.on=function(b,m){var Y=this;return!Y._parser["on"+b]&&d.indexOf(b)!==-1&&(Y._parser["on"+b]=function(){var j=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);j.splice(0,0,b),Y.emit.apply(Y,j)}),a.prototype.on.call(Y,b,m)};var I="[CDATA[",D="DOCTYPE",_="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",g={xml:_,xmlns:v},E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,A=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,O=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function V(b){return b===" "||b===`
`||b==="\r"||b==="	"}function M(b){return b==='"'||b==="'"}function at(b){return b===">"||V(b)}function Q(b,m){return b.test(m)}function ot(b,m){return!Q(b,m)}var k=0;t.STATE={BEGIN:k++,BEGIN_WHITESPACE:k++,TEXT:k++,TEXT_ENTITY:k++,OPEN_WAKA:k++,SGML_DECL:k++,SGML_DECL_QUOTED:k++,DOCTYPE:k++,DOCTYPE_QUOTED:k++,DOCTYPE_DTD:k++,DOCTYPE_DTD_QUOTED:k++,COMMENT_STARTING:k++,COMMENT:k++,COMMENT_ENDING:k++,COMMENT_ENDED:k++,CDATA:k++,CDATA_ENDING:k++,CDATA_ENDING_2:k++,PROC_INST:k++,PROC_INST_BODY:k++,PROC_INST_ENDING:k++,OPEN_TAG:k++,OPEN_TAG_SLASH:k++,ATTRIB:k++,ATTRIB_NAME:k++,ATTRIB_NAME_SAW_WHITE:k++,ATTRIB_VALUE:k++,ATTRIB_VALUE_QUOTED:k++,ATTRIB_VALUE_CLOSED:k++,ATTRIB_VALUE_UNQUOTED:k++,ATTRIB_VALUE_ENTITY_Q:k++,ATTRIB_VALUE_ENTITY_U:k++,CLOSE_TAG:k++,CLOSE_TAG_SAW_WHITE:k++,SCRIPT:k++,SCRIPT_ENDING:k++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(b){var m=t.ENTITIES[b],Y=typeof m=="number"?String.fromCharCode(m):m;t.ENTITIES[b]=Y});for(var ct in t.STATE)t.STATE[t.STATE[ct]]=ct;k=t.STATE;function vt(b,m,Y){b[m]&&b[m](Y)}function U(b,m,Y){b.textNode&&tt(b),vt(b,m,Y)}function tt(b){b.textNode=p(b.opt,b.textNode),b.textNode&&vt(b,"ontext",b.textNode),b.textNode=""}function p(b,m){return b.trim&&(m=m.trim()),b.normalize&&(m=m.replace(/\s+/g," ")),m}function st(b,m){return tt(b),b.trackPosition&&(m+=`
Line: `+b.line+`
Column: `+b.column+`
Char: `+b.c),m=new Error(m),b.error=m,vt(b,"onerror",m),b}function xt(b){return b.sawRoot&&!b.closedRoot&&P(b,"Unclosed root tag"),b.state!==k.BEGIN&&b.state!==k.BEGIN_WHITESPACE&&b.state!==k.TEXT&&st(b,"Unexpected end"),tt(b),b.c="",b.closed=!0,vt(b,"onend"),n.call(b,b.strict,b.opt),b}function P(b,m){if(typeof b!="object"||!(b instanceof n))throw new Error("bad call to strictFail");b.strict&&st(b,m)}function J(b){b.strict||(b.tagName=b.tagName[b.looseCase]());var m=b.tags[b.tags.length-1]||b,Y=b.tag={name:b.tagName,attributes:{}};b.opt.xmlns&&(Y.ns=m.ns),b.attribList.length=0,U(b,"onopentagstart",Y)}function G(b,m){var Y=b.indexOf(":"),j=Y<0?["",b]:b.split(":"),bt=j[0],St=j[1];return m&&b==="xmlns"&&(bt="xmlns",St=""),{prefix:bt,local:St}}function ut(b){if(b.strict||(b.attribName=b.attribName[b.looseCase]()),b.attribList.indexOf(b.attribName)!==-1||b.tag.attributes.hasOwnProperty(b.attribName)){b.attribName=b.attribValue="";return}if(b.opt.xmlns){var m=G(b.attribName,!0),Y=m.prefix,j=m.local;if(Y==="xmlns")if(j==="xml"&&b.attribValue!==_)P(b,"xml: prefix must be bound to "+_+`
Actual: `+b.attribValue);else if(j==="xmlns"&&b.attribValue!==v)P(b,"xmlns: prefix must be bound to "+v+`
Actual: `+b.attribValue);else{var bt=b.tag,St=b.tags[b.tags.length-1]||b;bt.ns===St.ns&&(bt.ns=Object.create(St.ns)),bt.ns[j]=b.attribValue}b.attribList.push([b.attribName,b.attribValue])}else b.tag.attributes[b.attribName]=b.attribValue,U(b,"onattribute",{name:b.attribName,value:b.attribValue});b.attribName=b.attribValue=""}function L(b,m){if(b.opt.xmlns){var Y=b.tag,j=G(b.tagName);Y.prefix=j.prefix,Y.local=j.local,Y.uri=Y.ns[j.prefix]||"",Y.prefix&&!Y.uri&&(P(b,"Unbound namespace prefix: "+JSON.stringify(b.tagName)),Y.uri=j.prefix);var bt=b.tags[b.tags.length-1]||b;Y.ns&&bt.ns!==Y.ns&&Object.keys(Y.ns).forEach(function(x){U(b,"onopennamespace",{prefix:x,uri:Y.ns[x]})});for(var St=0,Nt=b.attribList.length;St<Nt;St++){var h=b.attribList[St],et=h[0],c=h[1],r=G(et,!0),i=r.prefix,u=r.local,y=i===""?"":Y.ns[i]||"",z={name:et,value:c,prefix:i,local:u,uri:y};i&&i!=="xmlns"&&!y&&(P(b,"Unbound namespace prefix: "+JSON.stringify(i)),z.uri=i),b.tag.attributes[et]=z,U(b,"onattribute",z)}b.attribList.length=0}b.tag.isSelfClosing=!!m,b.sawRoot=!0,b.tags.push(b.tag),U(b,"onopentag",b.tag),m||(!b.noscript&&b.tagName.toLowerCase()==="script"?b.state=k.SCRIPT:b.state=k.TEXT,b.tag=null,b.tagName=""),b.attribName=b.attribValue="",b.attribList.length=0}function W(b){if(!b.tagName){P(b,"Weird empty close tag."),b.textNode+="</>",b.state=k.TEXT;return}if(b.script){if(b.tagName!=="script"){b.script+="</"+b.tagName+">",b.tagName="",b.state=k.SCRIPT;return}U(b,"onscript",b.script),b.script=""}var m=b.tags.length,Y=b.tagName;b.strict||(Y=Y[b.looseCase]());for(var j=Y;m--;){var bt=b.tags[m];if(bt.name!==j)P(b,"Unexpected close tag");else break}if(m<0){P(b,"Unmatched closing tag: "+b.tagName),b.textNode+="</"+b.tagName+">",b.state=k.TEXT;return}b.tagName=Y;for(var St=b.tags.length;St-- >m;){var Nt=b.tag=b.tags.pop();b.tagName=b.tag.name,U(b,"onclosetag",b.tagName);var h={};for(var et in Nt.ns)h[et]=Nt.ns[et];var c=b.tags[b.tags.length-1]||b;b.opt.xmlns&&Nt.ns!==c.ns&&Object.keys(Nt.ns).forEach(function(r){var i=Nt.ns[r];U(b,"onclosenamespace",{prefix:r,uri:i})})}m===0&&(b.closedRoot=!0),b.tagName=b.attribValue=b.attribName="",b.attribList.length=0,b.state=k.TEXT}function wt(b){var m=b.entity,Y=m.toLowerCase(),j,bt="";return b.ENTITIES[m]?b.ENTITIES[m]:b.ENTITIES[Y]?b.ENTITIES[Y]:(m=Y,m.charAt(0)==="#"&&(m.charAt(1)==="x"?(m=m.slice(2),j=parseInt(m,16),bt=j.toString(16)):(m=m.slice(1),j=parseInt(m,10),bt=j.toString(10))),m=m.replace(/^0+/,""),isNaN(j)||bt.toLowerCase()!==m?(P(b,"Invalid character entity"),"&"+b.entity+";"):String.fromCodePoint(j))}function mt(b,m){m==="<"?(b.state=k.OPEN_WAKA,b.startTagPosition=b.position):V(m)||(P(b,"Non-whitespace before first tag."),b.textNode=m,b.state=k.TEXT)}function ht(b,m){var Y="";return m<b.length&&(Y=b.charAt(m)),Y}function Ft(b){var m=this;if(this.error)throw this.error;if(m.closed)return st(m,"Cannot write after close. Assign an onready handler.");if(b===null)return xt(m);typeof b=="object"&&(b=b.toString());for(var Y=0,j="";j=ht(b,Y++),m.c=j,!!j;)switch(m.trackPosition&&(m.position++,j===`
`?(m.line++,m.column=0):m.column++),m.state){case k.BEGIN:if(m.state=k.BEGIN_WHITESPACE,j==="\uFEFF")continue;mt(m,j);continue;case k.BEGIN_WHITESPACE:mt(m,j);continue;case k.TEXT:if(m.sawRoot&&!m.closedRoot){for(var bt=Y-1;j&&j!=="<"&&j!=="&";)j=ht(b,Y++),j&&m.trackPosition&&(m.position++,j===`
`?(m.line++,m.column=0):m.column++);m.textNode+=b.substring(bt,Y-1)}j==="<"&&!(m.sawRoot&&m.closedRoot&&!m.strict)?(m.state=k.OPEN_WAKA,m.startTagPosition=m.position):(!V(j)&&(!m.sawRoot||m.closedRoot)&&P(m,"Text data outside of root node."),j==="&"?m.state=k.TEXT_ENTITY:m.textNode+=j);continue;case k.SCRIPT:j==="<"?m.state=k.SCRIPT_ENDING:m.script+=j;continue;case k.SCRIPT_ENDING:j==="/"?m.state=k.CLOSE_TAG:(m.script+="<"+j,m.state=k.SCRIPT);continue;case k.OPEN_WAKA:if(j==="!")m.state=k.SGML_DECL,m.sgmlDecl="";else if(!V(j))if(Q(E,j))m.state=k.OPEN_TAG,m.tagName=j;else if(j==="/")m.state=k.CLOSE_TAG,m.tagName="";else if(j==="?")m.state=k.PROC_INST,m.procInstName=m.procInstBody="";else{if(P(m,"Unencoded <"),m.startTagPosition+1<m.position){var St=m.position-m.startTagPosition;j=new Array(St).join(" ")+j}m.textNode+="<"+j,m.state=k.TEXT}continue;case k.SGML_DECL:if(m.sgmlDecl+j==="--"){m.state=k.COMMENT,m.comment="",m.sgmlDecl="";continue}m.doctype&&m.doctype!==!0&&m.sgmlDecl?(m.state=k.DOCTYPE_DTD,m.doctype+="<!"+m.sgmlDecl+j,m.sgmlDecl=""):(m.sgmlDecl+j).toUpperCase()===I?(U(m,"onopencdata"),m.state=k.CDATA,m.sgmlDecl="",m.cdata=""):(m.sgmlDecl+j).toUpperCase()===D?(m.state=k.DOCTYPE,(m.doctype||m.sawRoot)&&P(m,"Inappropriately located doctype declaration"),m.doctype="",m.sgmlDecl=""):j===">"?(U(m,"onsgmldeclaration",m.sgmlDecl),m.sgmlDecl="",m.state=k.TEXT):(M(j)&&(m.state=k.SGML_DECL_QUOTED),m.sgmlDecl+=j);continue;case k.SGML_DECL_QUOTED:j===m.q&&(m.state=k.SGML_DECL,m.q=""),m.sgmlDecl+=j;continue;case k.DOCTYPE:j===">"?(m.state=k.TEXT,U(m,"ondoctype",m.doctype),m.doctype=!0):(m.doctype+=j,j==="["?m.state=k.DOCTYPE_DTD:M(j)&&(m.state=k.DOCTYPE_QUOTED,m.q=j));continue;case k.DOCTYPE_QUOTED:m.doctype+=j,j===m.q&&(m.q="",m.state=k.DOCTYPE);continue;case k.DOCTYPE_DTD:j==="]"?(m.doctype+=j,m.state=k.DOCTYPE):j==="<"?(m.state=k.OPEN_WAKA,m.startTagPosition=m.position):M(j)?(m.doctype+=j,m.state=k.DOCTYPE_DTD_QUOTED,m.q=j):m.doctype+=j;continue;case k.DOCTYPE_DTD_QUOTED:m.doctype+=j,j===m.q&&(m.state=k.DOCTYPE_DTD,m.q="");continue;case k.COMMENT:j==="-"?m.state=k.COMMENT_ENDING:m.comment+=j;continue;case k.COMMENT_ENDING:j==="-"?(m.state=k.COMMENT_ENDED,m.comment=p(m.opt,m.comment),m.comment&&U(m,"oncomment",m.comment),m.comment=""):(m.comment+="-"+j,m.state=k.COMMENT);continue;case k.COMMENT_ENDED:j!==">"?(P(m,"Malformed comment"),m.comment+="--"+j,m.state=k.COMMENT):m.doctype&&m.doctype!==!0?m.state=k.DOCTYPE_DTD:m.state=k.TEXT;continue;case k.CDATA:j==="]"?m.state=k.CDATA_ENDING:m.cdata+=j;continue;case k.CDATA_ENDING:j==="]"?m.state=k.CDATA_ENDING_2:(m.cdata+="]"+j,m.state=k.CDATA);continue;case k.CDATA_ENDING_2:j===">"?(m.cdata&&U(m,"oncdata",m.cdata),U(m,"onclosecdata"),m.cdata="",m.state=k.TEXT):j==="]"?m.cdata+="]":(m.cdata+="]]"+j,m.state=k.CDATA);continue;case k.PROC_INST:j==="?"?m.state=k.PROC_INST_ENDING:V(j)?m.state=k.PROC_INST_BODY:m.procInstName+=j;continue;case k.PROC_INST_BODY:if(!m.procInstBody&&V(j))continue;j==="?"?m.state=k.PROC_INST_ENDING:m.procInstBody+=j;continue;case k.PROC_INST_ENDING:j===">"?(U(m,"onprocessinginstruction",{name:m.procInstName,body:m.procInstBody}),m.procInstName=m.procInstBody="",m.state=k.TEXT):(m.procInstBody+="?"+j,m.state=k.PROC_INST_BODY);continue;case k.OPEN_TAG:Q(f,j)?m.tagName+=j:(J(m),j===">"?L(m):j==="/"?m.state=k.OPEN_TAG_SLASH:(V(j)||P(m,"Invalid character in tag name"),m.state=k.ATTRIB));continue;case k.OPEN_TAG_SLASH:j===">"?(L(m,!0),W(m)):(P(m,"Forward-slash in opening tag not followed by >"),m.state=k.ATTRIB);continue;case k.ATTRIB:if(V(j))continue;j===">"?L(m):j==="/"?m.state=k.OPEN_TAG_SLASH:Q(E,j)?(m.attribName=j,m.attribValue="",m.state=k.ATTRIB_NAME):P(m,"Invalid attribute name");continue;case k.ATTRIB_NAME:j==="="?m.state=k.ATTRIB_VALUE:j===">"?(P(m,"Attribute without value"),m.attribValue=m.attribName,ut(m),L(m)):V(j)?m.state=k.ATTRIB_NAME_SAW_WHITE:Q(f,j)?m.attribName+=j:P(m,"Invalid attribute name");continue;case k.ATTRIB_NAME_SAW_WHITE:if(j==="=")m.state=k.ATTRIB_VALUE;else{if(V(j))continue;P(m,"Attribute without value"),m.tag.attributes[m.attribName]="",m.attribValue="",U(m,"onattribute",{name:m.attribName,value:""}),m.attribName="",j===">"?L(m):Q(E,j)?(m.attribName=j,m.state=k.ATTRIB_NAME):(P(m,"Invalid attribute name"),m.state=k.ATTRIB)}continue;case k.ATTRIB_VALUE:if(V(j))continue;M(j)?(m.q=j,m.state=k.ATTRIB_VALUE_QUOTED):(m.opt.unquotedAttributeValues||st(m,"Unquoted attribute value"),m.state=k.ATTRIB_VALUE_UNQUOTED,m.attribValue=j);continue;case k.ATTRIB_VALUE_QUOTED:if(j!==m.q){j==="&"?m.state=k.ATTRIB_VALUE_ENTITY_Q:m.attribValue+=j;continue}ut(m),m.q="",m.state=k.ATTRIB_VALUE_CLOSED;continue;case k.ATTRIB_VALUE_CLOSED:V(j)?m.state=k.ATTRIB:j===">"?L(m):j==="/"?m.state=k.OPEN_TAG_SLASH:Q(E,j)?(P(m,"No whitespace between attributes"),m.attribName=j,m.attribValue="",m.state=k.ATTRIB_NAME):P(m,"Invalid attribute name");continue;case k.ATTRIB_VALUE_UNQUOTED:if(!at(j)){j==="&"?m.state=k.ATTRIB_VALUE_ENTITY_U:m.attribValue+=j;continue}ut(m),j===">"?L(m):m.state=k.ATTRIB;continue;case k.CLOSE_TAG:if(m.tagName)j===">"?W(m):Q(f,j)?m.tagName+=j:m.script?(m.script+="</"+m.tagName,m.tagName="",m.state=k.SCRIPT):(V(j)||P(m,"Invalid tagname in closing tag"),m.state=k.CLOSE_TAG_SAW_WHITE);else{if(V(j))continue;ot(E,j)?m.script?(m.script+="</"+j,m.state=k.SCRIPT):P(m,"Invalid tagname in closing tag."):m.tagName=j}continue;case k.CLOSE_TAG_SAW_WHITE:if(V(j))continue;j===">"?W(m):P(m,"Invalid characters in closing tag");continue;case k.TEXT_ENTITY:case k.ATTRIB_VALUE_ENTITY_Q:case k.ATTRIB_VALUE_ENTITY_U:var Nt,h;switch(m.state){case k.TEXT_ENTITY:Nt=k.TEXT,h="textNode";break;case k.ATTRIB_VALUE_ENTITY_Q:Nt=k.ATTRIB_VALUE_QUOTED,h="attribValue";break;case k.ATTRIB_VALUE_ENTITY_U:Nt=k.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}if(j===";"){var et=wt(m);m.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(et)?(m.entity="",m.state=Nt,m.write(et)):(m[h]+=et,m.entity="",m.state=Nt)}else Q(m.entity.length?O:A,j)?m.entity+=j:(P(m,"Invalid character in entity name"),m[h]+="&"+m.entity+j,m.entity="",m.state=Nt);continue;default:throw new Error(m,"Unknown state: "+m.state)}return m.position>=m.bufferCheckPosition&&s(m),m}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var b=String.fromCharCode,m=Math.floor,Y=function(){var j=16384,bt=[],St,Nt,h=-1,et=arguments.length;if(!et)return"";for(var c="";++h<et;){var r=Number(arguments[h]);if(!isFinite(r)||r<0||r>1114111||m(r)!==r)throw RangeError("Invalid code point: "+r);r<=65535?bt.push(r):(r-=65536,St=(r>>10)+55296,Nt=r%1024+56320,bt.push(St,Nt)),(h+1===et||bt.length>j)&&(c+=b.apply(null,bt),bt.length=0)}return c};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Y,configurable:!0,writable:!0}):String.fromCodePoint=Y}()})(H)})(Fi);const ks=Fi,Ss=Ke,Is=/^\s+$/;let Ts=class{parseAsync(t){return new Ss.Promise((e,n)=>{const s=ks.parser(!0);let o,l;const a=[];s.onerror=n,s.ontext=d=>{Is.test(d)?l&&l.attributes["xml:space"]==="preserve"&&l.children.push(d):l.children.push(this._covertToNumberIfNumber(d))},s.onopentagstart=d=>{const N={name:d.name,attributes:{},children:[]};l?l.children.push(N):o=N,a.push(N),l=N},s.onclosetag=d=>{a.pop(),l=a[a.length-1]},s.onattribute=d=>{l.attributes[d.name]=this._covertToNumberIfNumber(d.value)},s.onend=()=>e(o),s.write(t).close()})}_covertToNumberIfNumber(t){const e=Number(t);return e.toString()===t?e:t}};var ki=Ts;const we=Wt,Bs='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';let Rs=class{build(t){this._i=0;const e=this._build(t,"");if(e!=="")return Bs+e}_build(t,e){if(this._i++%1e6===0&&(this._c=e[0]),t&&we.isFunction(t.toXml)&&(t=t.toXml()),we.isObject(t)){if(!t.name)throw new Error(`XML node does not have name: ${JSON.stringify(t)}`);e+=`<${t.name}`,we.forOwn(t.attributes,(n,s)=>{e+=` ${s}="${this._escapeString(n,!0)}"`}),we.isEmpty(t.children)?e+="/>":(e+=">",we.forEach(t.children,n=>{e=this._build(n,e)}),e+=`</${t.name}>`)}else we.isNil(t)||(e+=this._escapeString(t));return e}_escapeString(t,e){return we.isNil(t)||(t=t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e&&(t=t.replace(/"/g,"&quot;"))),t}};var Si=Rs;const ai=Wt,Ce=bs,ie=Ye,Ds=Ke,Os=ki,Ps=Si,Ze=me,oi=_t.from([4,0,4,0,64,0,0,0]),Us=4096,hi=8,Ne={dataIntegrity:{hmacKey:_t.from([95,178,173,1,12,185,225,246]),hmacValue:_t.from([160,103,127,2,178,44,132,51])},key:_t.from([20,110,11,231,171,172,208,214]),verifierHash:{input:_t.from([254,167,210,118,59,75,158,121]),value:_t.from([215,170,15,109,48,97,52,78])}};let zs=class{encrypt(t,e){const n=ie.randomBytes(32),s={package:{cipherAlgorithm:"AES",cipherChaining:"ChainingModeCBC",saltValue:ie.randomBytes(16),hashAlgorithm:"SHA512",hashSize:64,blockSize:16,keyBits:n.length*8},key:{cipherAlgorithm:"AES",cipherChaining:"ChainingModeCBC",saltValue:ie.randomBytes(16),hashAlgorithm:"SHA512",hashSize:64,blockSize:16,spinCount:1e5,keyBits:256}},o=this._cryptPackage(!0,s.package.cipherAlgorithm,s.package.cipherChaining,s.package.hashAlgorithm,s.package.blockSize,s.package.saltValue,n,t),l=ie.randomBytes(64),a=this._createIV(s.package.hashAlgorithm,s.package.saltValue,s.package.blockSize,Ne.dataIntegrity.hmacKey),d=this._crypt(!0,s.package.cipherAlgorithm,s.package.cipherChaining,n,a,l),N=this._hmac(s.package.hashAlgorithm,l,o),S=this._createIV(s.package.hashAlgorithm,s.package.saltValue,s.package.blockSize,Ne.dataIntegrity.hmacValue),I=this._crypt(!0,s.package.cipherAlgorithm,s.package.cipherChaining,n,S,N);s.dataIntegrity={encryptedHmacKey:d,encryptedHmacValue:I};const D=this._convertPasswordToKey(e,s.key.hashAlgorithm,s.key.saltValue,s.key.spinCount,s.key.keyBits,Ne.key);s.key.encryptedKeyValue=this._crypt(!0,s.key.cipherAlgorithm,s.key.cipherChaining,D,s.key.saltValue,n);const _=ie.randomBytes(16),v=this._convertPasswordToKey(e,s.key.hashAlgorithm,s.key.saltValue,s.key.spinCount,s.key.keyBits,Ne.verifierHash.input);s.key.encryptedVerifierHashInput=this._crypt(!0,s.key.cipherAlgorithm,s.key.cipherChaining,v,s.key.saltValue,_);const g=this._hash(s.key.hashAlgorithm,_),E=this._convertPasswordToKey(e,s.key.hashAlgorithm,s.key.saltValue,s.key.spinCount,s.key.keyBits,Ne.verifierHash.value);s.key.encryptedVerifierHashValue=this._crypt(!0,s.key.cipherAlgorithm,s.key.cipherChaining,E,s.key.saltValue,g);const f=this._buildEncryptionInfo(s);let A=Ce.utils.cfb_new();return Ce.utils.cfb_add(A,"EncryptionInfo",f),Ce.utils.cfb_add(A,"EncryptedPackage",o),Ce.utils.cfb_del(A,"Sh33tJ5"),A=Ce.write(A),_t.isBuffer(A)||(A=_t.from(A)),A}decryptAsync(t,e){const n=Ce.parse(t);let s=ai.find(n.FileIndex,{name:"EncryptionInfo"}).content,o=ai.find(n.FileIndex,{name:"EncryptedPackage"}).content;return _t.isBuffer(s)||(s=_t.from(s)),_t.isBuffer(o)||(o=_t.from(o)),Ds.Promise.resolve().then(()=>this._parseEncryptionInfoAsync(s)).then(l=>{const a=this._convertPasswordToKey(e,l.key.hashAlgorithm,l.key.saltValue,l.key.spinCount,l.key.keyBits,Ne.key),d=this._crypt(!1,l.key.cipherAlgorithm,l.key.cipherChaining,a,l.key.saltValue,l.key.encryptedKeyValue);return this._cryptPackage(!1,l.package.cipherAlgorithm,l.package.cipherChaining,l.package.hashAlgorithm,l.package.blockSize,l.package.saltValue,d,o)})}_buildEncryptionInfo(t){const e={name:"encryption",attributes:{xmlns:"http://schemas.microsoft.com/office/2006/encryption","xmlns:p":"http://schemas.microsoft.com/office/2006/keyEncryptor/password","xmlns:c":"http://schemas.microsoft.com/office/2006/keyEncryptor/certificate"},children:[{name:"keyData",attributes:{saltSize:t.package.saltValue.length,blockSize:t.package.blockSize,keyBits:t.package.keyBits,hashSize:t.package.hashSize,cipherAlgorithm:t.package.cipherAlgorithm,cipherChaining:t.package.cipherChaining,hashAlgorithm:t.package.hashAlgorithm,saltValue:t.package.saltValue.toString("base64")}},{name:"dataIntegrity",attributes:{encryptedHmacKey:t.dataIntegrity.encryptedHmacKey.toString("base64"),encryptedHmacValue:t.dataIntegrity.encryptedHmacValue.toString("base64")}},{name:"keyEncryptors",children:[{name:"keyEncryptor",attributes:{uri:"http://schemas.microsoft.com/office/2006/keyEncryptor/password"},children:[{name:"p:encryptedKey",attributes:{spinCount:t.key.spinCount,saltSize:t.key.saltValue.length,blockSize:t.key.blockSize,keyBits:t.key.keyBits,hashSize:t.key.hashSize,cipherAlgorithm:t.key.cipherAlgorithm,cipherChaining:t.key.cipherChaining,hashAlgorithm:t.key.hashAlgorithm,saltValue:t.key.saltValue.toString("base64"),encryptedVerifierHashInput:t.key.encryptedVerifierHashInput.toString("base64"),encryptedVerifierHashValue:t.key.encryptedVerifierHashValue.toString("base64"),encryptedKeyValue:t.key.encryptedKeyValue.toString("base64")}}]}]}]},s=new Ps().build(e);return _t.concat([oi,_t.from(s,"utf8")])}_parseEncryptionInfoAsync(t){const e=t.slice(oi.length).toString("utf8");return new Os().parseAsync(e).then(s=>{const o=Ze.findChild(s,"keyData"),l=Ze.findChild(s,"keyEncryptors"),a=Ze.findChild(l,"keyEncryptor"),d=Ze.findChild(a,"p:encryptedKey");return{package:{cipherAlgorithm:o.attributes.cipherAlgorithm,cipherChaining:o.attributes.cipherChaining,saltValue:_t.from(o.attributes.saltValue,"base64"),hashAlgorithm:o.attributes.hashAlgorithm,blockSize:o.attributes.blockSize},key:{encryptedKeyValue:_t.from(d.attributes.encryptedKeyValue,"base64"),cipherAlgorithm:d.attributes.cipherAlgorithm,cipherChaining:d.attributes.cipherChaining,saltValue:_t.from(d.attributes.saltValue,"base64"),hashAlgorithm:d.attributes.hashAlgorithm,spinCount:d.attributes.spinCount,keyBits:d.attributes.keyBits}}})}_hash(t,...e){if(t=t.toLowerCase(),ie.getHashes().indexOf(t)<0)throw new Error(`Hash algorithm '${t}' not supported!`);const s=ie.createHash(t);return s.update(_t.concat(e)),s.digest()}_hmac(t,e,...n){if(t=t.toLowerCase(),ie.getHashes().indexOf(t)<0)throw new Error(`HMAC algorithm '${t}' not supported!`);const o=ie.createHmac(t,e);return o.update(_t.concat(n)),o.digest()}_crypt(t,e,n,s,o,l){let a=`${e.toLowerCase()}-${s.length*8}`;if(n==="ChainingModeCBC")a+="-cbc";else throw new Error(`Unknown cipher chaining: ${n}`);const d=ie[t?"createCipheriv":"createDecipheriv"](a,s,o);d.setAutoPadding(!1);let N=d.update(l);return N=_t.concat([N,d.final()]),N}_cryptPackage(t,e,n,s,o,l,a,d){const N=[],S=t?0:hi;let I=0,D=0,_=0;for(;_<d.length;){D=_,_=D+Us,_>d.length&&(_=d.length);let g=d.slice(D+S,_+S);const E=g.length%o;E&&(g=_t.concat([g,_t.alloc(o-E)]));const f=this._createIV(s,l,o,I),A=this._crypt(t,e,n,a,f,g);N.push(A),I++}let v=_t.concat(N);if(t)v=_t.concat([this._createUInt32LEBuffer(d.length,hi),v]);else{const g=d.readUInt32LE(0);v=v.slice(0,g)}return v}_createUInt32LEBuffer(t,e=4){const n=_t.alloc(e);return n.writeUInt32LE(t,0),n}_convertPasswordToKey(t,e,n,s,o,l){const a=_t.from(t,"utf16le");let d=this._hash(e,n,a);for(let S=0;S<s;S++){const I=this._createUInt32LEBuffer(S);d=this._hash(e,I,d)}d=this._hash(e,d,l);const N=o/8;if(d.length<N){const S=_t.alloc(N,54);d.copy(S),d=S}else d.length>N&&(d=d.slice(0,N));return d}_createIV(t,e,n,s){typeof s=="number"&&(s=this._createUInt32LEBuffer(s));let o=this._hash(t,e,s);if(o.length<n){const l=_t.alloc(n,54);o.copy(l),o=l}else o.length>n&&(o=o.slice(0,n));return o}};var Ls=zs;const Vt=Wt,li=Ye,Ms=wi,ae=Ke,Vs=Qe,js=Sn(),Ht=me,oe=os,Hs=us,Ws=ds,Gs=ps,Xs=Ni,Zs=gs,$s=vs,ui=Ls,qs=ki,Ks=Si,$e=de,Ys=Ee,he={date:new Date(0),createFolders:!1},Qs=new qs,le=new Ks,ci=typeof ui=="function"&&new ui,fi=["\\","/","*","[","]",":","?"],di=31,Ar=["fileVersion","fileSharing","workbookPr","workbookProtection","bookViews","sheets","functionGroups","externalReferences","definedNames","calcPr","oleSize","customWorkbookViews","pivotCaches","smartTagPr","smartTagTypes","webPublishing","fileRecoveryPr","webPublishObjects","extLst"];let Ii=class Oe{static fromBlankAsync(){return Oe.fromDataAsync(js)}static fromDataAsync(t,e){return new Oe()._initAsync(t,e)}static fromFileAsync(t,e){if(fe.browser)throw new Error("Workbook.fromFileAsync is not supported in the browser");return new ae.Promise((n,s)=>{li.readFile(t,(o,l)=>{if(o)return s(o);n(l)})}).then(n=>Oe.fromDataAsync(n,e))}activeSheet(){return new $e("Workbook.activeSheet").case(()=>this._activeSheet).case("*",t=>{if(t instanceof oe||(t=this.sheet(t)),t.hidden())throw new Error("You may not activate a hidden sheet.");return Vt.forEach(this._sheets,e=>{e.tabSelected(e===t)}),this._activeSheet=t,this}).handle(arguments)}addSheet(t,e){return this._addSheet(t,e)}definedName(){return new $e("Workbook.definedName").case("string",t=>this.scopedDefinedName(void 0,t)).case(["string","*"],(t,e)=>(this.scopedDefinedName(void 0,t,e),this)).handle(arguments)}deleteSheet(t){if(!(t instanceof oe)&&(t=this.sheet(t),!t))throw new Error("Invalid move sheet reference.");const e=Vt.filter(this._sheets,s=>!s.hidden());if(e.length===1&&e[0]===t)throw new Error("This sheet may not be deleted as a workbook must contain at least one visible sheet.");let n=this._sheets.indexOf(t);return this._sheets.splice(n,1),t===this.activeSheet()&&(n>=this._sheets.length&&n--,this.activeSheet(n)),this}find(t,e){t=Vs(t);let n=[];return this._sheets.forEach(s=>{n=n.concat(s.find(t,e))}),n}moveSheet(t,e){if(!(t instanceof oe)&&(t=this.sheet(t),!t))throw new Error("Invalid move sheet reference.");const n=this._sheets.indexOf(t);let s;if(Vt.isNil(e))s=this._sheets.length-1;else if(Vt.isInteger(e))s=e;else{if(!(e instanceof oe)&&(e=this.sheet(e),!e))throw new Error("Invalid before sheet reference.");s=this._sheets.indexOf(e)}return this._sheets.splice(s,0,this._sheets.splice(n,1)[0]),this}outputAsync(t){t=t||{},typeof t=="string"&&(t={type:t}),this._setSheetRefs();let e=Ht.findChild(this._node,"definedNames");return this._sheets.forEach((n,s)=>{n._autoFilter&&(e||(e={name:"definedNames",attributes:{},children:[]},Ht.insertInOrder(this._node,e,Ar)),Ht.appendChild(e,{name:"definedName",attributes:{name:"_xlnm._FilterDatabase",localSheetId:s,hidden:"1"},children:[n._autoFilter.address({includeSheetName:!0,anchored:!0})]}))}),this._sheetsNode.children=[],this._sheets.forEach((n,s)=>{const o=`xl/worksheets/sheet${s+1}.xml`,l=`xl/worksheets/_rels/sheet${s+1}.xml.rels`,a=n.toXmls(),d=this._relationships.findById(a.id.attributes["r:id"]);d.attributes.Target=`worksheets/sheet${s+1}.xml`,this._sheetsNode.children.push(a.id),this._zip.file(o,le.build(a.sheet),he);const N=le.build(a.relationships);N?this._zip.file(l,N,he):this._zip.remove(l)}),this._zip.file("[Content_Types].xml",le.build(this._contentTypes),he),this._zip.file("docProps/app.xml",le.build(this._appProperties),he),this._zip.file("docProps/core.xml",le.build(this._coreProperties),he),this._zip.file("xl/_rels/workbook.xml.rels",le.build(this._relationships),he),this._zip.file("xl/sharedStrings.xml",le.build(this._sharedStrings),he),this._zip.file("xl/styles.xml",le.build(this._styleSheet),he),this._zip.file("xl/workbook.xml",le.build(this._node),he),this._zip.generateAsync({type:"nodebuffer",compression:"DEFLATE"}).then(n=>(t.password&&(n=ci.encrypt(n,t.password)),this._convertBufferToOutput(n,t.type)))}sheet(t){return Vt.isInteger(t)?this._sheets[t]:Vt.find(this._sheets,e=>e.name()===t)}sheets(){return this._sheets.slice()}property(){return new $e("Workbook.property").case("string",t=>this._coreProperties.get(t)).case("array",t=>{const e={};return t.forEach(n=>{e[n]=this._coreProperties.get(n)}),e}).case(["string","*"],(t,e)=>(this._coreProperties.set(t,e),this)).case("object",t=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];this._coreProperties.set(e,n)}return this}).handle(arguments)}properties(){return this._coreProperties}toFileAsync(t,e){if(fe.browser)throw new Error("Workbook.toFileAsync is not supported in the browser.");return this.outputAsync(e).then(n=>new ae.Promise((s,o)=>{li.writeFile(t,n,l=>{if(l)return o(l);s()})}))}scopedDefinedName(t,e,n){let s=Ht.findChild(this._node,"definedNames"),o=s&&Vt.find(s.children,l=>l.attributes.name===e&&l.localSheet===t);return new $e("Workbook.scopedDefinedName").case(["*","string"],()=>{const l=o&&o.children[0];if(!l)return;const a=Ys.fromAddress(l);if(!a)return l;const d=this.sheet(a.sheetName);return a.type==="cell"?d.cell(a.rowNumber,a.columnNumber):a.type==="range"?d.range(a.startRowNumber,a.startColumnNumber,a.endRowNumber,a.endColumnNumber):a.type==="row"?d.row(a.rowNumber):a.type==="column"?d.column(a.columnNumber):l}).case(["*","string","nil"],()=>(o&&Ht.removeChild(s,o),s&&!s.children.length&&Ht.removeChild(this._node,s),this)).case(["*","string","*"],()=>(typeof n!="string"&&(n=n.address({includeSheetName:!0,anchored:!0})),s||(s={name:"definedNames",attributes:{},children:[]},Ht.insertInOrder(this._node,s,Ar)),o||(o={name:"definedName",attributes:{name:e},children:[n]},t&&(o.localSheet=t),Ht.appendChild(s,o)),o.children=[n],this)).handle(arguments)}sharedStrings(){return this._sharedStrings}styleSheet(){return this._styleSheet}cloneSheet(t,e,n){if(!t||!(t instanceof oe))throw new Error("Invalid clone from.");return this._addSheet(e,n,()=>{const s=d=>{if(d&&Vt.isFunction(d.toXml)&&(d=d.toXml()),typeof d=="object"){if(d.name){const N={name:d.name,attributes:{},children:[]};Vt.forOwn(d.attributes,(I,D)=>{N.attributes[D]=I});let S;return d.children&&d.children.forEach(I=>{S=s(I),I!==null&&N.children.push(S)}),N}}else if(d!==null)return d;return null},o=t.toXmls(),l=s(o.sheet),a=s(o.relationships);return{sheetNode:l,relationshipNode:a}})}_addSheet(t,e,n){if(!t||typeof t!="string")throw new Error("Invalid sheet name.");if(Vt.some(fi,d=>t.indexOf(d)>=0))throw new Error(`Sheet name may not contain any of the following characters: ${fi.join(" ")}`);if(t.length>di)throw new Error(`Sheet name may not be greater than ${di} characters.`);if(this.sheet(t))throw new Error(`Sheet with name "${t}" already exists.`);let s;if(Vt.isNil(e))s=this._sheets.length;else if(Vt.isInteger(e))s=e;else{if(!(e instanceof oe)&&(e=this.sheet(e),!e))throw new Error("Invalid before sheet reference.");s=this._sheets.indexOf(e)}const o=this._relationships.add("worksheet"),l={name:"sheet",attributes:{name:t,sheetId:++this._maxSheetId,"r:id":o.attributes.Id},children:[]};let a;if(n){const{sheetNode:d,relationshipNode:N}=n();a=new oe(this,l,d,N)}else a=new oe(this,l);return this._sheets.splice(s,0,a),a}_initAsync(t,e){return e=e||{},this._maxSheetId=0,this._sheets=[],ae.Promise.resolve().then(()=>this._convertInputToBufferAsync(t,e.base64).then(n=>{t=n})).then(()=>{if(e.password)return ci.decryptAsync(t,e.password).then(n=>{t=n})}).then(()=>Ms.loadAsync(t)).then(n=>(this._zip=n,this._parseNodesAsync(["[Content_Types].xml","docProps/app.xml","docProps/core.xml","xl/_rels/workbook.xml.rels","xl/sharedStrings.xml","xl/styles.xml","xl/workbook.xml"]))).then(n=>{const s=n[0],o=n[1],l=n[2],a=n[3],d=n[4],N=n[5],S=n[6];return this._contentTypes=new Hs(s),this._appProperties=new Ws(o),this._coreProperties=new Gs(l),this._relationships=new Xs(a),this._sharedStrings=new Zs(d),this._styleSheet=new $s(N),this._node=S,this._relationships.findByType("sharedStrings")||this._relationships.add("sharedStrings","sharedStrings.xml"),this._contentTypes.findByPartName("/xl/sharedStrings.xml")||this._contentTypes.add("/xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this._zip.remove("xl/calcChain.xml"),this._sheetsNode=Ht.findChild(this._node,"sheets"),ae.Promise.all(Vt.map(this._sheetsNode.children,(I,D)=>(I.attributes.sheetId>this._maxSheetId&&(this._maxSheetId=I.attributes.sheetId),this._parseNodesAsync([`xl/worksheets/sheet${D+1}.xml`,`xl/worksheets/_rels/sheet${D+1}.xml.rels`]).then(_=>{const v=_[0],g=_[1];this._sheets[D]=new oe(this,I,v,g)}))))}).then(()=>this._parseSheetRefs()).then(()=>this)}_parseNodesAsync(t){return ae.Promise.all(Vt.map(t,e=>this._zip.file(e))).then(e=>ae.Promise.all(Vt.map(e,n=>n&&n.async("string")))).then(e=>ae.Promise.all(Vt.map(e,n=>n&&Qs.parseAsync(n))))}_parseSheetRefs(){const t=Ht.findChild(this._node,"bookViews"),e=t&&Ht.findChild(t,"workbookView"),n=e&&e.attributes.activeTab||0;this._activeSheet=this._sheets[n];const s=Ht.findChild(this._node,"definedNames");s&&Vt.forEach(s.children,o=>{o.attributes.hasOwnProperty("localSheetId")&&(o.localSheet=this._sheets[o.attributes.localSheetId])})}_setSheetRefs(){let t=Ht.findChild(this._node,"bookViews");t||(t={name:"bookViews",attributes:{},children:[]},Ht.insertInOrder(this._node,t,Ar));let e=Ht.findChild(t,"workbookView");e||(e={name:"workbookView",attributes:{},children:[]},Ht.appendChild(t,e)),e.attributes.activeTab=this._sheets.indexOf(this._activeSheet);const n=Ht.findChild(this._node,"definedNames");n&&Vt.forEach(n.children,s=>{s.localSheet&&(s.attributes.localSheetId=this._sheets.indexOf(s.localSheet))})}_convertBufferToOutput(t,e){if(e||(e=fe.browser?"blob":"nodebuffer"),e==="buffer"||e==="nodebuffer")return t;if(fe.browser&&e==="blob")return new Blob([t],{type:Oe.MIME_TYPE});if(e==="base64")return t.toString("base64");if(e==="binarystring")return t.toString("utf8");if(e==="uint8array")return new Uint8Array(t);if(e==="arraybuffer")return new Uint8Array(t).buffer;throw new Error(`Output type '${e}' not supported.`)}_convertInputToBufferAsync(t,e){return ae.Promise.resolve().then(()=>{if(_t.isBuffer(t))return t;if(fe.browser&&t instanceof Blob)return new ae.Promise(n=>{const s=new FileReader;s.onload=o=>{n(_t.from(o.target.result))},s.readAsArrayBuffer(t)});if(typeof t=="string"&&e)return _t.from(t,"base64");if(typeof t=="string"&&!e)return _t.from(t,"utf8");if(t instanceof Uint8Array||t instanceof ArrayBuffer)return _t.from(t);throw new Error("Input type unknown.")})}};Ii.MIME_TYPE="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";var Js=Ii;const mi=Ke,qe=Js,ta=Ai,pi=yi,ea=xi;class Je{static dateToNumber(t){return pi.dateToNumber(t)}static fromBlankAsync(){return qe.fromBlankAsync()}static fromDataAsync(t,e){return qe.fromDataAsync(t,e)}static fromFileAsync(t,e){return qe.fromFileAsync(t,e)}static numberToDate(t){return pi.numberToDate(t)}static get Promise(){return mi.Promise}static set Promise(t){mi.Promise=t}}Je.MIME_TYPE=qe.MIME_TYPE;Je.FormulaError=ta;Je.RichText=ea;var ra=Je;const ia=Qi(ra);function Ia(){const H=Ji(),{handling:t,requests:e,getRequests:n,deleteRequest:s}=xn(je(v=>({handling:v.handling,requests:v.data,getRequests:v.getRequests,deleteRequest:v.deleteRequest}))),{devices:o,getDevices:l}=cn(je(v=>({devices:v.data,getDevices:v.getDevices}))),{requestType:a,users:d}=tn(je(v=>({requestType:v.data.request.type,users:v.data.users}))),{userInfo:N}=en(je(v=>({userInfo:v.info}))),[S,I]=hr.useState("All"),D=hr.useMemo(()=>Object.values(e).filter(v=>S==="All"?!0:v.status===S),[e,S]);hr.useEffect(()=>{n(),Object.keys(o).length||l()},[]);const _=async()=>{const v=new XMLHttpRequest;v.open("GET",`${ln}/excel/template.xlsx`,!0),v.responseType="arraybuffer",v.onreadystatechange=()=>{v.readyState===4&&v.status===200&&ia.fromDataAsync(v.response).then(g=>{const E=g.sheet(0);let f=2;return D.forEach((A,O)=>{var V,M,at,Q,ot;E.row(f).cell(1).value(O+1),E.row(f).cell(2).value((V=o[A.deviceId])==null?void 0:V.name),E.row(f).cell(3).value(A.description),E.row(f).cell(4).value(lr(A.createdAt).format("DD/MM/YYYY")),E.row(f).cell(5).value((M=d[A.creator])==null?void 0:M.name),E.row(f).cell(6).value((at=d[A.assignedTo||""])==null?void 0:at.name),A.scheduledDate&&E.row(f).cell(7).value(lr(A.scheduledDate).format("DD/MM/YYYY")),E.row(f).cell(8).value((Q=o[A.replacementDeviceId||""])==null?void 0:Q.name),E.row(f).cell(9).value((ot=He[A.status])==null?void 0:ot.name),f+=1}),g.outputAsync().then(A=>{A!==void 0?Nn.saveAs(A,"report-request.xlsx"):zr({title:"Error",description:"Cannot export excel file",variant:"destructive"})})})},v.onerror=g=>{zr({title:"Error",description:un(g),variant:"destructive"})},v.send()};return It.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t?It.jsx(rn,{}):null,It.jsx("div",{className:"flex justify-between items-center mb-6",children:It.jsx("h1",{className:"text-2xl font-bold",children:"Maintenance Management"})}),It.jsxs("div",{className:"flex justify-between items-center mb-4",children:[It.jsx("div",{className:"flex items-center space-x-2",children:It.jsxs(yn,{onValueChange:v=>I(v),children:[It.jsx(An,{className:"w-[180px] bg-white",children:It.jsx(vn,{placeholder:"Filter by status"})}),It.jsxs(bn,{children:[It.jsx(Lr,{value:"All",children:"All"}),Object.entries(He).map(([v,g])=>It.jsx(Lr,{value:v,children:g.name},v))]})]})}),It.jsx(Pr,{onClick:_,children:"Export Excel"})]}),It.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:D.map(v=>{var g,E,f,A;return It.jsxs(dn,{children:[It.jsx(mn,{children:It.jsxs("div",{className:"flex space-x-2",children:[It.jsx("img",{src:v.image,alt:"device",className:"w-20 h-20 object-cover rounded"}),It.jsxs("div",{children:[It.jsxs(pn,{children:[(g=a[v.type])==null?void 0:g.name," -"," ",(E=o[v.deviceId])==null?void 0:E.name]}),It.jsx(_n,{children:v.description})]})]})}),It.jsx(gn,{children:It.jsxs("div",{className:"flex justify-between items-center",children:[It.jsx(fn,{style:{backgroundColor:(f=He[v.status])==null?void 0:f.color},children:(A=He[v.status])==null?void 0:A.name}),It.jsxs("span",{className:"text-sm text-muted-foreground",children:["Date create: ",lr(v.createdAt).format("DD/MM/YYYY")]})]})}),It.jsx(wn,{className:"flex justify-end",children:It.jsxs(nn,{children:[It.jsx(sn,{asChild:!0,children:It.jsxs(Pr,{variant:"ghost",className:"h-8 w-8 p-0",children:[It.jsx("span",{className:"sr-only",children:"Open menu"}),It.jsx(Cn,{className:"h-4 w-4"})]})}),It.jsxs(an,{align:"end",children:[It.jsx(on,{children:"Actions"}),It.jsx(Ur,{onSelect:()=>H(`/request/${v.id}`),children:"View Details"}),v.creator===(N==null?void 0:N.id.toString())?It.jsxs(It.Fragment,{children:[It.jsx(hn,{}),It.jsx(Ur,{className:"text-red-600",onSelect:()=>s(v.id),children:"Cancel Task"})]}):null]})]})})]},v.id)})})]})}export{Ia as default};
