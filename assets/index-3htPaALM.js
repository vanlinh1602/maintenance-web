import{u as I,f as o,r as p,h as T,e as F,j as e,W as U,D as E,i as P,k as B,l as L,m as O,B as h,p as V,q as W,t as k}from"./index-Cw7UTnmX.js";import{I as H}from"./input-DoXMFgNH.js";import{L as l}from"./label-B5bgNSYj.js";import{S as u,a as g,b as x,c as j,d as f}from"./select-Bep9p-Vs.js";import{T as $}from"./textarea-BvdFGMqn.js";import{p as z}from"./options-Cf1MLeWf.js";import{u as A}from"./hooks-BE1mY1X_.js";const Z=({device:r,onClose:c,request:n})=>{const y=I(),{handling:v,createRequest:N,updateRequest:R}=A(o(s=>({createRequest:s.createRequest,updateRequest:s.updateRequest,handling:s.handling}))),[S,d]=p.useState(!1),{requestTypes:q}=T(o(s=>({requestTypes:s.data.request.type}))),{userInfo:b}=F(o(s=>({userInfo:s.info}))),[a,i]=p.useState({description:"",priority:"",type:"",image:""}),D=async s=>{var t;try{d(!0);const m=(t=s.target.files)==null?void 0:t[0];if(!m)return;const C=await W(m);i({...a,image:C})}finally{d(!1)}},w=async()=>{if(!a.type||!a.description||!a.priority){k({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}const s={...n,...a,deviceId:r.id,image:a.image,creator:b.id,status:"pending"};if(n)R(n.id,s),c();else{const t=await N(s);t&&(y(`/request/${t.id}`),c())}};return e.jsxs(e.Fragment,{children:[v||S?e.jsx(U,{}):null,e.jsx(E,{open:!0,onOpenChange:s=>{s||c()},children:e.jsxs(P,{children:[e.jsxs(B,{children:[e.jsxs(L,{children:["Request Repair for ",r==null?void 0:r.name]}),e.jsx(O,{children:"Please provide details about the issue you're experiencing with this device."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(l,{htmlFor:"urgency",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(u,{onValueChange:s=>i({...a,type:s}),value:a.type,children:[e.jsx(g,{className:"col-span-3",children:e.jsx(x,{placeholder:"Select urgency level"})}),e.jsx(j,{children:Object.entries(q).map(([s,t])=>e.jsx(f,{value:s,style:{color:t.color},children:t.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(l,{htmlFor:"urgency",className:"text-right",children:["Photo",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"col-span-3",children:a.image?e.jsxs("div",{className:"flex flex-row w-full items-center space-x-2",children:[e.jsx("div",{className:"w-40 h-40",children:e.jsx("img",{src:a.image,alt:"device",className:"w-40 h-40 object-cover"})}),e.jsx(h,{variant:"destructive",onClick:()=>i({...a,image:""}),children:"Remove"})]}):e.jsx(H,{type:"file",id:"image",className:"w-40 h-40 justify-center text-cente items-center",placeholder:"Upload image",content:"Upload image",accept:"image/*",multiple:!1,onChange:D})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(l,{htmlFor:"issue",className:"text-right",children:["Description",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx($,{id:"issue",placeholder:"Describe the problem in detail...",className:"col-span-3",value:a.description,onChange:s=>i({...a,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(l,{htmlFor:"urgency",className:"text-right",children:["Priority",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(u,{onValueChange:s=>i({...a,priority:s}),value:a.priority,children:[e.jsx(g,{className:"col-span-3",children:e.jsx(x,{placeholder:"Select urgency level"})}),e.jsx(j,{children:Object.entries(z).map(([s,t])=>e.jsx(f,{value:s,style:{color:t.color},children:t.name},s))})]})]})]}),e.jsx(V,{children:e.jsx(h,{type:"submit",onClick:w,children:"Submit Repair Request"})})]})})]})};export{Z as R};
