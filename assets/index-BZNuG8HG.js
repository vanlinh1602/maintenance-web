import{u as q,f as c,h as v,e as N,r as b,j as e,W as D,D as C,i as T,k as F,l as E,m as I,p as w,B as O,t as P}from"./index-DVFDKlcv.js";import{L as o}from"./label-DuOUMB3r.js";import{S as d,a as p,b as u,c as h,d as m}from"./select-Bn3wcZhV.js";import{T as V}from"./textarea-B-3oHILt.js";import{p as B}from"./options-YKJpdElC.js";import{u as L}from"./hooks-CYUBZkOm.js";const A=({device:a,onClose:i,request:l})=>{const x=q(),{handling:g,createRequest:j,updateRequest:y}=L(c(s=>({createRequest:s.createRequest,updateRequest:s.updateRequest,handling:s.handling}))),{requestTypes:f}=v(c(s=>({requestTypes:s.data.request.type}))),{userInfo:R}=N(c(s=>({userInfo:s.info}))),[t,n]=b.useState({description:"",priority:"",type:""}),S=async()=>{if(!t.type||!t.description||!t.priority){P({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}const s={...l,...t,deviceId:a.id,creator:R.id,status:"pending"};if(l)y(l.id,s),i();else{const r=await j(s);r&&(x(`/request/${r.id}`),i())}};return e.jsxs(e.Fragment,{children:[g?e.jsx(D,{}):null,e.jsx(C,{open:!0,onOpenChange:s=>{s||i()},children:e.jsxs(T,{children:[e.jsxs(F,{children:[e.jsxs(E,{children:["Request Repair for ",a==null?void 0:a.name]}),e.jsx(I,{children:"Please provide details about the issue you're experiencing with this device."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"urgency",className:"text-right",children:["Type",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(d,{onValueChange:s=>n({...t,type:s}),value:t.type,children:[e.jsx(p,{className:"col-span-3",children:e.jsx(u,{placeholder:"Select urgency level"})}),e.jsx(h,{children:Object.entries(f).map(([s,r])=>e.jsx(m,{value:s,style:{color:r.color},children:r.name},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"issue",className:"text-right",children:["Description",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(V,{id:"issue",placeholder:"Describe the problem in detail...",className:"col-span-3",value:t.description,onChange:s=>n({...t,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(o,{htmlFor:"urgency",className:"text-right",children:["Priority",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs(d,{onValueChange:s=>n({...t,priority:s}),value:t.priority,children:[e.jsx(p,{className:"col-span-3",children:e.jsx(u,{placeholder:"Select urgency level"})}),e.jsx(h,{children:Object.entries(B).map(([s,r])=>e.jsx(m,{value:s,style:{color:r.color},children:r.name},s))})]})]})]}),e.jsx(w,{children:e.jsx(O,{type:"submit",onClick:S,children:"Submit Repair Request"})})]})})]})};export{A as R};
